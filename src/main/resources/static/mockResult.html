<!doctype html>
<html>

<head>
    <script>
        let _map = ["Неопознанная часть", "Запрещено использование табуляции в качестве разделителя после маркера списка. Методические указания, п. 6.3", "Данный вид маркера списка запрещен. Используйте ненумерованный список либо русские строчные буквы. Методические указания, п. 6.3", "Неверный порядок разделов"];

        function mistakes() {
            return [{"code": 0, "id": "mistake0", "expected": "РЕФЕРАТ", "actual": "НЕОПОЗНАННАЯ ЧАСТЬ"}, {
                "code": 1,
                "id": "mistake1"
            }, {"code": 1, "id": "mistake2"}, {"code": 1, "id": "mistake3"}, {"code": 1, "id": "mistake4"}, {
                "code": 1,
                "id": "mistake5"
            }, {"code": 1, "id": "mistake6"}, {"code": 1, "id": "mistake7"}, {"code": 1, "id": "mistake8"}, {
                "code": 0,
                "id": "mistake9",
                "expected": "РЕФЕРАТ",
                "actual": "НЕОПОЗНАННАЯ ЧАСТЬ"
            }, {"code": 1, "id": "mistake10"}, {"code": 2, "id": "mistake11"}, {
                "code": 0,
                "id": "mistake12",
                "expected": "РЕФЕРАТ",
                "actual": "НЕОПОЗНАННАЯ ЧАСТЬ"
            }, {"code": 1, "id": "mistake13"}, {
                "code": 0,
                "id": "mistake14",
                "expected": "РЕФЕРАТ",
                "actual": "НЕОПОЗНАННАЯ ЧАСТЬ"
            }, {"code": 0, "id": "mistake15", "expected": "РЕФЕРАТ", "actual": "НЕОПОЗНАННАЯ ЧАСТЬ"}, {
                "code": 1,
                "id": "mistake16"
            }, {"code": 1, "id": "mistake17"}, {"code": 1, "id": "mistake18"}, {
                "code": 1,
                "id": "mistake19"
            }, {"code": 1, "id": "mistake20"}, {"code": 1, "id": "mistake21"}, {
                "code": 1,
                "id": "mistake22"
            }, {"code": 1, "id": "mistake23"}, {"code": 1, "id": "mistake24"}, {
                "code": 1,
                "id": "mistake25"
            }, {"code": 1, "id": "mistake26"}, {"code": 1, "id": "mistake27"}, {
                "code": 1,
                "id": "mistake28"
            }, {"code": 1, "id": "mistake29"}, {"code": 1, "id": "mistake30"}, {
                "code": 1,
                "id": "mistake31"
            }, {"code": 1, "id": "mistake32"}, {"code": 1, "id": "mistake33"}, {
                "code": 1,
                "id": "mistake34"
            }, {"code": 1, "id": "mistake35"}, {"code": 1, "id": "mistake36"}, {
                "code": 0,
                "id": "mistake37",
                "expected": "РЕФЕРАТ",
                "actual": "НЕОПОЗНАННАЯ ЧАСТЬ"
            }, {"code": 1, "id": "mistake38"}, {
                "code": 0,
                "id": "mistake39",
                "expected": "РЕФЕРАТ",
                "actual": "НЕОПОЗНАННАЯ ЧАСТЬ"
            }, {"code": 1, "id": "mistake40"}, {
                "code": 0,
                "id": "mistake41",
                "expected": "РЕФЕРАТ",
                "actual": "НЕОПОЗНАННАЯ ЧАСТЬ"
            }, {"code": 1, "id": "mistake42"}, {
                "code": 0,
                "id": "mistake43",
                "expected": "РЕФЕРАТ",
                "actual": "НЕОПОЗНАННАЯ ЧАСТЬ"
            }, {"code": 1, "id": "mistake44"}, {"code": 2, "id": "mistake45"}, {
                "code": 0,
                "id": "mistake46",
                "expected": "РЕФЕРАТ",
                "actual": "НЕОПОЗНАННАЯ ЧАСТЬ"
            }, {"code": 1, "id": "mistake47"}, {"code": 1, "id": "mistake48"}, {
                "code": 1,
                "id": "mistake49"
            }, {"code": 1, "id": "mistake50"}, {
                "code": 0,
                "id": "mistake51",
                "expected": "РЕФЕРАТ",
                "actual": "НЕОПОЗНАННАЯ ЧАСТЬ"
            }, {"code": 1, "id": "mistake52"}, {"code": 1, "id": "mistake53"}, {
                "code": 1,
                "id": "mistake54"
            }, {"code": 1, "id": "mistake55"}, {
                "code": 0,
                "id": "mistake56",
                "expected": "РЕФЕРАТ",
                "actual": "НЕОПОЗНАННАЯ ЧАСТЬ"
            }, {"code": 1, "id": "mistake57"}, {
                "code": 0,
                "id": "mistake58",
                "expected": "РЕФЕРАТ",
                "actual": "НЕОПОЗНАННАЯ ЧАСТЬ"
            }, {"code": 1, "id": "mistake59"}, {
                "code": 0,
                "id": "mistake60",
                "expected": "РЕФЕРАТ",
                "actual": "НЕОПОЗНАННАЯ ЧАСТЬ"
            }, {"code": 1, "id": "mistake61"}, {
                "code": 3,
                "id": "mistake62",
                "expected": "РЕФЕРАТ",
                "actual": "ЗАКЛЮЧЕНИЕ"
            }, {
                "code": 0,
                "id": "mistake63",
                "expected": "БИБЛИОГРАФИЧЕСКИЙ СПИСОК/СПИСОК ИСПОЛЬЗОВАННОЙ ЛИТЕРАТУРЫ/СПИСОК ЛИТЕРАТУРЫ/СПИСОК ИСТОЧНИКОВ",
                "actual": "НЕОПОЗНАННАЯ ЧАСТЬ"
            }, {
                "code": 0,
                "id": "mistake64",
                "expected": "БИБЛИОГРАФИЧЕСКИЙ СПИСОК/СПИСОК ИСПОЛЬЗОВАННОЙ ЛИТЕРАТУРЫ/СПИСОК ЛИТЕРАТУРЫ/СПИСОК ИСТОЧНИКОВ",
                "actual": "НЕОПОЗНАННАЯ ЧАСТЬ"
            }].map(mistake => {
                let description = _map[mistake.code];
                return {
                    mistakeReason: description,
                    description: (mistake.actual !== null && mistake.expected !== null) ? description + ": найдено: " + mistake.actual + ", требуется: " + mistake.expected + "." : description,
                    id: mistake.id
                };
            })
        }
    </script>
    <style>
        * {
            box-sizing: border-box;
            margin: 0.0px;
            padding: 0.0;
        }

        .page {
            width: 595.3px;
            min-height: 841.9px;
            padding-top: 56.7px;
            padding-left: 85.05px;
            padding-bottom: 56.7px;
            padding-right: 42.55px;
            margin: 10.0px;
            background-color: #ffffff;
        }

        .page-size {
            box-shadow: inset 0px 0px 0px 1px blue;
            box-sizing: border-box;
            position: absolute;
            width: 467.7px;
            height: 728.5px;
            z-index: -10.0;
        }

        body {
            display: flex;
            flex-direction: column;
            background-color: #dedede;
            align-items: center;
        }

        .s0 {
            margin-right: -0.1px;
        }

        .s1 {
            line-height: 1.0;
        }

        .s2 {
            text-indent: 0.0px;
        }

        .s3 {
            text-align: center;
        }

        .s4 {
            font-family: Times New Roman;
        }

        .s5 {
            font-size: 14.0px;
        }

        .s6 {
            text-align: right;
        }

        .s7 {
            font-weight: bold;
        }

        .s8 {
            line-height: 1.5;
        }

        .s9 {
            text-indent: 35.45px;
        }

        .s10 {
            background-color: #white;
        }

        .s11 {
            text-align: justify;
        }

        .s12 {
            color: #000000;
        }

        .s13 {
            margin-bottom: 8.0px;
        }

        .s14 {
            line-height: 1.0791666666666666;
        }

        .s15 {
            text-align: left;
        }

        .s16 {
            text-indent: 35.4px;
        }

        .s17 {
            background-color: #FFFFFF;
        }

        .s18 {
            margin-left: 0.0px;
        }

        .s19 {
            margin-left: 28.35px;
        }

        .s20 {
            margin-left: 42.0px;
        }

        .s21 {
            margin-left: 57.0px;
        }

        .s22 {
            color: #171717;
        }

        .s23 {
            text-indent: 28.35px;
        }

        .s24 {
            margin-left: 21.3px;
        }

        .s25 {
            margin-left: 46.35px;
        }

        .s26 {
            margin-left: 35.45px;
        }

        .s27 {
            font-family: Arial;
        }

        .s28 {
            font-size: 10.5px;
        }

        .s29 {
            color: #202122;
        }

        .s30 {
            color: #333333;
        }

        .s31 {
            margin-left: 35.4px;
        }

        .s32 {
            font-family: Courier New;
        }

        .s33 {
            font-size: 10.0px;
        }
    </style>
</head>

<body>
<label><input type="checkbox"
              onchange="document.querySelectorAll('*').forEach(x => x.style.boxShadow = (x.style.boxShadow === '' || x.style.boxShadow === 'none' ? 'inset 0px 0px 0px 1px red' : 'none'));"
              checked>Hide borders</label>
<div class='page'>
    <p class='s0 s1 s2 s3'>
        <span class='s4 s5'><span>Министерство науки и высшего образования Российской Федерации</span></span></p>
    <p class='s0 s1 s2 s3'>
        <span class='s4 s5'><span>Федеральное государственное автономное образовательное учреждение</span></span>
    </p>
    <p class='s0 s1 s2 s3'><span class='s4 s5'><span>высшего образования</span></span></p>
    <p class='s0 s1 s2 s3'><span class='s4 s5'><span>«Уральский федеральный университет</span></span></p>
    <p class='s0 s1 s2 s3'>
        <span class='s4 s5'><span>имени первого Президента России </span></span><span
            class='s4 s5'><span>Б.Н.</span></span><span class='s4 s5'><span> Ельцина»</span></span>
    </p>
    <p class='s0 s1 s2 s3'>
        <span class='s4 s5'><span>И</span></span><span class='s4 s5'><span>нститут радиоэлектроники и информационных технологий</span></span>
    </p>
    <p class='s0 s1 s2 s3'><br></p>
    <p class='s0 s1 s2 s3'><br></p>
    <p class='s0 s1 s2 s3'><br></p>
    <p class='s0 s1 s2 s6'><span class='s4 s5 s7'><span>К ЗАЩИТЕ ДОПУСТИТЬ</span></span></p>
    <p class='s0 s1 s2 s6'><span class='s4 s5'><span>Заведующий кафедрой ИИТ</span></span></p>
    <p class='s0 s1 s2 s6'><span class='s4 s5'><span>______________И.Н. Обабков</span></span></p>
    <p class='s0 s1 s2 s6'>
        <span class='s4 s5'><span>« 0</span></span><span class='s4 s5'><span>6</span></span><span class='s4 s5'><span> » июня 202</span></span><span
            class='s4 s5'><span>2</span></span><span class='s4 s5'><span> г.</span></span>
    </p>
    <p class='s0 s1 s2 s3'><br></p>
    <p class='s0 s1 s2 s3'><br></p>
    <p class='s0 s1 s2 s3'><br></p>
    <p class='s0 s1 s2 s3'><br></p>
    <p class='s0 s1 s2 s3'><br></p>
    <p class='s8 s9 s3'>
        <span class='s4 s5 s7 s10'><span>РАЗРАБОТКА СИНХРОНИЗАЦИИ МОДЕЛИ ИЗ </span></span><span
            class='s4 s5 s7 s10'><span>REVIT</span></span><span
            class='s4 s5 s7 s10'><span> С ОНЛАЙН-СЕРВИСОМ </span></span><span class='s4 s5 s7 s10'><span>ALTECINSOLATIONS</span></span><span
            class='s4 s5 s7 s10'><span>.</span></span>
    </p>
    <p class='s0 s1 s2 s11'><br></p>
    <p class='s0 s1 s2 s11'><br></p>
    <p class='s0 s1 s2 s3'><span class='s4 s5'><span>ВЫПУСКНАЯ КВАЛИФИКАЦИОННАЯ РАБОТА</span></span></p>
    <p class='s0 s1 s2 s3'><span class='s4 s5'><span>Пояснительная записка</span></span></p>
    <p class='s0 s1 s2 s3'><br></p>
    <p class='s0 s1 s2 s3'><br></p>
    <p class='s0 s1 s2 s3'><br></p>
    <p class='s0 s1 s2 s3'><br></p>
    <p class='s0 s1 s2 s3'><br></p>
    <p class='s0 s1 s2 s3'><br></p>
    <p class='s0 s1 s2 s3'><br></p>
    <p class='s0 s1 s2 s3'><br></p>
    <p class='s0 s1 s2 s3'><br></p>
    <p class='s0 s1 s2 s3'><br></p>
    <p class='s0 s1 s2 s3'><br></p>
    <p class='s0 s1 s2 s11'>
        <span class='s4 s5'><span>Руководитель к.х.н., доцент </span></span><span class='s4 s5'></span><span
            class='s4 s5'></span><span class='s4 s5'></span><span class='s4 s5'><span>_________ </span></span><span
            class='s4 s5'><span>И</span></span><span class='s4 s5'><span>.</span></span><span
            class='s4 s5'><span>С</span></span><span class='s4 s5'><span>. </span></span><span class='s4 s5'><span> Стародубцев</span></span>
    </p>
    <p class='s0 s1 s2 s11'>
        <span class='s4 s5'><span>Нормоконтролер</span></span><span
            class='s4 s5'><span>: ст. преподаватель </span></span><span class='s4 s5'></span><span class='s4 s5'><span>_________ В. Н. Васина</span></span>
    </p>
    <p class='s0 s1 s2 s11'>
        <span class='s4 s5'><span>Обучающийся: группа </span></span><span
            class='s4 s5'><span>РИ-480022</span></span><span class='s4 s5'></span><span
            class='s4 s5'><span> </span></span><span class='s4 s5'></span><span
            class='s4 s5'><span>_________</span></span><span class='s4 s5'><span> Д. С. Соловьев</span></span><span
            class='s4 s5'><span> </span></span>
    </p>
    <p class='s0 s1 s2 s3'><br></p>
    <p class='s0 s1 s2 s3'><br></p>
    <p class='s0 s1 s2 s3'><br></p>
    <p class='s0 s1 s2 s3'><br></p>
    <p class='s0 s1 s2 s3'><br></p>
    <p class='s0 s1 s2 s3'>
        <span class='s4 s5'><span>Екатеринбург – 202</span></span><span class='s4 s5'><span>2</span></span><span
            class='s4 s5 s7 s12'></span>
    </p>
</div>
<div class='page'>
    <p class='s0 s1 s2 s3'>
        <span class='s4 s5 s7 s12'></span><span class='s4 s5 s7 s12'><span>РЕФЕРАТ</span></span></p>
    <p class='s0 s8 s2 s3'><br></p>
    <p class='s0 s8 s11'>
        <span class='s4 s5 s12'><span>Выпускная квалификационная работа бакалавра </span></span><span class='s4 s5 s12'><span>44</span></span><span
            class='s4 s5 s12'><span> с., </span></span><span class='s4 s5 s12'><span>6</span></span><span
            class='s4 s5 s12'><span> рис., </span></span><span class='s4 s5 s12'><span>12</span></span><span
            class='s4 s5 s12'><span> источника, </span></span><span class='s4 s5 s12'><span>2</span></span><span
            class='s4 s5 s12'><span> прил.</span></span>
    </p>
    <p class='s8 s9 s11'>
        <span class='s4 s5 s10'><span>Разработка синхронизации модели из </span></span><span class='s4 s5 s10'><span>Revit</span></span><span
            class='s4 s5 s10'><span> с онлайн-сервисом </span></span><span
            class='s4 s5 s10'><span>AltecInsolations</span></span><span class='s4 s5 s10'><span>.</span></span>
    </p>
    <p class='s0 s8 s11'>
        <span class='s4 s5'><span>Цель работы</span></span><span class='s4 s5'><span> –</span></span><span
            class='s4 s5'><span> реализация моментальной синхронизации модели из </span></span><span
            class='s4 s5'><span>Revit</span></span><span class='s4 s5'><span> с онлайн-сервисом </span></span><span
            class='s4 s5'><span>AltecInsolations</span></span><span class='s4 s5'><span>.</span></span><span
            class='s4 s5'><span> </span></span>
    </p>
    <p class='s0 s8 s11'>
        <span class='s4 s5 s12'><span>Объект </span></span><span class='s4 s5 s12'><span>разработки</span></span><span
            class='s4 s5 s12'><span> – </span></span><span
            class='s4 s5'><span>онлайн сервис по расчету Инсоляции и KEO</span></span><span class='s4 s5'><span>.</span></span>
    </p>
    <p class='s0 s8 s11'>
        <span class='s4 s5 s12'><span>Результаты работы: </span></span><span
            class='s4 s5 s12'><span>р</span></span><span class='s4 s5 s12'><span>еализован локальный сервер синхронизации модели из </span></span><span
            class='s4 s5 s12'><span>Revit</span></span><span class='s4 s5 s12'><span> с веб-сервисом </span></span><span
            class='s4 s5 s12'><span>AltecInsolations</span></span><span class='s4 s5 s12'><span>. Разработана служба обновления</span></span><span
            class='s4 s5'><span> </span></span><span class='s4 s5 s12'><span>сервера. Подготовленно ядро для отправки данных из плагина </span></span><span
            class='s4 s5 s12'><span>Revit</span></span><span class='s4 s5 s12'><span> и приема их на клиенте в веб-сервисе. Все компоненты упакованы в инсталлятор.</span></span>
    </p>
    <p class='s0 s8 s11'>
        <span class='s4 s5 s12'><span>Выпускная квалификационная работа выполнена в текстовом редакторе Microsoft Word.</span></span>
    </p>
    <p class='s8 s9 s11'><span class='s4 s5 s7 s12'></span></p>
</div>
<div class='page'>
    <p class='s8 s9 s11'><span class='s4 s5 s7 s12'></span></p>
    <p class='s8 s9 s11'><br></p>
    <p class='s8 s2 s3'><span class='s4 s5 s7 s12'><span>СОДЕРЖАНИЕ</span></span></p>
    <p class='s8 s2 s3'><br></p>
    <p class='s13 s14 s2 s15'><br></p>
    <p id='mistake0' class='mistake s8 s2 s3'>
        <span class='s4 s5 s7'><span>     </span></span><span class='s4 s5 s7'><span>ВВЕДЕНИЕ</span></span><span
            class='s4 s5 s7'></span>
    </p>
    <p class='s8 s9 s11'><br></p>
    <p class='s8 s16 s11'>
        <span class='s4 s5 s12'><span>Строительство является одной из наиболее важных отраслей отечественной экономики</span></span><span
            class='s4 s5 s12'><span>, связанных как непосредственно с возведением зданий, так и с различной вспомогательной деятельностью.</span></span>
    </p>
    <p class='s8 s16 s11'>
        <span class='s4 s5 s12'><span>Данная выпускная квалификационная работа является частью разработки сервиса </span></span><span
            class='s4 s5 s12'><span>AltecInsolations</span></span><span class='s4 s5 s12'><span>, разрабатываемого компанией </span></span><span
            class='s4 s5 s12'><span>Altec</span></span><span class='s4 s5 s12'><span> Systems, нацеленного на отображение информационных моделей зданий, расчет и визуализации норм инсоляции и КЕО.</span></span>
    </p>
    <p class='s8 s9 s11'>
        <span class='s4 s5'><span> – онлайн сервис по расчету Инсоляции и KEO из BIM-моделей на отечественном ПО.</span></span>
    </p>
    <p class='s8 s9 s11'>
        <span class='s4 s5'><span>Инсоляция – достаточность попадания прямого солнечного света внутрь помещений или на участки местности для обеспечения комфортного проживания людей.</span></span>
    </p>
    <p class='s8 s9 s11'>
        <span class='s4 s5'><span>Коэффициент естественной освещенности (КЕО) — величина отношения световой энергии, попадающей в расчетную точку внутри помещения в конкретных условиях застройки, к величине световой энергии, которая попадала бы в расчетную точку в условиях, что та находилась бы под открытым небом. [1]</span></span>
    </p>
    <p class='s8 s9 s11'>
        <span class='s4 s5'><span>Программный комплекс предназначен для выполнения расчетов продолжительности инсоляции, уровня естественной освещенности, проверки выполнения рассчитанных значений нормативным требованиям и анализа затемняющих расчетную точку объектов.</span></span>
    </p>
    <p class='s8 s9 s11'>
        <span class='s4 s5'><span>Выгрузка модели из </span></span><span class='s4 s5'><span>Revit</span></span><span
            class='s4 s5'><span> в облачный сервис происходит с помощью плагина за </span></span><span
            class='s4 s5'><span>2–3</span></span><span class='s4 s5'><span> минуты. После чего по нажатию одной кнопки производятся расчеты и создается отчет.</span></span>
    </p>
    <p class='s8 s16 s11'>
        <span class='s4 s5'><span>Программный комплекс ориентирован на проектные компании. Расчет </span></span><span
            class='s4 s5'></span>
    </p>
</div>
<div class='page'>
    <p class='s8 s16 s11'><span class='s4 s5'><span>можно выполнять на любой стадии проектирования.</span></span>
    </p>
    <p class='s8 s9 s11'><span class='s4 s5'><span>Кто использует решение:</span></span></p>
    <p class='s8 s9 s11 s17'>
        <span id='mistake1' class='mistake s4 s5'><span>п</span></span><span
            class='s4 s5 s12'><span>роектные компании</span></span><span class='s4 s5'><span>;</span></span><span
            class='s4 s5'></span>
    </p>
    <p class='s8 s9 s11 s17'>
        <span id='mistake2' class='mistake s4 s5'><span>г</span></span><span class='s4 s5 s12'><span>осударственные экспертизы;</span></span><span
            class='s4 s5'></span>
    </p>
    <p class='s8 s9 s11 s17'>
        <span id='mistake3' class='mistake s4 s5'><span>к</span></span><span class='s4 s5 s12'><span>оммерческие экспертизы.</span></span><span
            class='s4 s5'></span>
    </p>
    <p class='s8 s9 s11'>
        <span class='s4 s5 s12'><span>Актуальность темы выпускной квалификационной работы заключается в том, что в реалиях активной и крупной застройки многие компании нуждаются в средствах автоматизации расчетов строительных норм для увеличения скорости и качества расчетов, сокращения рабочего времени сотрудников, уходящего на рутинные задачи.</span></span>
    </p>
    <p class='s8 s9 s11'>
        <span class='s4 s5'><span>Проблема заключается в отсутствие частичного обновления модели в сервисе. Например, пользователю при малейшем изменении своей модели приходилось полностью перезагружать её в сервис, частой практикой является то, что в модели присутствует сразу несколько объектов – зданий, и при изменении одного дома хотелось синхронизировать роботу в </span></span><span
            class='s4 s5'><span>Revit</span></span><span class='s4 s5'><span> и веб-сервисе.</span></span>
    </p>
    <p class='s8 s9 s11'>
        <span class='s4 s5'><span>Целью работы является реализация моментальной синхронизации модели из </span></span><span
            class='s4 s5'><span>Revit</span></span><span class='s4 s5'><span> с онлайн-сервисом </span></span><span
            class='s4 s5'><span>AltecInsolations</span></span><span class='s4 s5'><span>. Для достижения данной цели необходимо выполнить следующие задачи: </span></span>
    </p>
    <p class='s18 s8 s16 s11'>
        <span id='mistake4' class='mistake s4 s5'><span>р</span></span><span class='s4 s5 s12'><span>еализовать отправку измененной части модели в плагине для </span></span><span
            class='s4 s5 s12'><span>Revit</span></span><span class='s4 s5 s12'><span>;</span></span><span
            class='s4 s5'></span>
    </p>
    <p class='s18 s8 s16 s11'>
        <span id='mistake5' class='mistake s4 s5'><span>р</span></span><span class='s4 s5 s12'><span>азработать сервер синхронизации</span></span><span
            class='s4 s5 s12'><span> между</span></span><span class='s4 s5 s12'><span> </span></span><span
            class='s4 s5 s12'><span>плагином-экспортером и веб-сервисом </span></span><span class='s4 s5 s12'><span>AltecInsolations</span></span><span
            class='s4 s5 s12'><span>;</span></span><span class='s4 s5'></span>
    </p>
    <p class='s18 s8 s16 s11'>
        <span id='mistake6' class='mistake s4 s5'><span>р</span></span><span class='s4 s5 s12'><span>еализовать прием данных в веб-сервис</span></span><span
            class='s4 s5'><span>;</span></span><span class='s4 s5'></span>
    </p>
    <p class='s18 s8 s16 s11'>
        <span id='mistake7'
              class='mistake s4 s5'><span>реализовать службу обновления сервера синхронизации</span></span><span
            class='s4 s5'><span>;</span></span><span class='s4 s5'></span>
    </p>
    <p class='s18 s13 s16 s11'>
        <span id='mistake8' class='mistake s4 s5'><span>с</span></span><span
            class='s4 s5 s12'><span>озда</span></span><span class='s4 s5 s12'><span>ть</span></span><span
            class='s4 s5 s12'><span> инсталлятор</span></span><span class='s4 s5'><span>.</span></span><span
            class='s4 s5'></span>
    </p>
    <p class='s8 s2 s11'><br></p>
    <p id='mistake9' class='mistake s8 s2 s11'>
        <span id='mistake11' class='mistake s4 s5 s7'><span>Проектирование системы</span></span><span
            class='s4 s5 s7'></span><span class='s4 s5 s7'></span><span class='s4 s5 s7'></span>
    </p>
    <p id='mistake12' class='mistake s19 s8 s11'>
        <span id='mistake13' class='mistake s4 s5 s7'><span>Архитектура сервиса</span></span><span
            class='s4 s5 s7'></span><span class='s4 s5 s7'></span>
    </p>
    <p class='s8 s9 s11'><br></p>
    <p class='s8 s9 s11'>
        <span class='s4 s5'><span>Архитектура сервиса </span></span><span
            class='s4 s5'><span>AltecInsolations</span></span><span class='s4 s5'><span> представляет из себя сервер построенный по </span></span><span
            class='s4 s5'><span>микросервисной</span></span><span class='s4 s5'><span> архитектуре с файловой системой и двумя базами данных </span></span><span
            class='s4 s5'><span>MongoDB</span></span><span class='s4 s5'><span> и </span></span><span
            class='s4 s5'><span>PostgreSQL</span></span><span class='s4 s5'><span> для хранения информации о настройках, пользователях, информации о моделях и проектах проектировщиков и экспертов и т. д. Веб-сервис для расчета инсоляции и КЕО. И плагин – экспортер для </span></span><span
            class='s4 s5'><span>Revit</span></span><span class='s4 s5'><span> обрабатывающий данные и отправляющий их на сервер (рисунок 1).</span></span>
    </p>
    <p class='s8 s9 s11'>
        <span class='s4 s5'><span>Микросервисная</span></span><span class='s4 s5'><span> архитектура — это метод построения легковесных приложений. При таком подходе приложение делится на множество независимых и слабосвязанных модулей (сервисов). </span></span><span
            class='s4 s5'><span>Микросервисы</span></span><span class='s4 s5'><span> поддерживают независимое развертывание и могут быть созданы на разных языках программирования и с применением разных технологий хранения данных. </span></span><span
            class='s4 s5'><span>Микросервисы</span></span><span class='s4 s5'><span> являются альтернативой монолитам. [7]</span></span>
    </p>
    <p class='s8 s2 s3'><span class='s4 s5'></span></p>
</div>
<div class='page'>
    <p class='s8 s2 s3'><span class='s4 s5'></span></p>
    <p class='s13 s2 s3'>
        <span class='s4 s5'><span>Рисунок 1 – Архитектура до использования сервера синхронизации</span></span></p>
    <p class='s13 s2 s11'><br></p>
    <p class='s8 s9 s11'>
        <span class='s4 s5'><span>В результате анализа и рассмотрения множества вариантов стало ясно что у пользователя (проектировщика) может быть открыто несколько приложений </span></span><span
            class='s4 s5'><span>Revit</span></span><span class='s4 s5'><span> и несколько сцен нашего сервиса в браузере. Поэтому было принято решение о создании «моста» - сервера между плагином </span></span><span
            class='s4 s5'><span>Revit</span></span><span class='s4 s5'><span> и браузером пользователя.</span></span>
    </p>
    <p class='s8 s9 s11'>
        <span class='s4 s5'><span>Первоначально было решено развернуть ещё один </span></span><span class='s4 s5'><span>web</span></span><span
            class='s4 s5'><span> интерфейс, который принимал изменённые данные модели, и отправлял их обратно пользователю на сцену в браузере. Такой подход уже решал проблему, но у него были существенные недостатки. Во-первых, этот интерфейс был бы постоянно нагружен. Во-вторых, данные делали бы лишний «крюк» проходя через сервер и возвращаясь назад к пользователю. В-третьих, данные могли превышать 100 МБ, а это уже много в рамках нашего сервиса. Поэтому было </span></span><span
            class='s4 s5'></span>
    </p>
</div>
<div class='page'>
    <p class='s8 s9 s11'>
        <span class='s4 s5'><span>решено поднять локальный сервер. Находясь на одном устройстве, данные передавались между экспортером и сервисом с огромной скоростью и не нагружали бы удалённый сервер.</span></span>
    </p>
    <p class='s8 s2 s11'>
        <span class='s4 s5'><span>Возникало сразу несколько вопросов. </span></span><span class='s4 s5 s12'><span>Как этот сервер обновлять?</span></span><span
            class='s4 s5'><span> </span></span><span
            class='s4 s5 s12'><span>Какие права у него будут?</span></span><span
            class='s4 s5'><span> </span></span><span class='s4 s5 s12'><span>Сможет ли он контролировать много подключений, как из плагина, так и из веб-сервиса?</span></span>
    </p>
    <p class='s8 s9 s11'>
        <span class='s4 s5'><span>Для обновления локального сервера было принято решение развернуть Windows службу. Так как для установки </span></span><span
            class='s4 s5'><span>Revit</span></span><span class='s4 s5'><span> требуются права администратора, то мы уверены в том, что у нашего пользователя они имеются, а значит и установка нашей службы и сервера будут с правами администратора (рисунок 2).</span></span>
    </p>
    <p class='s8 s2 s11'><span class='s4 s5'></span></p>
    <p class='s8 s2 s11'><span class='s4 s5'></span></p>
    <p class='s8 s2 s3'>
        <span class='s4 s5'><span>Рисунок 2 – Схема взаимодействия сервера синхронизации</span></span></p>
    <p class='s8 s2 s11'><br></p>
    <p class='s8 s9 s11'>
        <span class='s4 s5 s12'><span>В итоге получилось два развития пути, когда пользователь первый раз загружает модель и когда её изменят. В первом случае используется старый </span></span><span
            class='s4 s5 s12'></span>
    </p>
</div>
<div class='page'>
    <p class='s8 s9 s11'>
        <span class='s4 s5 s12'><span>подход через прогон модели через удалённый сервер для полного сохранения её. Во втором случае измененная часть модели обрабатывается и через локальный сервер загружается прямо в браузер (рисунок 3).</span></span>
    </p>
    <p class='s13 s2 s15'><span class='s4 s5'></span></p>
    <p class='s13 s2 s3'><span class='s4 s5'><span>Рисунок 3 – Дорожная карта пользователя</span></span></p>
    <p class='s13 s2 s11'>
        <span class='s4 s5'><span>Таким образом была использована комбинация этих двух подходов для достижения максимального результата</span></span><span
            class='s4 s5'><span>, а также многократного увеличении скорости доставки данных.</span></span>
    </p>
    <p id='mistake14' class='mistake s20 s8 s2 s11'><span class='s4 s5 s7'></span></p>
    <p id='mistake15' class='mistake s19 s8 s11'>
        <span id='mistake16' class='mistake s4 s5 s7'><span>Сервер синхронизации</span></span><span
            class='s4 s5 s7'></span><span class='s4 s5 s7'></span>
    </p>
    <p class='s8 s9 s11'><br></p>
    <p class='s8 s9 s11'>
        <span class='s4 s5'><span>Задача заключалась в том, что данные необходимо было отправлять в реальном времени в браузер пользователю. </span></span>
    </p>
    <p class='s8 s9 s11'>
        <span class='s4 s5'><span>Для знакомых с </span></span><span class='s4 s5'><span>web</span></span><span
            class='s4 s5'><span> людей не является секретом, что протокол HTTP предполагает клиент-серверную архитектуру, в которой клиент всегда инициирует передачу данных, а сервер только отвечает на запросы клиентов. В режиме реального времени необходимо, чтобы сервер инициировал отправку данных.</span></span>
    </p>
    <p class='s8 s9 s11'><span class='s4 s5 s12'><span>Рассмотрим, какие есть решения этой проблемы.</span></span>
    </p>
    <p class='s18 s8 s16 s11 s17'>
        <span id='mistake17' class='mistake s4 s5'><span>P</span></span><span
            class='s4 s5 s12'><span>olling</span></span><span class='s4 s5'><span>;</span></span><span
            class='s4 s5'></span>
    </p>
    <p class='s18 s8 s16 s11 s17'>
        <span id='mistake18' class='mistake s4 s5'><span>L</span></span><span class='s4 s5 s12'><span>ong </span></span><span
            class='s4 s5'><span>P</span></span><span class='s4 s5 s12'><span>olling</span></span><span
            class='s4 s5 s12'><span>;</span></span><span class='s4 s5'></span>
    </p>
    <p class='s18 s8 s16 s11 s17'>
        <span id='mistake19' class='mistake s4 s5'><span>S</span></span><span
            class='s4 s5 s12'><span>erver </span></span><span class='s4 s5'><span>S</span></span><span
            class='s4 s5 s12'><span>ent</span></span><span class='s4 s5 s12'><span> </span></span><span
            class='s4 s5'><span>E</span></span><span class='s4 s5 s12'><span>vents</span></span><span class='s4 s5 s12'><span> (SSE);</span></span><span
            class='s4 s5'></span>
    </p>
    <p class='s18 s8 s16 s11 s17'>
        <span id='mistake20' class='mistake s4 s5'><span>W</span></span><span
            class='s4 s5 s12'><span>eb</span></span><span class='s4 s5'><span>S</span></span><span
            class='s4 s5 s12'><span>ocket</span></span><span class='s4 s5'><span>.</span></span><span
            class='s4 s5'></span>
    </p>
    <p class='s8 s9 s11 s17'><br></p>
    <p class='s8 s9 s11'>
        <span class='s4 s5 s12'><span>Polling</span></span><span class='s4 s5 s12'><span> - клиент по таймеру опрашивает сервер: «А не появилось ли чего-нибудь новенького?» Это самый старый и прямолинейный способ организации </span></span><span
            class='s4 s5 s12'><span>real-time</span></span><span class='s4 s5 s12'><span>. Минусов у этого подхода больше, чем плюсов: нагрузка на сеть и сервер; данные приходят не в реальном времени, а с задержкой между наступлением события и отправкой данных.</span></span>
    </p>
    <p class='s8 s9 s11'>
        <span class='s4 s5 s12'><span>Long </span></span><span class='s4 s5 s12'><span>Polling</span></span><span
            class='s4 s5 s12'><span> - клиент открывает соединение, а сервер держит его до наступления события, потом отправляет данные, после чего клиент </span></span><span
            class='s4 s5 s12'><span>переоткрывает</span></span><span class='s4 s5 s12'><span> соединение. Это уже настоящий </span></span><span
            class='s4 s5 s12'><span>real-time</span></span><span class='s4 s5 s12'><span> — нагрузка на сеть и сервер снижается. Но остается необходимость самостоятельно организовывать непрерывное соединение, следить за его обрывами и тем, чтобы передаваемые данные не потерялись в этот момент.</span></span>
    </p>
    <p class='s8 s9 s11'><span class='s4 s5 s12'></span></p>
</div>
<div class='page'>
    <p class='s8 s9 s11'>
        <span class='s4 s5 s12'><span>Server </span></span><span class='s4 s5 s12'><span>Sent</span></span><span
            class='s4 s5 s12'><span> </span></span><span class='s4 s5 s12'><span>Events</span></span><span
            class='s4 s5 s12'><span> (SSE) - поддерживаемая браузерами технология непрерывного HTTP-соединения, в котором данные передаются потоком от сервера к клиенту.</span></span>
    </p>
    <p class='s8 s9 s11'>
        <span class='s4 s5 s12'><span>WebSocket</span></span><span class='s4 s5 s12'><span> - независимый протокол поверх TCP. Это самое современное и популярное решение задачи организации передачи данных между клиентом и сервером в реальном времени. [2]</span></span>
    </p>
    <p class='s8 s9 s11'>
        <span class='s4 s5 s12'><span>Исходя из технологий выше было решено выбрать фреймворк SignalR.</span></span>
    </p>
    <p class='s8 s9 s11'>
        <span class='s4 s5 s12'><span>ASP.NET Core SignalR — это библиотека с открытым исходным кодом, которая упрощает добавление веб-функций в режиме реального времени в приложения. Веб-функции в режиме реального времени позволяют коду на стороне сервера мгновенно отправлять содержимое на клиенты.</span></span>
    </p>
    <p class='s8 s9 s11'><span class='s4 s5 s12'><span>Хорошие кандидаты для SignalR:</span></span></p>
    <p class='s8 s9 s11 s17'>
        <span id='mistake21' class='mistake s4 s5'><span>п</span></span><span class='s4 s5 s12'><span>риложения, требующие частых обновлений с сервера. Примерами являются игры, социальные сети, платформы для голосования, аукционы, карты и приложения GPS</span></span><span
            class='s4 s5'><span>;</span></span><span class='s4 s5'></span>
    </p>
    <p class='s8 s9 s11 s17'>
        <span id='mistake22' class='mistake s4 s5'><span>п</span></span><span class='s4 s5 s12'><span>анели и приложения мониторинга. Примеры включают в себя панели мониторинга компании, мгновенные обновления продаж или оповещения о поездках</span></span><span
            class='s4 s5'><span>;</span></span><span class='s4 s5'></span>
    </p>
    <p class='s8 s9 s11 s17'>
        <span id='mistake23' class='mistake s4 s5'><span>п</span></span><span class='s4 s5 s12'><span>риложения для совместной работы. Примерами таких приложений служат демонстрационные приложения и программное обеспечение для конференций</span></span><span
            class='s4 s5'><span>;</span></span><span class='s4 s5'></span>
    </p>
    <p class='s8 s9 s11 s17'>
        <span id='mistake24' class='mistake s4 s5'><span>п</span></span><span class='s4 s5 s12'><span>риложения, которым требуются уведомления. Уведомления используют социальные сети, электронная почта, чат, игры, оповещения о поездках и многие другие приложения</span></span><span
            class='s4 s5'><span>.</span></span><span class='s4 s5'></span>
    </p>
    <p class='s8 s9 s11'>
        <span class='s4 s5 s12'><span>SignalR предоставляет API для создания </span></span><span
            class='s4 s5 s12'><span>сервер-клиент". Вызов RPC вызывает функции на клиентах из кода .NET Core на стороне сервера. Существует несколько </span></span><span
            class='s4 s5 s12'><span>, каждая из которых имеет пакет SDK для клиента. Из-за этого вызов RPC вызывает различные языки программирования.</span></span>
    </p>
    <p class='s8 s2 s11 s17'>
        <span class='s4 s5 s12'><span>Ниже приведены некоторые функции SignalR для ASP.NET Core.</span></span></p>
    <p class='s18 s8 s16 s11 s17'>
        <span id='mistake25' class='mistake s4 s5'><span>у</span></span><span class='s4 s5 s12'><span>правляет автоматическим управлением соединениями</span></span><span
            class='s4 s5'><span>;</span></span><span class='s4 s5'></span>
    </p>
    <p class='s18 s8 s16 s11 s17'>
        <span id='mistake26' class='mistake s4 s5'><span>о</span></span><span class='s4 s5 s12'><span>тправляет сообщения всем подключенным клиентам одновременно. Например, комната чатов</span></span><span
            class='s4 s5'><span>;</span></span><span class='s4 s5'></span>
    </p>
    <p class='s18 s8 s16 s11 s17'>
        <span id='mistake27' class='mistake s4 s5'><span>о</span></span><span class='s4 s5 s12'><span>тправляет сообщения конкретным клиентам или группам клиентов</span></span><span
            class='s4 s5'><span>;</span></span><span class='s4 s5'></span>
    </p>
    <p class='s18 s8 s16 s11 s17'>
        <span id='mistake28' class='mistake s4 s5'><span>м</span></span><span class='s4 s5 s12'><span>асштабируется для управления увеличением трафика</span></span><span
            class='s4 s5'><span>;</span></span><span class='s4 s5'></span>
    </p>
    <p class='s18 s8 s16 s11 s17'>
        <span id='mistake29' class='mistake s4 s5'><span>и</span></span><span class='s4 s5 s12'><span>сточник размещается в SignalR репозитории на </span></span><span
            class='s4 s5 s12'><span>GitHub</span></span><span class='s4 s5 s12'><span>.</span></span><span
            class='s4 s5'></span>
    </p>
    <p class='s8 s16 s11 s17'>
        <span class='s4 s5 s12'><span>SignalR поддерживает следующие методы обработки обмена данными в режиме реального времени (в порядке правильного резерва):</span></span>
    </p>
    <p class='s18 s8 s16 s11 s17'>
        <span id='mistake30' class='mistake s4 s5 s12'><span>WebSockets</span></span><span class='s4 s5'><span>;</span></span><span
            class='s4 s5'></span>
    </p>
    <p class='s18 s8 s16 s11 s17'>
        <span id='mistake31' class='mistake s4 s5'><span>с</span></span><span class='s4 s5 s12'><span>обытия, посылаемые сервером;</span></span><span
            class='s4 s5'></span>
    </p>
    <p class='s18 s8 s16 s11 s17'>
        <span id='mistake32' class='mistake s4 s5'><span>д</span></span><span
            class='s4 s5 s12'><span>лительный опрос.</span></span><span class='s4 s5'></span>
    </p>
    <p class='s8 s16 s11'>
        <span class='s4 s5 s12'><span>SignalR автоматически выбирает лучший транспортный метод, который находится в пределах возможностей сервера и клиента.</span></span>
    </p>
    <p class='s8 s16 s11'>
        <span class='s4 s5 s12'><span>SignalR использует концентраторы для взаимодействия между клиентами и серверами.</span></span>
    </p>
    <p class='s8 s9 s11'>
        <span class='s4 s5 s12'><span>Концентратор — это высокоуровневый конвейер, который позволяет клиенту и серверу вызывать методы друг друга. SignalR автоматически обрабатывает диспетчеризации между компьютерами, позволяя клиентам вызывать методы на сервере и наоборот. Можно передать строго типизированные параметры методам, которые обеспечивают привязку модели. SignalR предоставляет два встроенных протокола концентратора: текстовый протокол на основе JSON и двоичный протокол на основе </span></span><span
            class='s4 s5'></span><span class='s4 s5'><span> HYPERLINK "https://msgpack.org/" \h </span></span><span
            class='s4 s5'></span><span class='s4 s5 s12'><span>MessagePack</span></span><span
            class='s4 s5 s12'></span><span class='s4 s5 s12'><span>. </span></span><span class='s4 s5 s12'><span>MessagePack</span></span><span
            class='s4 s5 s12'><span> обычно создает меньшие сообщения по </span></span><span class='s4 s5 s12'></span>
    </p>
</div>
<div class='page'>
    <p class='s8 s9 s11'>
        <span class='s4 s5 s12'><span>сравнению с JSON. Более старые браузеры должны поддерживать </span></span><span
            class='s4 s5 s12'><span> , чтобы обеспечить поддержку протокола </span></span><span class='s4 s5 s12'><span>MessagePack</span></span><span
            class='s4 s5 s12'><span>.</span></span>
    </p>
    <p class='s8 s9 s11'>
        <span class='s4 s5 s12'><span>Концентраторы вызывают код на стороне клиента, отправляя сообщения, содержащие имя и параметры клиентского метода. Объекты, отправляемые как параметры метода, </span></span><span
            class='s4 s5 s12'><span>десериализованы</span></span><span class='s4 s5 s12'><span> с помощью настроенного протокола. Клиент пытается сопоставить имя с методом в коде на стороне клиента. Когда клиент находит совпадение, он вызывает метод и передает ему данные </span></span><span
            class='s4 s5 s12'><span>десериализованного</span></span><span class='s4 s5 s12'><span> параметра. [3]</span></span>
    </p>
    <p class='s8 s9 s11'>
        <span class='s4 s5 s12'><span>ASP.NET Core является кроссплатформенной, высокопроизводительной средой с открытым исходным кодом для создания современных облачных приложений, подключенных к Интернету.</span></span>
    </p>
    <p class='s8 s9 s11'>
        <span class='s4 s5 s12'><span>ASP.NET Core позволяет выполнять следующие задачи:</span></span></p>
    <p class='s18 s8 s16 s11 s17'>
        <span id='mistake33' class='mistake s4 s5'><span>с</span></span><span class='s4 s5 s12'><span>оздавать веб-приложения и службы, приложения Интернета вещей (</span></span><span
            class='s4 s5 s12'><span>IoT</span></span><span class='s4 s5 s12'><span>) и серверные части для мобильных приложений</span></span><span
            class='s4 s5'><span>;</span></span><span class='s4 s5'></span>
    </p>
    <p class='s18 s8 s16 s11 s17'>
        <span id='mistake34' class='mistake s4 s5'><span>и</span></span><span class='s4 s5 s12'><span>спользовать избранные средства разработки в Windows, </span></span><span
            class='s4 s5 s12'><span>macOS</span></span><span class='s4 s5 s12'><span> и Linux</span></span><span
            class='s4 s5'><span>;</span></span><span class='s4 s5'></span>
    </p>
    <p class='s18 s8 s16 s11 s17'>
        <span id='mistake35' class='mistake s4 s5'><span>в</span></span><span class='s4 s5 s12'><span>ыполнять развертывания в облаке или локальной среде</span></span><span
            class='s4 s5'><span>;</span></span><span class='s4 s5'></span>
    </p>
    <p class='s18 s8 s16 s11 s17'>
        <span id='mistake36' class='mistake s4 s5'><span>з</span></span><span class='s4 s5 s12'><span>апускать в .NET Core. [4]</span></span><span
            class='s4 s5'></span>
    </p>
    <p class='s8 s9 s11 s17'>
        <span class='s4 s5 s12'><span>Таким образом</span></span><span class='s4 s5 s12'><span> было решено реализовать с</span></span><span
            class='s4 s5 s12'><span>ервер синхронизации</span></span><span class='s4 s5 s12'><span> на языке программирования </span></span><span
            class='s4 s5 s12'><span>C</span></span><span class='s4 s5 s12'><span># </span></span><span
            class='s4 s5 s12'><span>в среде разработки </span></span><span
            class='s4 s5 s12'><span>ASP</span></span><span class='s4 s5 s12'><span>.</span></span><span
            class='s4 s5 s12'><span>NET</span></span><span class='s4 s5 s12'><span> </span></span><span
            class='s4 s5 s12'><span>Core</span></span><span class='s4 s5 s12'><span> </span></span><span
            class='s4 s5 s12'><span>с использованием фреймворка </span></span><span
            class='s4 s5 s12'><span>SignalR</span></span><span class='s4 s5 s12'><span>. </span></span><span
            class='s4 s5 s12'><span>Что в итоге привело к снижению времени разработки, а также избавило от большого количества потенциальных багов и ошибок приложения.</span></span>
    </p>
    <p class='s8 s9 s11'><span class='s4 s5 s12'></span></p>
</div>
<div class='page'>
    <p class='s8 s9 s11'><span class='s4 s5 s12'></span></p>
    <p class='s8 s9 s11 s17'><br></p>
    <p class='s21 s8 s2 s11 s17'><br></p>
    <p id='mistake37' class='mistake s19 s8 s11'>
        <span id='mistake38' class='mistake s4 s5 s7'><span>Служба обновления</span></span><span
            class='s4 s5 s7'></span><span class='s4 s5 s7'></span>
    </p>
    <p class='s8 s9 s11'><br></p>
    <p class='s8 s9 s11'>
        <span class='s4 s5 s12'><span>Служба Windows — приложение, автоматически (если настроено) исполняемое системой при запуске операционной системы Windows и выполняющиеся вне зависимости от статуса пользователя. Имеет общие черты с концепцией демонов в Unix. [5]</span></span>
    </p>
    <p class='s8 s9 s11'>
        <span class='s4 s5 s12'><span>Для взаимодействия со службой из экспортера, был выбран протокол TCP. С его помощью служба принимает команды и в зависимости от них управляет сервером.</span></span>
    </p>
    <p class='s8 s9 s11'>
        <span class='s4 s5 s12'><span>Transmission</span></span><span class='s4 s5 s12'><span> Control Protocol (TCP, протокол управления передачей) — один из основных </span></span><span
            class='s4 s5 s12'><span> интернета. Предназначен для управления </span></span><span class='s4 s5 s12'><span>. Пакеты в TCP называются сегментами.</span></span>
    </p>
    <p class='s8 s9 s11'>
        <span class='s4 s5 s12'><span>В </span></span><span
            class='s4 s5 s12'><span> выполняет функции </span></span><span class='s4 s5 s12'><span> </span></span><span
            class='s4 s5 s12'><span>.</span></span>
    </p>
    <p class='s8 s9 s11'>
        <span class='s4 s5 s12'><span>Механизм TCP предоставляет </span></span><span class='s4 s5 s12'><span> с предварительной установкой соединения, осуществляет повторный запрос данных в случае потери данных и устраняет дублирование при получении двух копий одного пакета, гарантируя тем самым (в отличие от </span></span><span
            class='s4 s5 s12'><span>) целостность передаваемых данных и уведомление отправителя о результатах передачи.</span></span>
    </p>
    <p class='s8 s2 s11'>
        <span class='s4 s5 s12'><span>Реализации TCP обычно встроены в </span></span><span
            class='s4 s5 s12'><span> </span></span><span class='s4 s5 s12'><span>. Существуют реализации TCP, работающие в </span></span><span
            class='s4 s5 s12'><span>.</span></span>
    </p>
    <p class='s8 s9 s11'>
        <span class='s4 s5 s12'><span>Когда осуществляется передача от компьютера к компьютеру через Интернет, TCP работает на верхнем уровне между двумя конечными системами, например, </span></span><span
            class='s4 s5 s12'><span> и веб-сервером. TCP осуществляет </span></span><span class='s4 s5 s12'></span>
    </p>
</div>
<div class='page'>
    <p class='s8 s9 s11'>
        <span class='s4 s5 s12'><span>надёжную передачу потока байтов от одного процесса к другому. [6]</span></span>
    </p>
    <p class='s8 s9 s11'>
        <span class='s4 s5 s12'><span>В итоге служба</span></span><span class='s4 s5 s12'><span> обновления сервера синхронизации</span></span><span
            class='s4 s5 s12'><span>, </span></span><span class='s4 s5 s12'><span>благодаря </span></span><span
            class='s4 s5 s12'><span>TCP</span></span><span class='s4 s5 s12'><span> </span></span><span
            class='s4 s5 s12'><span>«слушателю»</span></span><span class='s4 s5 s12'><span>,</span></span><span
            class='s4 s5 s12'><span> имеет потенциал к расширению, а также многофункциональному управлению</span></span><span
            class='s4 s5 s12'><span> из любого </span></span><span
            class='s4 s5 s12'><span>десктопного</span></span><span
            class='s4 s5 s12'><span> приложения</span></span><span class='s4 s5 s12'><span>.</span></span><span
            class='s4 s5 s12'><span> Что дает огромные возможности в будущем, и гибкое управление сервером в настоящем.</span></span>
    </p>
    <p class='s8 s9 s11'><br></p>
    <p id='mistake39' class='mistake s19 s8 s11'>
        <span id='mistake40' class='mistake s4 s5 s7'><span>Веб-сервис</span></span><span class='s4 s5 s7'></span><span
            class='s4 s5 s7'></span>
    </p>
    <p class='s8 s9 s11'><br></p>
    <p class='s8 s9 s11'>
        <span class='s4 s5 s12'><span>В качестве языка для разработки веб-интерфейса </span></span><span
            class='s4 s5 s12'><span>AltecInsolations</span></span><span
            class='s4 s5 s12'><span> был выбран </span></span><span
            class='s4 s5 s12'><span>Typescript</span></span><span
            class='s4 s5 s12'><span>. В отличии от </span></span><span
            class='s4 s5 s12'><span>Javascript</span></span><span class='s4 s5 s12'><span> он обладает возможностью статической типизации, что позволяет отлавливать часть ошибок на этапе компиляции типов. Также в функционал языка входят модификаторы доступа, интерфейсы, дженерики, абстрактные классы и другие структуры, отсутствующие в </span></span><span
            class='s4 s5 s12'><span>Javascript</span></span><span class='s4 s5 s12'><span>, нацеленные на улучшение инкапсуляции, структурирование кода и упрощение рефакторинга и расширения функционала.</span></span>
    </p>
    <p class='s8 s9 s11'>
        <span class='s4 s5 s22'><span>React</span></span><span class='s4 s5 s22'><span> — это библиотека JavaScript с открытым кодом для создания внешних пользовательских интерфейсов. В отличие от других библиот</span></span><span
            class='s4 s5 s22'><span>ек JavaScript, предоставляющих полноценную платформу приложений, </span></span><span
            class='s4 s5 s22'><span>React</span></span><span class='s4 s5 s22'><span> ориентируется исключительно на создание представлений приложений через инкапсулированные единицы (называются компонентами), которые сохраняют состояние и генерируют элементы пользовательского интерфейса. Вы можете разместить отдельный компонент на веб-странице или вложить иерархии компонентов для создания сложного пользовательского интерфейса. [12]</span></span>
    </p>
    <p class='s8 s9 s11'><span class='s4 s5 s12'></span></p>
</div>
<div class='page'>
    <p class='s8 s9 s11'>
        <span class='s4 s5 s12'><span>SignalR</span></span><span class='s4 s5 s12'><span> </span></span><span
            class='s4 s5 s12'><span>использован в качестве создателя соединения между сервисом </span></span><span
            class='s4 s5 s12'><span>AltecInsolations</span></span><span class='s4 s5 s12'><span> </span></span><span
            class='s4 s5 s12'><span>и сервером синхронизации.</span></span>
    </p>
    <p class='s8 s9 s11'><br></p>
    <p id='mistake41' class='mistake s19 s8 s11'>
        <span id='mistake42' class='mistake s4 s5 s7'><span>Экспортер – плагин </span></span><span
            class='s4 s5 s7'><span>Revit</span></span><span class='s4 s5 s7'></span><span class='s4 s5 s7'></span>
    </p>
    <p class='s8 s9 s11'><br></p>
    <p class='s8 s9 s11'>
        <span class='s4 s5 s12'><span>Autodesk </span></span><span class='s4 s5 s12'><span>Revit</span></span><span
            class='s4 s5 s12'><span>, или просто </span></span><span class='s4 s5 s12'><span>Revit</span></span><span
            class='s4 s5 s12'><span> — программный комплекс, реализующий принцип информационного моделирования зданий (Building Information </span></span><span
            class='s4 s5 s12'><span>Modeling</span></span><span class='s4 s5 s12'><span>, BIM). Предназначен для архитекторов, проектировщиков несущих конструкций и инженерных систем. Предоставляет возможности трехмерного моделирования элементов здания и плоского черчения элементов оформления, создания пользовательских объектов, организации совместной работы над проектом, начиная от концепции и заканчивая выпуском рабочих чертежей и спецификаций.</span></span>
    </p>
    <p class='s8 s9 s11'>
        <span class='s4 s5 s12'><span>База данных </span></span><span class='s4 s5 s12'><span>Revit</span></span><span
            class='s4 s5 s12'><span> может содержать информацию о проекте на различных этапах жизненного цикла здания, от разработки концепции до строительства и снятия с эксплуатации.</span></span>
    </p>
    <p class='s8 s9 s11'>
        <span class='s4 s5 s12'><span>Что такое API? API – это сокращение от Application </span></span><span
            class='s4 s5 s12'><span>Programming</span></span><span class='s4 s5 s12'><span> Interface (интерфейс программирования приложений). API является средством взаимодействия программиста с программным продуктом. </span></span><span
            class='s4 s5 s12'><span>Revit</span></span><span class='s4 s5 s12'><span> API, например, предоставляет программистам доступ к функциональным возможностям </span></span><span
            class='s4 s5 s12'><span>Revit</span></span><span class='s4 s5 s12'><span> и позволяет писать инструкции, которые </span></span><span
            class='s4 s5 s12'><span>Revit</span></span><span class='s4 s5 s12'><span> будет выполнять по порядку. Взглянем на процесс немного с другой стороны. Коммерческие компании-разработчики программного обеспечения, такие как Autodesk, часто предоставляют наборы библиотек, которые можно применять в пользовательских приложениях для взаимодействия с программными продуктами (Autodesk </span></span><span
            class='s4 s5 s12'><span>Revit</span></span><span class='s4 s5 s12'><span> и др.), расширяя таким образом их функциональность. Такие наборы библиотек называются API программных </span></span><span
            class='s4 s5 s12'></span>
    </p>
</div>
<div class='page'>
    <p class='s8 s9 s11'>
        <span class='s4 s5 s12'><span>продуктов. Техника написания приложений, создаваемых для расширения функциональности программного продукта, зависит от структуры API и от перечня функций, доступ к которым он предоставляет. Что такое плагины? </span></span>
    </p>
    <p class='s8 s9 s11'>
        <span class='s4 s5 s12'><span>Плагины – это программные модули или файлы, которые добавляют дополнительные функциональные возможности в целевой продукт (обычно в виде команд, автоматизирующих некоторые действия). Когда мы говорим о плагинах для </span></span><span
            class='s4 s5 s12'><span>Revit</span></span><span class='s4 s5 s12'><span> (для них применяются также термины «надстройка», «дополнение» и «подключаемый модуль»), мы имеем в виду модули, содержащие код, который взаимодействует с </span></span><span
            class='s4 s5 s12'><span>Revit</span></span><span class='s4 s5 s12'><span> API. </span></span><span
            class='s4 s5 s12'><span>Revit</span></span><span class='s4 s5 s12'><span> загружает плагины и использует их в определенных ситуациях – например, когда пользователь вызывает ту или иную команду. [9]</span></span>
    </p>
    <p class='s8 s9 s11'>
        <span class='s4 s5 s12'><span>Плагины для </span></span><span class='s4 s5 s12'><span>Revit</span></span><span
            class='s4 s5 s12'><span> в основном</span></span><span class='s4 s5 s12'><span> </span></span><span
            class='s4 s5 s12'><span>разрабатываются на языке программирования </span></span><span
            class='s4 s5 s12'><span>C</span></span><span class='s4 s5 s12'><span>#</span></span><span class='s4 s5 s12'><span> на платформе </span></span><span
            class='s4 s5 s12'><span>.</span></span><span class='s4 s5 s12'><span>NET</span></span><span
            class='s4 s5 s12'><span> </span></span><span class='s4 s5 s12'><span>Framework</span></span><span
            class='s4 s5 s12'><span>.</span></span><span class='s4 s5 s12'><span> Так как это самый мощный и гибкий способ, позволяющий выходить за рамки родительского приложения (</span></span><span
            class='s4 s5 s12'><span>Autodesk</span></span><span class='s4 s5 s12'><span> </span></span><span
            class='s4 s5 s12'><span>Revit</span></span><span class='s4 s5 s12'><span>).</span></span>
    </p>
    <p class='s8 s23 s11'><br></p>
    <p class='s8 s2 s11'><span class='s4 s5'></span></p>
</div>
<div class='page'>
    <p class='s8 s2 s11'><span class='s4 s5'></span></p>
    <p class='s8 s2 s11'><br></p>
    <p id='mistake43' class='mistake s24 s8 s11'>
        <span id='mistake45' class='mistake s4 s5 s7'><span>Реализа</span></span><span class='s4 s5 s7'><span>ция системы</span></span><span
            class='s4 s5 s7'></span><span class='s4 s5 s7'></span><span class='s4 s5 s7'></span>
    </p>
    <p id='mistake46' class='mistake s19 s8 s11'>
        <span id='mistake47' class='mistake s4 s5 s7'><span>Разработка сервера синхронизации</span></span><span
            class='s4 s5 s7'></span><span class='s4 s5 s7'></span>
    </p>
    <p class='s8 s9 s11'><br></p>
    <p class='s8 s9 s11'><span class='s4 s5'><span>Сервер синхронизации состоит из трех компонентов:</span></span>
    </p>
    <p class='s18 s8 s9 s11'>
        <span id='mistake48' class='mistake s4 s5'><span>к</span></span><span class='s4 s5 s12'><span>онтроллера для получения сведений о соединении и отправки данных (</span></span><span
            class='s4 s5 s12'><span>ConnectorController</span></span><span class='s4 s5 s12'><span>);</span></span><span
            class='s4 s5'></span>
    </p>
    <p class='s18 s8 s9 s11'>
        <span id='mistake49' class='mistake s4 s5'><span>к</span></span><span class='s4 s5 s12'><span>онцентратора соединений (</span></span><span
            class='s4 s5 s12'><span>ConnectorHub</span></span><span class='s4 s5 s12'><span>);</span></span><span
            class='s4 s5'></span>
    </p>
    <p class='s18 s8 s16 s11'>
        <span id='mistake50' class='mistake s4 s5'><span>с</span></span><span class='s4 s5 s12'><span>ервиса хранения соединений (</span></span><span
            class='s4 s5 s12'><span>ConnectorStorageService</span></span><span
            class='s4 s5 s12'><span>).</span></span><span class='s4 s5'></span>
    </p>
    <p class='s8 s9 s11'>
        <span class='s4 s5'><span>Когда открывается сцена с моделью в сервисе </span></span><span class='s4 s5'><span>AltecInsolations</span></span><span
            class='s4 s5'><span>, с помощью SignalR улетает запрос на соединение в концентратор сервера. Все нужные данные об этом соединении сохраняются в сервис хранения соединений.</span></span>
    </p>
    <p class='s8 s9 s11'>
        <span class='s4 s5'><span>Контроллер содержит два </span></span><span class='s4 s5'><span>get</span></span><span
            class='s4 s5'><span> запроса на получение всех соединений и какого-то одного конкретного соединения по имени проекта и один </span></span><span
            class='s4 s5'><span>post</span></span><span class='s4 s5'><span> запрос для отправки данных на открытую сцену веб-сервиса</span></span><span
            class='s4 s5'><span> </span></span><span class='s4 s5'><span>(рисунок 4)</span></span><span
            class='s4 s5'><span>.</span></span>
    </p>
    <p class='s8 s9 s11'>
        <span class='s4 s5'><span>Когда приходит </span></span><span class='s4 s5'><span>post</span></span><span
            class='s4 s5'><span> запрос с данными и именем проекта, метод получает из сервиса соединений нужное, путём простого перебора всех элементов словаря, далее отправляет потоковой передачей данные прямиком в браузер. (Приложение А)</span></span><span
            class='s4 s5'><span> </span></span><span class='s4 s5'></span>
    </p>
</div>
<div class='page'>
    <p class='s8 s9 s11'><span class='s4 s5'></span></p>
    <p class='s8 s9 s3'>
        <span class='s4 s5'><span>Рисунок 4 – Диаграмма событий сервера синхронизации</span></span></p>
    <p class='s25 s8 s2 s11'><br></p>
    <p class='s25 s8 s2 s11'><br></p>
    <p class='s8 s9 s11'><br></p>
    <p id='mistake51' class='mistake s19 s8 s11'>
        <span id='mistake52' class='mistake s4 s5 s7'><span>Разработка службы обновления</span></span><span
            class='s4 s5 s7'></span><span class='s4 s5 s7'></span>
    </p>
    <p class='s8 s9 s11'><br></p>
    <p class='s8 s9 s11'><span class='s4 s5'><span>Служба обновления состоит из трех компонентов:</span></span>
    </p>
    <p class='s18 s8 s16 s11'>
        <span id='mistake53' class='mistake s4 s5'><span>с</span></span><span class='s4 s5 s12'><span>ервиса загрузки, выгрузки сборки с сервером (</span></span><span
            class='s4 s5 s12'><span>AssemblyService</span></span><span class='s4 s5 s12'><span>);</span></span><span
            class='s4 s5'></span>
    </p>
    <p class='s18 s8 s16 s11'>
        <span id='mistake54' class='mistake s4 s5'><span>с</span></span><span class='s4 s5 s12'><span>ервера TCP – «слушателя» TCP – клиентов (</span></span><span
            class='s4 s5 s12'><span>TcpServer</span></span><span class='s4 s5 s12'><span>);</span></span><span
            class='s4 s5'></span>
    </p>
    <p class='s18 s8 s16 s11'>
        <span id='mistake55' class='mistake s4 s5'><span>с</span></span><span
            class='s4 s5 s12'><span>амой службы (</span></span><span class='s4 s5 s12'><span>Worker</span></span><span
            class='s4 s5 s12'><span>)</span></span><span class='s4 s5'><span>.</span></span><span class='s4 s5'></span>
    </p>
    <p class='s8 s9 s11'>
        <span class='s4 s5'><span>Было принято решение что служба будет сама запускать сервер </span></span><span
            class='s4 s5'></span>
    </p>
</div>
<div class='page'>
    <p class='s8 s9 s11'>
        <span class='s4 s5'><span>подгружая его сборку себе в домен, таким образом мы избавляемся от лишних действий с правами на запуск и уменьшаем количество запущенных процессов. Так как сервис обновления плагина находится в самом себе, и уже был готов, на момент реализации сервера синхронизации, то было принято использовать его для замены </span></span><span
            class='s4 s5'><span>dll</span></span><span class='s4 s5'><span> файла (сборки). Так как </span></span><span
            class='s4 s5'><span>Revit</span></span><span class='s4 s5'><span> обладает ограниченными правами, а также его экземпляров может быть запущенно несколько, то запуск сервера полностью предоставлялся службе.</span></span>
    </p>
    <p class='s8 s9 s11'>
        <span class='s4 s5'><span>При запуске компьютера пользователя автоматически запускается служба, следующим шагом она подгружает и запускает сервер. Когда появляется новое обновление сервера, с экспортера приходит TCP сообщение о том, что требуется удалить из домена сборку, чтобы получить доступ на её изменение. После обновления сервера синхронизации он обратно подгружается в домен и запускается</span></span><span
            class='s4 s5'><span> </span></span><span class='s4 s5'><span>(рисунок 5)</span></span><span
            class='s4 s5'><span>.</span></span>
    </p>
    <p class='s8 s9 s11'>
        <span class='s4 s5'><span>Запуск осуществляется с помощью рефлексии, а именно находится тип «Program», далее находится метод «</span></span><span
            class='s4 s5'><span>StartServer</span></span><span class='s4 s5'><span>», создаётся экземпляр класса этого типа и вызывается вышеупомянутый метод.   (Приложение Б)</span></span><span
            class='s4 s5'></span>
    </p>
</div>
<div class='page'>
    <p class='s8 s9 s11'><span class='s4 s5'></span></p>
    <p class='s8 s9 s3'>
        <span class='s4 s5'><span>Рисунок 5 – Диаграмма событий службы обновления сервера</span></span></p>
    <p class='s8 s23 s11'><br></p>
    <p class='s8 s9 s11'><br></p>
    <p id='mistake56' class='mistake s19 s8 s11'>
        <span id='mistake57'
              class='mistake s4 s5 s7'><span>Подготовка ядра для приема данных в сервисе</span></span><span
            class='s4 s5 s7'></span><span class='s4 s5 s7'></span>
    </p>
    <p class='s8 s9 s11'><br></p>
    <p class='s8 s9 s11'>
        <span class='s4 s5'><span>В веб-сервисе был реализован функционал подключения к серверу при открытии сцены, а также прием данных. </span></span>
    </p>
    <p class='s8 s9 s11'>
        <span class='s4 s5'><span>Схема работы довольно проста. Сначала происходит соединение с </span></span><span
            class='s4 s5'></span>
    </p>
</div>
<div class='page'>
    <p class='s8 s9 s11'>
        <span class='s4 s5'><span>сервером, за счет концентратора SignalR, по нему отправляется информация о открытом проекте, которая в последующем потребуется для того, чтобы отправить данные в нужную вкладку или браузер. Далее это соединение остаётся открытым до тех пор, пока не придет измененная часть модели. В последующем и нужно будет обработать и загрузить в 3D движок Babylon.js.</span></span>
    </p>
    <p class='s8 s9 s11'><br></p>
    <p id='mistake58' class='mistake s19 s8 s11'>
        <span id='mistake59'
              class='mistake s4 s5 s7'><span>Подготовка ядра для отправки данных из экспортера</span></span><span
            class='s4 s5 s7'></span><span class='s4 s5 s7'></span>
    </p>
    <p class='s8 s9 s11'><br></p>
    <p class='s8 s9 s11'>
        <span class='s4 s5'><span>В плагине – экспортере был разработан и внедрён сервис, отправляющий данные на сервер синхронизации, а также команды в службу обновления сервера, такие как загрузка, выгрузка сборки, и запуск, остановка сервера.</span></span>
    </p>
    <p class='s8 s9 s11'><span class='s4 s5'><span>Запрос с данными отправляется по HTTP протоколу.</span></span>
    </p>
    <p class='s8 s9 s11'>
        <span class='s4 s5'><span>HTTP (</span></span><span class='s4 s5'><span>HyperText</span></span><span
            class='s4 s5'><span> Transfer Protocol — протокол передачи гипертекста) — </span></span><span class='s4 s5'><span>символьно</span></span><span
            class='s4 s5'><span>-ориентированный клиент-серверный протокол прикладного уровня без сохранения состояния, используемый сервисом World Wide Web.</span></span>
    </p>
    <p class='s8 s9 s11'>
        <span class='s4 s5'><span>Основным объектом манипуляции в HTTP является ресурс, на который указывает URI (</span></span><span
            class='s4 s5'><span>Uniform</span></span><span class='s4 s5'><span> Resource </span></span><span
            class='s4 s5'><span>Identifier</span></span><span class='s4 s5'><span> – уникальный идентификатор ресурса) в запросе клиента. Основными ресурсами являются хранящиеся на сервере файлы, но ими могут быть и другие логические (напр. каталог на сервере) или абстрактные объекты (напр. ISBN). Протокол HTTP позволяет указать способ представления (кодирования) одного и того же ресурса по различным параметрам: </span></span><span
            class='s4 s5'><span>mime</span></span><span class='s4 s5'><span>-типу, языку и т. д. Благодаря этой возможности клиент и веб-сервер могут обмениваться двоичными данными, хотя данный протокол является текстовым. [11]</span></span>
    </p>
    <p class='s8 s9 s11'>
        <span class='s4 s5'><span>Для того чтобы измененная модель была доставлена по нужному адресу требуется всего лишь знать имя проекта, которое экспортер изначально получает с удаленного сервера </span></span><span
            class='s4 s5'><span>AltecInsolations</span></span><span class='s4 s5'><span>.</span></span>
    </p>
    <p class='s8 s9 s11'><span class='s4 s5'></span></p>
</div>
<div class='page'>
    <p class='s8 s9 s11'>
        <span class='s4 s5'><span>На рисунке </span></span><span class='s4 s5'><span>6</span></span><span class='s4 s5'><span> можно видеть полную схему взаимодействия компонентов синхронизации.</span></span>
    </p>
    <p class='s8 s2 s11'><span class='s4 s5'></span></p>
    <p class='s8 s2 s3'>
        <span class='s4 s5'><span>Рисунок </span></span><span class='s4 s5'><span>6</span></span><span
            class='s4 s5'><span> – Полная схема взаимодействия с сервером синхронизации</span></span>
    </p>
    <p class='s8 s9 s11'><br></p>
    <p class='s8 s9 s11'><br></p>
    <p class='s8 s9 s11'><br></p>
    <p class='s8 s9 s11'><br></p>
    <p id='mistake60' class='mistake s19 s8 s11'>
        <span id='mistake61' class='mistake s4 s5 s7'><span>Создание инсталлятора</span></span><span
            class='s4 s5 s7'></span><span class='s4 s5 s7'></span>
    </p>
    <p class='s8 s2 s11'><br></p>
    <p class='s8 s9 s11'>
        <span class='s4 s5'><span>После завершения разработки всех компонентов синхронизации, требовалось их упаковать в инсталлятор</span></span><span
            class='s4 s5'><span> под операционную систему </span></span><span
            class='s4 s5'><span>Windows</span></span><span
            class='s4 s5'><span>. Выбор упал на Advanced </span></span><span class='s4 s5'><span>Installer</span></span><span
            class='s4 s5'><span>.</span></span>
    </p>
    <p class='s8 s9 s11'><span class='s4 s5'></span></p>
</div>
<div class='page'>
    <p class='s8 s9 s11'>
        <span class='s4 s5'><span>Advanced </span></span><span class='s4 s5'><span>Installer</span></span><span
            class='s4 s5'><span> — это мощное и простое в использовании средство для создания программ установок в формате MSI / EXE / CAB за считанные минуты. Решение Advanced </span></span><span
            class='s4 s5'><span>Installer</span></span><span class='s4 s5'><span> основывается на использовании стандартных открытых форматов. Файлы проектов сохраняются в формате XML, что упрощает их интеграцию с системами управления исходными текстами. Advanced </span></span><span
            class='s4 s5'><span>Installer</span></span><span class='s4 s5'><span> - профессиональный инструмент для создания MSI-установщиков приложений под операционные системы Windows. [8]</span></span>
    </p>
    <p class='s8 s9 s11'>
        <span class='s4 s5'><span>Существует такая практика, что у проектировщика на компьютере установлено несколько версий </span></span><span
            class='s4 s5'><span>Revit</span></span><span class='s4 s5'><span>. Чтобы установить плагин требуется положить файл с расширением </span></span><span
            class='s4 s5'><span>addin</span></span><span class='s4 s5'><span> в папку с соответствующей версией «</span></span><span
            class='s4 s5'><span>C:\Users\[</span></span><span class='s4 s5'><span>User]\AppData\Roaming\Autodesk\Revit\Addins\[Version]».</span></span>
    </p>
    <p class='s8 s9 s11'>
        <span class='s4 s5'><span>Появилась задача при установке предоставить пользователю выбор в какие версии </span></span><span
            class='s4 s5'><span>Revit</span></span><span class='s4 s5'><span> установить экспортер. Для этого был написан скрипт на языке VBS, который обнаруживал установленные версии </span></span><span
            class='s4 s5'><span>Revit</span></span><span class='s4 s5'><span>.</span></span>
    </p>
    <p class='s8 s9 s11'>
        <span class='s4 s5'><span>VBScript</span></span><span class='s4 s5'><span> (VBS, развернуто Microsoft Visual Basic </span></span><span
            class='s4 s5'><span>Script</span></span><span
            class='s4 s5'><span> Edition, иногда Visual Basic </span></span><span
            class='s4 s5'><span>Script</span></span><span class='s4 s5'><span>) — язык сценариев, созданный компанией Microsoft на основе языка Visual Basic, предназначенный для применения в приложениях, использующих технологию Active </span></span><span
            class='s4 s5'><span>Scripting</span></span><span class='s4 s5'><span>. [10]</span></span>
    </p>
    <p class='s8 s9 s11'><br></p>
    <p class='s8 s2 s15'><br></p>
    <p class='s13 s14 s2 s15'><span class='s4 s5'></span></p>
</div>
<div class='page'>
    <p class='s13 s14 s2 s15'><span class='s4 s5'></span></p>
    <p class='s13 s2 s11'><br></p>
    <p id='mistake62' class='mistake s8 s2 s3'>
        <span class='s4 s5 s7'><span>ЗАКЛЮЧЕНИЕ</span></span><span class='s4 s5 s7'></span></p>
    <p class='s8 s9 s11'><br></p>
    <p class='s8 s9 s11'>
        <span class='s4 s5 s12'><span>В процессе работы цель была достигнута. Реализован локальный сервер синхронизации модели из </span></span><span
            class='s4 s5 s12'><span>Revit</span></span><span class='s4 s5 s12'><span> с веб-сервисом </span></span><span
            class='s4 s5 s12'><span>AltecInsolations</span></span><span class='s4 s5 s12'><span>. Разработана служба обновления</span></span><span
            class='s4 s5'><span> </span></span><span class='s4 s5 s12'><span>сервера, способная полностью управлять им, а именно подгружать его в домен, запускать, останавливать и удалять. Подготовленно ядро для отправки данных из плагина </span></span><span
            class='s4 s5 s12'><span>Revit</span></span><span class='s4 s5 s12'><span> и приема их на клиенте в веб-сервисе. Все компоненты упакованы в инсталлятор.</span></span>
    </p>
    <p class='s8 s9 s11'>
        <span class='s4 s5 s12'><span>В результате было получено многократное ускорение при отправке модели </span></span><span
            class='s4 s5 s12'><span>Revit</span></span><span class='s4 s5 s12'><span> после её изменения. И заложен фундамент под формирование новых улучшение за счёт поднятого изменяемого локального сервера.</span></span>
    </p>
    <p class='s8 s9 s11'><br></p>
    <p id='mistake63' class='mistake s8 s2 s3'><span class='s4 s5 s7'></span></p>
</div>
<div class='page'>
    <p id='mistake63' class='mistake s8 s2 s3'>
        <span class='s4 s5 s7'></span><span class='s4 s5 s7'><span>ОБОЗНАЧЕНИЯ И СОКРАЩЕНИЯ</span></span><span
            class='s4 s5 s7'></span>
    </p>
    <p class='s8 s9 s11'><br></p>
    <p class='s8 s9 s11'>
        <span class='s4 s5'><span> </span></span><span class='s4 s5'><span>–</span></span><span
            class='s4 s5'><span> </span></span><span class='s4 s5'><span>онлайн сервис по расчету Инсоляции и KEO</span></span><span
            class='s4 s5'><span>.</span></span>
    </p>
    <p class='s8 s9 s11'>
        <span class='s4 s5'><span>КЕО</span></span><span class='s4 s5'><span> –</span></span><span
            class='s4 s5'><span> </span></span><span class='s4 s5'><span>к</span></span><span class='s4 s5'><span>оэффициент естественной освещенности</span></span><span
            class='s4 s5'><span>.</span></span>
    </p>
    <p class='s8 s9 s11'>
        <span class='s4 s5'><span>BIM</span></span><span class='s4 s5'><span> – </span></span><span class='s4 s5'><span>сокращение от</span></span><span
            class='s4 s5'><span> </span></span><span
            class='s4 s5'><span>Building Information Model или </span></span><span
            class='s4 s5'><span>Modeling</span></span><span class='s4 s5'><span> – </span></span><span
            class='s4 s5'><span>информационная модель (или моделирование) </span></span><span class='s4 s5'><span> и сооружений</span></span>
    </p>
    <p class='s8 s9 s11'>
        <span class='s4 s5'><span>ПО</span></span><span class='s4 s5'><span> </span></span><span class='s4 s5'><span>– программное обеспечение.</span></span>
    </p>
    <p class='s8 s9 s11'>
        <span class='s4 s5'><span>Revit</span></span><span class='s4 s5'><span> </span></span><span class='s4 s5'><span>–</span></span><span
            class='s4 s5'><span> </span></span><span class='s4 s5'><span>программный комплекс для автоматизированного проектирования.</span></span>
    </p>
    <p class='s26 s8 s2 s11'>
        <span class='s4 s5'><span>MongoDB </span></span><span class='s4 s5'><span>–</span></span><span
            class='s4 s5'><span> это </span></span><span class='s4 s5'><span>документоориентированная</span></span><span
            class='s4 s5'><span> база данных типа </span></span><span class='s4 s5'><span>NoSQL</span></span><span
            class='s4 s5'><span>.</span></span><span class='s4 s5'><span> </span></span><span class='s4 s5'><span>PostgreSQL</span></span><span
            class='s4 s5'><span> – </span></span><span class='s4 s5'><span>свободная</span></span><span
            class='s4 s5'><span> </span></span><span class='s4 s5'><span>объектно-реляционная</span></span><span
            class='s4 s5'><span> </span></span><span
            class='s4 s5'><span>система управления базами данных</span></span><span
            class='s4 s5'><span> </span></span><span class='s4 s5'><span>(СУБД).</span></span>
    </p>
    <p class='s8 s9 s11'>
        <span class='s4 s5'><span>HTTP</span></span><span class='s4 s5'><span> </span></span><span
            class='s4 s5'><span>(</span></span><span class='s4 s5'><span>HyperText</span></span><span
            class='s4 s5'><span> Transfer Protocol </span></span><span class='s4 s5'><span>–</span></span><span
            class='s4 s5'><span> </span></span><span class='s4 s5'><span>«протокол передачи </span></span><span
            class='s4 s5'><span>») — </span></span><span class='s4 s5'><span> </span></span><span class='s4 s5'><span> передачи данных</span></span><span
            class='s4 s5'><span>.</span></span>
    </p>
    <p class='s8 s9 s11'>
        <span class='s4 s5'><span>TCP</span></span><span class='s4 s5'><span> </span></span><span
            class='s4 s5'><span>–</span></span><span class='s4 s5'><span> </span></span><span class='s4 s5'><span>сокращение от </span></span><span
            class='s4 s5 s12'><span>Transmission</span></span><span class='s4 s5 s12'><span> Control Protocol (протокол управления передачей)</span></span><span
            class='s4 s5 s12'><span>,</span></span><span class='s4 s5 s12'><span> один из основных </span></span><span
            class='s4 s5 s12'><span> интернета</span></span><span class='s4 s5 s12'><span>.</span></span>
    </p>
    <p class='s8 s9 s11'>
        <span class='s4 s5'><span>ASP</span></span><span class='s4 s5'><span>.</span></span><span class='s4 s5'><span>NET </span></span><span
            class='s4 s5'><span>(</span></span><span class='s4 s5'><span>Active</span></span><span
            class='s4 s5'><span> </span></span><span class='s4 s5'><span>Server</span></span><span
            class='s4 s5'><span> </span></span><span class='s4 s5'><span>Pages</span></span><span class='s4 s5'><span> для .</span></span><span
            class='s4 s5'><span>NET</span></span><span class='s4 s5'><span>)</span></span><span
            class='s4 s5'><span> </span></span><span class='s4 s5'><span>–</span></span><span class='s4 s5'><span> платформа разработки</span></span><span
            class='s4 s5'><span> </span></span><span class='s4 s5'><span>.</span></span>
    </p>
    <p class='s8 s9 s11'>
        <span class='s4 s5'><span>SignalR</span></span><span class='s4 s5'><span> </span></span><span
            class='s4 s5'><span>–</span></span><span class='s4 s5'><span> </span></span><span class='s4 s5'><span>это библиотека для </span></span><span
            class='s4 s5'><span>ASP</span></span><span class='s4 s5'><span>.</span></span><span
            class='s4 s5'><span>NET</span></span><span class='s4 s5'><span> разработчиков, которая упрощает процесс добавления веб-функций в режиме реального времени к приложениям</span></span><span
            class='s4 s5'><span>.</span></span>
    </p>
    <p class='s8 s9 s11'>
        <span class='s4 s5 s12'><span>Концентратор </span></span><span class='s4 s5 s12'><span>–</span></span><span
            class='s4 s5 s12'><span> это высокоуровневый конвейер, который позволяет клиенту и серверу вызывать методы друг друга.</span></span>
    </p>
    <p class='s8 s9 s11'>
        <span class='s4 s5'><span>URI</span></span><span class='s4 s5'><span> – </span></span><span
            class='s4 s5 s12'><span>сокращение от </span></span><span class='s4 s5'><span>Uniform</span></span><span
            class='s4 s5'><span> Resource </span></span><span class='s4 s5'><span>Identifier</span></span><span
            class='s4 s5'><span> </span></span><span class='s4 s5'><span>(</span></span><span class='s4 s5'><span>уникальный идентификатор ресурса)</span></span><span
            class='s4 s5'><span>.</span></span>
    </p>
    <p class='s8 s9 s11'>
        <span class='s4 s5 s12'><span>API – сокращение от Application </span></span><span class='s4 s5 s12'><span>Programming</span></span><span
            class='s4 s5 s12'><span> Interface (интерфейс </span></span><span class='s4 s5 s12'></span>
    </p>
</div>
<div class='page'>
    <p class='s8 s9 s11'>
        <span class='s4 s5 s12'><span>программирования приложений)</span></span><span
            class='s4 s5 s12'><span>.</span></span>
    </p>
    <p class='s8 s9 s11'>
        <span class='s4 s5 s22'><span>React</span></span><span class='s4 s5 s22'><span> </span></span><span
            class='s4 s5 s22'><span>–</span></span><span class='s4 s5 s22'><span> </span></span><span class='s4 s5 s22'><span>это библиотека JavaScript с открытым кодом для создания внешних пользовательских интерфейсов.</span></span>
    </p>
    <p class='s8 s9 s11'>
        <span class='s4 s5 s12'><span>JSON</span></span><span class='s4 s5 s12'><span> </span></span><span
            class='s4 s5 s12'><span>–</span></span><span class='s27 s28 s29'><span> </span></span><span
            class='s4 s5 s22'><span>текстовый формат обмена данными, основанный на JavaScript</span></span><span
            class='s4 s5 s22'><span>.</span></span>
    </p>
    <p class='s8 s9 s11'>
        <span class='s4 s5'><span>VBScript</span></span><span class='s4 s5'><span> (VBS, развернуто Microsoft Visual Basic </span></span><span
            class='s4 s5'><span>Script</span></span><span
            class='s4 s5'><span> Edition, иногда Visual Basic </span></span><span
            class='s4 s5'><span>Script</span></span><span class='s4 s5'><span>) — язык сценариев, созданный компанией Microsoft на основе языка Visual Basic</span></span><span
            class='s4 s5'><span>.</span></span>
    </p>
    <p class='s8 s9 s11'>
        <span class='s4 s5'><span>Babylon.js</span></span><span class='s4 s5'><span> </span></span><span
            class='s4 s5'><span>–</span></span><span class='s27 s5 s30'><span> </span></span><span class='s4 s5'><span>простой в использовании движок трехмерной (3D) графики на базе </span></span><span
            class='s4 s5'><span>WebGL</span></span><span class='s4 s5'><span>.</span></span>
    </p>
    <p class='s8 s9 s11'>
        <span class='s4 s5'><span>Advanced </span></span><span class='s4 s5'><span>Installer</span></span><span
            class='s4 s5'><span> — это мощное и простое в использовании средство для создания программ установок</span></span><span
            class='s4 s5'><span>.</span></span>
    </p>
    <p class='s8 s9 s11'><br></p>
    <p class='s8 s9 s11'><br></p>
    <p class='s8 s9 s11'><br></p>
    <p class='s8 s2 s11'><span class='s4 s5'></span></p>
</div>
<div class='page'>
    <p class='s8 s2 s11'><span class='s4 s5'></span></p>
    <p id='mistake64' class='mistake s8 s2 s3'><span class='s4 s5 s7'></span></p>
    <p class='s8 s2 s3'><span class='s4 s5 s7'><span>БИБЛИОГРАФИЧЕСКИЙ СПИСОК</span></span></p>
    <p class='s8 s9 s11'><br></p>
    <p class='s18 s8 s16 s11'>
        <span class='s4 s5'><span>Расчет инсоляции и КЕО (коэффициента естественной освещенности) [Электронный ресурс] // </span></span><span
            class='s4 s5'><span>iD</span></span><span class='s4 s5'><span> группа https://idgruppa.ru/services/insolyacia-keo/ (Дата обращения – 21.05.2022)</span></span>
    </p>
    <p class='s18 s8 s16 s11'>
        <span class='s4 s5'><span>Вам посылка, или как мы доставляем сообщения с сервера на клиент в реальном времени [Электронный ресурс] // </span></span><span
            class='s4 s5'><span>Хабр</span></span><span class='s4 s5'><span> https://habr.com/ru/company/superjob/blog/649053/ (Дата обращения – 20.05.2022)</span></span>
    </p>
    <p class='s18 s8 s16 s11'>
        <span class='s4 s5'><span>Общие сведения об ASP.NET Core SignalR [Электронный ресурс] // Microsoft </span></span><span
            class='s4 s5'><span>Docs</span></span><span class='s4 s5'><span> https://docs.microsoft.com/ru-ru/aspnet/core/signalr/introduction?view=aspnetcore-6.0 (Дата обращения – 20.05.2022)</span></span>
    </p>
    <p class='s18 s8 s16 s11'>
        <span class='s4 s5'><span>Общие сведения об ASP.NET Core [Электронный ресурс] // Microsoft </span></span><span
            class='s4 s5'><span>Docs</span></span><span class='s4 s5'><span> https://docs.microsoft.com/ru-ru/aspnet/core/introduction-to-aspnet-core?view=aspnetcore-6.0 (Дата обращения – 20.05.2022)</span></span>
    </p>
    <p class='s18 s8 s16 s11'>
        <span class='s4 s5'><span>Служба Windows [Электронный ресурс] // Википедия https://ru.wikipedia.org/w/index.phptitle=Служба_Windows&stable=1 (Дата обращения – 20.05.2022)</span></span>
    </p>
    <p class='s18 s8 s16 s11'>
        <span class='s4 s5 s12'><span>Transmissio</span></span><span class='s4 s5 s12'><span>n</span></span><span
            class='s4 s5 s12'><span> Control Protocol [Электронный ресурс] // Википедия https://ru.wikipedia.org/wiki/Transmission_Control_Protocol (Дата обращения – 20.05.2022)</span></span>
    </p>
    <p class='s18 s8 s16 s11'>
        <span class='s4 s5 s12'><span>Микросервисная</span></span><span class='s4 s5 s12'><span> архитектура от А до Я [Электронный ресурс] // </span></span><span
            class='s4 s5 s12'><span>BellSoft</span></span><span class='s4 s5 s12'><span> https://libericajdk.ru/announcements/2021/12/02/microservices-101/ (Дата обращения – 20.05.2022)</span></span>
    </p>
    <p class='s18 s8 s16 s11'>
        <span class='s4 s5 s12'><span>Advanced </span></span><span class='s4 s5 s12'><span>Installer</span></span><span
            class='s4 s5 s12'><span> [Электронный ресурс] // 4PDA </span></span><span class='s4 s5 s12'></span>
    </p>
</div>
<div class='page'>
    <p class='s18 s8 s16 s11'>
        <span class='s4 s5 s12'><span>https://4pda.to/forum/index.php?showtopic=184907&st=20 (Дата обращения – 20.05.2022)</span></span>
    </p>
    <p class='s18 s8 s16 s11'>
        <span class='s4 s5 s12'><span>Урок 1: Общее представление о программе [Электронный ресурс] // Autodesk https://damassets.autodesk.net/content/dam/autodesk/images/ru-adn/lesson_1.pdf (Дата обращения – 20.05.2022)</span></span>
    </p>
    <p class='s18 s8 s16 s11'>
        <span class='s4 s5 s12'><span>VBScript</span></span><span class='s4 s5 s12'><span> [Электронный ресурс] // Википедия https://ru.wikipedia.org/wiki/VBScript (Дата обращения – 21.05.2022)</span></span>
    </p>
    <p class='s18 s8 s16 s11'>
        <span class='s4 s5 s12'><span> Протокол HTTP — Документация по Веб-программированию 0.0.0 [Электронный ресурс] // Информационные системы и технологии </span></span><span
            class='s4 s5 s12'><span>УрФУ</span></span><span class='s4 s5 s12'><span> ИРИТ-РТФ https://iit-web-lectures.readthedocs.io/ru/latest/www/http.html (Дата обращения – 21.05.2022)</span></span>
    </p>
    <p class='s18 s8 s16 s11'>
        <span class='s4 s5 s12'><span> </span></span><span class='s4 s5 s12'><span>React</span></span><span
            class='s4 s5 s12'><span> в Windows [Электронный ресурс] // Microsoft </span></span><span
            class='s4 s5 s12'><span>Docs</span></span><span class='s4 s5 s12'><span> https://docs.microsoft.com/ru-ru/windows/dev-environment/javascript/react-overview (Дата обращения – 21.05.2022)</span></span>
    </p>
    <p class='s31 s8 s2 s11'><br></p>
    <p class='s13 s14 s2 s15'><span class='s4 s5'></span></p>
</div>
<div class='page'>
    <p class='s13 s14 s2 s15'><span class='s4 s5'></span></p>
    <p class='s8 s2 s6'>
        <span class='s4 s5 s7'><span>ПРИЛОЖЕНИЕ</span></span><span class='s4 s5 s7'><span> </span></span><span
            class='s4 s5 s7'><span>А</span></span>
    </p>
    <p class='s8 s9 s11'><span class='s4 s5'><span>ConnectorController.cs</span></span></p>
    <p class='s8 s9 s11'><br></p>
    <p class='s1 s2 s15'>
        <span class='s32 s33 s7 s12'><span>using</span></span><span class='s32 s33 s12'><span> </span></span><span
            class='s32 s33 s7 s12'><span>Exporter.LiveSync.Interfaces</span></span><span
            class='s32 s33 s12'><span>;</span></span>
    </p>
    <p class='s1 s2 s15'>
        <span class='s32 s33 s7 s12'><span>using</span></span><span class='s32 s33 s12'><span> </span></span><span
            class='s32 s33 s7 s12'><span>Exporter.LiveSync.Models</span></span><span class='s32 s33 s12'><span>;</span></span>
    </p>
    <p class='s1 s2 s15'>
        <span class='s32 s33 s7 s12'><span>using</span></span><span class='s32 s33 s12'><span> </span></span><span
            class='s32 s33 s7 s12'><span>Microsoft.AspNetCore.Mvc</span></span><span class='s32 s33 s12'><span>;</span></span>
    </p>
    <p class='s1 s2 s15'>
        <span class='s32 s33 s7 s12'><span>using</span></span><span class='s32 s33 s12'><span> </span></span><span
            class='s32 s33 s7 s12'><span>Microsoft.AspNetCore.SignalR</span></span><span
            class='s32 s33 s12'><span>;</span></span>
    </p>
    <p class='s1 s2 s15'><br></p>
    <p class='s1 s2 s15'>
        <span class='s32 s33 s7 s12'><span>namespace</span></span><span class='s32 s33 s12'><span> </span></span><span
            class='s32 s33 s7 s12'><span>Exporter.LiveSync.Controllers</span></span><span
            class='s32 s33 s12'><span>;</span></span>
    </p>
    <p class='s1 s2 s15'><br></p>
    <p class='s1 s2 s15'><span class='s32 s33 s12'><span>/// &lt;summary&gt;</span></span></p>
    <p class='s1 s2 s15'>
        <span class='s32 s33 s12'><span>//</span></span><span class='s32 s33 s12'><span>/  Контроллер</span></span><span
            class='s32 s33 s12'><span> для получения сведений о соединении и отправки данных.</span></span>
    </p>
    <p class='s1 s2 s15'><span class='s32 s33 s12'><span>/// &lt;/summary&gt;</span></span></p>
    <p class='s1 s2 s15'>
        <span class='s32 s33 s12'><span>[Route("</span></span><span class='s32 s33 s12'><span>api</span></span><span
            class='s32 s33 s12'><span>/[controller]</span></span><span class='s32 s33 s12'><span>")]</span></span>
    </p>
    <p class='s1 s2 s15'>
        <span class='s32 s33 s12'><span>[</span></span><span class='s32 s33 s12'><span>ApiController</span></span><span
            class='s32 s33 s12'><span>]</span></span>
    </p>
    <p class='s1 s2 s15'>
        <span class='s32 s33 s7 s12'><span>public</span></span><span class='s32 s33 s12'><span> </span></span><span
            class='s32 s33 s7 s12'><span>class</span></span><span class='s32 s33 s12'><span> </span></span><span
            class='s32 s33 s7 s12'><span>ConnectorController</span></span><span
            class='s32 s33 s12'><span> :</span></span><span class='s32 s33 s12'><span> </span></span><span
            class='s32 s33 s12'><span>ControllerBase</span></span>
    </p>
    <p class='s1 s2 s15'><span class='s32 s33 s12'><span>{</span></span></p>
    <p class='s1 s2 s15'>
        <span class='s32 s33 s12'><span>    </span></span><span class='s32 s33 s7 s12'><span>private</span></span><span
            class='s32 s33 s12'><span> </span></span><span class='s32 s33 s7 s12'><span>readonly</span></span><span
            class='s32 s33 s12'><span> </span></span><span
            class='s32 s33 s12'><span>IConnectionStorageService</span></span><span
            class='s32 s33 s12'><span> _</span></span><span
            class='s32 s33 s12'><span>connectionStorage</span></span><span class='s32 s33 s12'><span>;</span></span>
    </p>
    <p class='s1 s2 s15'>
        <span class='s32 s33 s12'><span>    </span></span><span class='s32 s33 s7 s12'><span>private</span></span><span
            class='s32 s33 s12'><span> </span></span><span class='s32 s33 s7 s12'><span>readonly</span></span><span
            class='s32 s33 s12'><span> </span></span><span class='s32 s33 s12'><span>IHubContext</span></span><span
            class='s32 s33 s12'><span>&lt;</span></span><span class='s32 s33 s12'><span>ConnectorHub</span></span><span
            class='s32 s33 s12'><span>&gt; _</span></span><span class='s32 s33 s12'><span>hubContext</span></span><span
            class='s32 s33 s12'><span>;</span></span>
    </p>
    <p class='s1 s2 s15'>
        <span class='s32 s33 s12'><span>    </span></span><span class='s32 s33 s7 s12'><span>private</span></span><span
            class='s32 s33 s12'><span> </span></span><span class='s32 s33 s7 s12'><span>readonly</span></span><span
            class='s32 s33 s12'><span> </span></span><span class='s32 s33 s12'><span>ILogger</span></span><span
            class='s32 s33 s12'><span>&lt;</span></span><span
            class='s32 s33 s12'><span>ConnectorController</span></span><span
            class='s32 s33 s12'><span>&gt; _</span></span><span class='s32 s33 s12'><span>logger;</span></span>
    </p>
    <p class='s1 s2 s15'><br></p>
    <p class='s1 s2 s15'>
        <span class='s32 s33 s12'><span>    </span></span><span class='s32 s33 s7 s12'><span>public</span></span><span
            class='s32 s33 s12'><span> </span></span><span
            class='s32 s33 s7 s12'><span>ConnectorController</span></span><span
            class='s32 s33 s12'><span>(</span></span><span class='s32 s33 s12'><span>ILogger</span></span><span
            class='s32 s33 s12'><span>&lt;</span></span><span
            class='s32 s33 s12'><span>ConnectorController</span></span><span
            class='s32 s33 s12'><span>&gt; logger,</span></span>
    </p>
    <p class='s1 s2 s15'>
        <span class='s32 s33 s12'><span>                               </span></span><span class='s32 s33 s12'><span>IConnectionStorageService</span></span><span
            class='s32 s33 s12'><span> </span></span><span
            class='s32 s33 s12'><span>connectionStorage</span></span><span class='s32 s33 s12'><span>,</span></span>
    </p>
    <p class='s1 s2 s15'>
        <span class='s32 s33 s12'><span>                               </span></span><span class='s32 s33 s12'><span>IHubContext</span></span><span
            class='s32 s33 s12'><span>&lt;</span></span><span class='s32 s33 s12'><span>ConnectorHub</span></span><span
            class='s32 s33 s12'><span>&gt; </span></span><span class='s32 s33 s12'><span>hubContext</span></span><span
            class='s32 s33 s12'><span>)</span></span>
    </p>
    <p class='s1 s2 s15'><span class='s32 s33 s12'><span>    {</span></span></p>
    <p class='s1 s2 s15'>
        <span class='s32 s33 s12'><span>        _logger = </span></span><span
            class='s32 s33 s12'><span>logger;</span></span>
    </p>
    <p class='s1 s2 s15'>
        <span class='s32 s33 s12'><span>        _</span></span><span class='s32 s33 s12'><span>connectionStorage</span></span><span
            class='s32 s33 s12'><span> = </span></span><span
            class='s32 s33 s12'><span>connectionStorage</span></span><span class='s32 s33 s12'><span>;</span></span>
    </p>
    <p class='s1 s2 s15'>
        <span class='s32 s33 s12'><span>        _</span></span><span
            class='s32 s33 s12'><span>hubContext</span></span><span class='s32 s33 s12'><span> = </span></span><span
            class='s32 s33 s12'><span>hubContext</span></span><span class='s32 s33 s12'><span>;</span></span>
    </p>
    <p class='s1 s2 s15'><span class='s32 s33 s12'><span>    }</span></span></p>
    <p class='s1 s2 s15'><br></p>
    <p class='s1 s2 s15'>
        <span class='s32 s33 s12'><span>    [</span></span><span class='s32 s33 s12'><span>HttpGet</span></span><span
            class='s32 s33 s12'><span>("</span></span><span class='s32 s33 s12'><span>GetConnections</span></span><span
            class='s32 s33 s12'><span>")]</span></span>
    </p>
    <p class='s1 s2 s15'>
        <span class='s32 s33 s12'><span>    [</span></span><span
            class='s32 s33 s12'><span>ProducesResponseType</span></span><span
            class='s32 s33 s12'><span>(</span></span><span
            class='s32 s33 s12'><span>StatusCodes.Status200OK)]</span></span>
    </p>
    <p class='s1 s2 s15'>
        <span class='s32 s33 s12'><span>    [</span></span><span
            class='s32 s33 s12'><span>ProducesResponseType</span></span><span
            class='s32 s33 s12'><span>(</span></span><span
            class='s32 s33 s12'><span>StatusCodes.Status400BadRequest)]</span></span>
    </p>
    <p class='s1 s2 s15'>
        <span class='s32 s33 s12'><span>    [</span></span><span
            class='s32 s33 s12'><span>ProducesResponseType</span></span><span
            class='s32 s33 s12'><span>(</span></span><span
            class='s32 s33 s12'><span>StatusCodes.Status404NotFound)]</span></span>
    </p>
    <p class='s1 s2 s15'>
        <span class='s32 s33 s12'><span>    </span></span><span class='s32 s33 s7 s12'><span>public</span></span><span
            class='s32 s33 s12'><span> </span></span><span class='s32 s33 s7 s12'><span>async</span></span><span
            class='s32 s33 s12'><span> Task&lt;</span></span><span class='s32 s33 s12'><span>IActionResult</span></span><span
            class='s32 s33 s12'><span>&gt; </span></span><span class='s32 s33 s12'><span>Get(</span></span><span
            class='s32 s33 s12'><span>)</span></span>
    </p>
    <p class='s1 s2 s15'><span class='s32 s33 s12'><span>    {</span></span></p>
    <p class='s1 s2 s15'>
        <span class='s32 s33 s12'><span>        </span></span><span class='s32 s33 s7 s12'><span>try</span></span>
    </p>
    <p class='s1 s2 s15'><span class='s32 s33 s12'><span>        {</span></span></p>
    <p class='s1 s2 s15'>
        <span class='s32 s33 s12'><span>            </span></span><span
            class='s32 s33 s7 s12'><span>var</span></span><span class='s32 s33 s12'><span> connections = _</span></span><span
            class='s32 s33 s12'><span>connectionStorage.GetConnections</span></span><span
            class='s32 s33 s12'><span>(</span></span><span class='s32 s33 s12'><span>);</span></span>
    </p>
    <p class='s1 s2 s15'>
        <span class='s32 s33 s12'><span>            _</span></span><span
            class='s32 s33 s12'><span>logger.LogInformation</span></span><span class='s32 s33 s12'><span>(</span></span><span
            class='s32 s33 s12'><span>"Connections successfully received"</span></span><span class='s32 s33 s12'><span>);</span></span>
    </p>
    <p class='s1 s2 s15'>
        <span class='s32 s33 s12'><span>            </span></span><span
            class='s32 s33 s7 s12'><span>return</span></span><span class='s32 s33 s12'><span> </span></span><span
            class='s32 s33 s7 s12'><span>Ok</span></span><span class='s32 s33 s12'><span>(connections</span></span><span
            class='s32 s33 s12'><span>);</span></span>
    </p>
    <p class='s1 s2 s15'><span class='s32 s33 s12'><span>        }</span></span></p>
    <p class='s1 s2 s15'>
        <span class='s32 s33 s12'><span>        </span></span><span
            class='s32 s33 s7 s12'><span>catch</span></span><span
            class='s32 s33 s12'><span> (Exception ex)</span></span>
    </p>
    <p class='s1 s2 s15'><span class='s32 s33 s12'><span>        {</span></span></p>
    <p class='s1 s2 s15'>
        <span class='s32 s33 s12'><span>            _</span></span><span
            class='s32 s33 s12'><span>logger.LogError</span></span><span
            class='s32 s33 s12'><span>(ex, </span></span><span class='s32 s33 s12'><span>ex.Message</span></span><span
            class='s32 s33 s12'><span>);</span></span>
    </p>
    <p class='s1 s2 s15'>
        <span class='s32 s33 s12'><span>            </span></span><span
            class='s32 s33 s7 s12'><span>return</span></span><span class='s32 s33 s12'><span> </span></span><span
            class='s32 s33 s7 s12'><span>BadRequest</span></span><span class='s32 s33 s12'><span>(</span></span><span
            class='s32 s33 s12'><span>ex.Message</span></span><span class='s32 s33 s12'><span>);</span></span>
    </p>
    <p class='s1 s2 s15'><span class='s32 s33 s12'><span>        }</span></span></p>
    <p class='s1 s2 s15'><span class='s32 s33 s12'><span>    }</span></span></p>
    <p class='s1 s2 s15'><br></p>
    <p class='s1 s2 s15'>
        <span class='s32 s33 s12'><span>    [</span></span><span class='s32 s33 s12'><span>HttpGet</span></span><span
            class='s32 s33 s12'><span>("{</span></span><span class='s32 s33 s12'><span>projectName</span></span><span
            class='s32 s33 s12'><span>}")]</span></span>
    </p>
    <p class='s1 s2 s15'>
        <span class='s32 s33 s12'><span>    [</span></span><span
            class='s32 s33 s12'><span>ProducesResponseType</span></span><span
            class='s32 s33 s12'><span>(</span></span><span
            class='s32 s33 s12'><span>StatusCodes.Status200OK)]</span></span>
    </p>
    <p class='s1 s2 s15'>
        <span class='s32 s33 s12'><span>    [</span></span><span
            class='s32 s33 s12'><span>ProducesResponseType</span></span><span
            class='s32 s33 s12'><span>(</span></span><span
            class='s32 s33 s12'><span>StatusCodes.Status400BadRequest)]</span></span>
    </p>
    <p class='s1 s2 s15'>
        <span class='s32 s33 s12'><span>    [</span></span><span
            class='s32 s33 s12'><span>ProducesResponseType</span></span><span
            class='s32 s33 s12'><span>(</span></span><span
            class='s32 s33 s12'><span>StatusCodes.Status404NotFound)]</span></span>
    </p>
    <p class='s1 s2 s15'>
        <span class='s32 s33 s12'><span>    </span></span><span class='s32 s33 s7 s12'><span>public</span></span><span
            class='s32 s33 s12'><span> </span></span><span class='s32 s33 s7 s12'><span>async</span></span><span
            class='s32 s33 s12'><span> Task&lt;</span></span><span class='s32 s33 s12'><span>IActionResult</span></span><span
            class='s32 s33 s12'><span>&gt; </span></span><span class='s32 s33 s12'><span>Get(</span></span><span
            class='s32 s33 s7 s12'><span>string</span></span><span class='s32 s33 s12'><span> </span></span><span
            class='s32 s33 s12'><span>projectName</span></span><span class='s32 s33 s12'><span>)</span></span>
    </p>
    <p class='s1 s2 s15'><span class='s32 s33 s12'></span></p>
</div>
<div class='page'>
    <p class='s1 s2 s15'><span class='s32 s33 s12'><span>    {</span></span></p>
    <p class='s1 s2 s15'>
        <span class='s32 s33 s12'><span>        </span></span><span class='s32 s33 s7 s12'><span>try</span></span>
    </p>
    <p class='s1 s2 s15'><span class='s32 s33 s12'><span>        {</span></span></p>
    <p class='s1 s2 s15'>
        <span class='s32 s33 s12'><span>            </span></span><span
            class='s32 s33 s7 s12'><span>if</span></span><span class='s32 s33 s12'><span> (</span></span><span
            class='s32 s33 s7 s12'><span>string</span></span><span
            class='s32 s33 s12'><span>.IsNullOrEmpty</span></span><span class='s32 s33 s12'><span>(</span></span><span
            class='s32 s33 s12'><span>projectName</span></span><span class='s32 s33 s12'><span>))</span></span>
    </p>
    <p class='s1 s2 s15'><span class='s32 s33 s12'><span>            {</span></span></p>
    <p class='s1 s2 s15'>
        <span class='s32 s33 s12'><span>                _</span></span><span
            class='s32 s33 s12'><span>logger.LogError</span></span><span class='s32 s33 s12'><span>(</span></span><span
            class='s32 s33 s12'><span>"Invalid project name"</span></span><span
            class='s32 s33 s12'><span>);</span></span>
    </p>
    <p class='s1 s2 s15'>
        <span class='s32 s33 s12'><span>                </span></span><span
            class='s32 s33 s7 s12'><span>return</span></span><span class='s32 s33 s12'><span> </span></span><span
            class='s32 s33 s7 s12'><span>BadRequest</span></span><span class='s32 s33 s12'><span>(</span></span><span
            class='s32 s33 s12'><span>"Invalid project name"</span></span><span
            class='s32 s33 s12'><span>);</span></span>
    </p>
    <p class='s1 s2 s15'><span class='s32 s33 s12'><span>            }</span></span></p>
    <p class='s1 s2 s15'><br></p>
    <p class='s1 s2 s15'>
        <span class='s32 s33 s12'><span>            </span></span><span
            class='s32 s33 s7 s12'><span>var</span></span><span
            class='s32 s33 s12'><span> connection = _</span></span><span class='s32 s33 s12'><span>connectionStorage.GetConnection</span></span><span
            class='s32 s33 s12'><span>(</span></span><span class='s32 s33 s12'><span>projectName</span></span><span
            class='s32 s33 s12'><span>);</span></span>
    </p>
    <p class='s1 s2 s15'>
        <span class='s32 s33 s12'><span>            _</span></span><span
            class='s32 s33 s12'><span>logger.LogInformation</span></span><span class='s32 s33 s12'><span>(</span></span><span
            class='s32 s33 s12'><span>"Connections successfully received"</span></span><span class='s32 s33 s12'><span>);</span></span>
    </p>
    <p class='s1 s2 s15'>
        <span class='s32 s33 s12'><span>            </span></span><span
            class='s32 s33 s7 s12'><span>return</span></span><span class='s32 s33 s12'><span> </span></span><span
            class='s32 s33 s7 s12'><span>Ok</span></span><span class='s32 s33 s12'><span>(connection</span></span><span
            class='s32 s33 s12'><span>);</span></span>
    </p>
    <p class='s1 s2 s15'><span class='s32 s33 s12'><span>        }</span></span></p>
    <p class='s1 s2 s15'>
        <span class='s32 s33 s12'><span>        </span></span><span
            class='s32 s33 s7 s12'><span>catch</span></span><span
            class='s32 s33 s12'><span> (Exception ex)</span></span>
    </p>
    <p class='s1 s2 s15'><span class='s32 s33 s12'><span>        {</span></span></p>
    <p class='s1 s2 s15'>
        <span class='s32 s33 s12'><span>            _</span></span><span
            class='s32 s33 s12'><span>logger.LogError</span></span><span
            class='s32 s33 s12'><span>(ex, </span></span><span class='s32 s33 s12'><span>ex.Message</span></span><span
            class='s32 s33 s12'><span>);</span></span>
    </p>
    <p class='s1 s2 s15'>
        <span class='s32 s33 s12'><span>            </span></span><span
            class='s32 s33 s7 s12'><span>return</span></span><span class='s32 s33 s12'><span> </span></span><span
            class='s32 s33 s7 s12'><span>BadRequest</span></span><span class='s32 s33 s12'><span>(</span></span><span
            class='s32 s33 s12'><span>ex.Message</span></span><span class='s32 s33 s12'><span>);</span></span>
    </p>
    <p class='s1 s2 s15'><span class='s32 s33 s12'><span>        }</span></span></p>
    <p class='s1 s2 s15'><span class='s32 s33 s12'><span>    }</span></span></p>
    <p class='s1 s2 s15'><br></p>
    <p class='s1 s2 s15'>
        <span class='s32 s33 s12'><span>    [</span></span><span class='s32 s33 s12'><span>HttpGet</span></span><span
            class='s32 s33 s12'><span>("connect")]</span></span>
    </p>
    <p class='s1 s2 s15'>
        <span class='s32 s33 s12'><span>    [</span></span><span
            class='s32 s33 s12'><span>ProducesResponseType</span></span><span
            class='s32 s33 s12'><span>(</span></span><span
            class='s32 s33 s12'><span>StatusCodes.Status200OK)]</span></span>
    </p>
    <p class='s1 s2 s15'>
        <span class='s32 s33 s12'><span>    [</span></span><span
            class='s32 s33 s12'><span>ProducesResponseType</span></span><span
            class='s32 s33 s12'><span>(</span></span><span
            class='s32 s33 s12'><span>StatusCodes.Status400BadRequest)]</span></span>
    </p>
    <p class='s1 s2 s15'>
        <span class='s32 s33 s12'><span>    [</span></span><span
            class='s32 s33 s12'><span>ProducesResponseType</span></span><span
            class='s32 s33 s12'><span>(</span></span><span
            class='s32 s33 s12'><span>StatusCodes.Status404NotFound)]</span></span>
    </p>
    <p class='s1 s2 s15'>
        <span class='s32 s33 s12'><span>    </span></span><span class='s32 s33 s7 s12'><span>public</span></span><span
            class='s32 s33 s12'><span> </span></span><span class='s32 s33 s7 s12'><span>async</span></span><span
            class='s32 s33 s12'><span> Task&lt;</span></span><span class='s32 s33 s12'><span>IActionResult</span></span><span
            class='s32 s33 s12'><span>&gt; </span></span><span class='s32 s33 s12'><span>Connect(</span></span><span
            class='s32 s33 s12'><span>Connection connection)</span></span>
    </p>
    <p class='s1 s2 s15'><span class='s32 s33 s12'><span>    {</span></span></p>
    <p class='s1 s2 s15'>
        <span class='s32 s33 s12'><span>        </span></span><span class='s32 s33 s7 s12'><span>try</span></span>
    </p>
    <p class='s1 s2 s15'><span class='s32 s33 s12'><span>        {</span></span></p>
    <p class='s1 s2 s15'>
        <span class='s32 s33 s12'><span>            </span></span><span
            class='s32 s33 s7 s12'><span>if</span></span><span class='s32 s33 s12'><span> </span></span><span
            class='s32 s33 s12'><span>(!_</span></span><span class='s32 s33 s12'><span>connectionStorage.IsConnectionExist</span></span><span
            class='s32 s33 s12'><span>(</span></span><span
            class='s32 s33 s12'><span>connection.ConnectionId</span></span><span
            class='s32 s33 s12'><span>))</span></span>
    </p>
    <p class='s1 s2 s15'><span class='s32 s33 s12'><span>            {</span></span></p>
    <p class='s1 s2 s15'>
        <span class='s32 s33 s12'><span>                _</span></span><span class='s32 s33 s12'><span>logger.LogInformation</span></span><span
            class='s32 s33 s12'><span>(</span></span><span class='s32 s33 s12'><span>"Project {</span></span><span
            class='s32 s33 s12'><span>ProjectName</span></span><span
            class='s32 s33 s12'><span>} not found"</span></span><span class='s32 s33 s12'><span>, </span></span><span
            class='s32 s33 s12'><span>connection.ProjectName</span></span><span
            class='s32 s33 s12'><span>);</span></span>
    </p>
    <p class='s1 s2 s15'>
        <span class='s32 s33 s12'><span>                </span></span><span
            class='s32 s33 s7 s12'><span>return</span></span><span class='s32 s33 s12'><span> </span></span><span
            class='s32 s33 s7 s12'><span>NotFound</span></span><span class='s32 s33 s12'><span>(connection</span></span><span
            class='s32 s33 s12'><span>);</span></span>
    </p>
    <p class='s1 s2 s15'><span class='s32 s33 s12'><span>            }</span></span></p>
    <p class='s1 s2 s15'><br></p>
    <p class='s1 s2 s15'>
        <span class='s32 s33 s12'><span>            _</span></span><span
            class='s32 s33 s12'><span>logger.LogInformation</span></span><span class='s32 s33 s12'><span>(</span></span><span
            class='s32 s33 s12'><span>"Project {</span></span><span
            class='s32 s33 s12'><span>ProjectName</span></span><span
            class='s32 s33 s12'><span>} exist"</span></span><span class='s32 s33 s12'><span>, </span></span><span
            class='s32 s33 s12'><span>connection.ProjectName</span></span><span
            class='s32 s33 s12'><span>);</span></span>
    </p>
    <p class='s1 s2 s15'>
        <span class='s32 s33 s12'><span>            </span></span><span class='s32 s33 s7 s12'><span>await</span></span><span
            class='s32 s33 s12'><span> _</span></span><span
            class='s32 s33 s12'><span>hubContext.Clients.Client</span></span><span class='s32 s33 s12'><span>(connection.ConnectionId).SendAsync(</span></span><span
            class='s32 s33 s12'><span>"Connect"</span></span><span class='s32 s33 s12'><span>);</span></span>
    </p>
    <p class='s1 s2 s15'><br></p>
    <p class='s1 s2 s15'>
        <span class='s32 s33 s12'><span>            </span></span><span
            class='s32 s33 s7 s12'><span>return</span></span><span class='s32 s33 s12'><span> </span></span><span
            class='s32 s33 s7 s12'><span>Ok</span></span><span class='s32 s33 s12'><span>(</span></span><span
            class='s32 s33 s12'><span>);</span></span>
    </p>
    <p class='s1 s2 s15'><span class='s32 s33 s12'><span>        }</span></span></p>
    <p class='s1 s2 s15'>
        <span class='s32 s33 s12'><span>        </span></span><span
            class='s32 s33 s7 s12'><span>catch</span></span><span
            class='s32 s33 s12'><span> (Exception ex)</span></span>
    </p>
    <p class='s1 s2 s15'><span class='s32 s33 s12'><span>        {</span></span></p>
    <p class='s1 s2 s15'>
        <span class='s32 s33 s12'><span>            _</span></span><span
            class='s32 s33 s12'><span>logger.LogError</span></span><span
            class='s32 s33 s12'><span>(ex, </span></span><span class='s32 s33 s12'><span>ex.Message</span></span><span
            class='s32 s33 s12'><span>);</span></span>
    </p>
    <p class='s1 s2 s15'>
        <span class='s32 s33 s12'><span>            </span></span><span
            class='s32 s33 s7 s12'><span>return</span></span><span class='s32 s33 s12'><span> </span></span><span
            class='s32 s33 s7 s12'><span>BadRequest</span></span><span class='s32 s33 s12'><span>(</span></span><span
            class='s32 s33 s12'><span>ex.Message</span></span><span class='s32 s33 s12'><span>);</span></span>
    </p>
    <p class='s1 s2 s15'><span class='s32 s33 s12'><span>        }</span></span></p>
    <p class='s1 s2 s15'><span class='s32 s33 s12'><span>    }</span></span></p>
    <p class='s1 s2 s15'><br></p>
    <p class='s1 s2 s15'>
        <span class='s32 s33 s12'><span>    [</span></span><span class='s32 s33 s12'><span>HttpPost</span></span><span
            class='s32 s33 s12'><span>]</span></span>
    </p>
    <p class='s1 s2 s15'>
        <span class='s32 s33 s12'><span>    [</span></span><span
            class='s32 s33 s12'><span>RequestSizeLimit</span></span><span class='s32 s33 s12'><span>(</span></span><span
            class='s32 s33 s12'><span>180L * 1024L * 1024L)]</span></span>
    </p>
    <p class='s1 s2 s15'>
        <span class='s32 s33 s12'><span>    [</span></span><span
            class='s32 s33 s12'><span>ProducesResponseType</span></span><span
            class='s32 s33 s12'><span>(</span></span><span
            class='s32 s33 s12'><span>StatusCodes.Status200OK)]</span></span>
    </p>
    <p class='s1 s2 s15'>
        <span class='s32 s33 s12'><span>    [</span></span><span
            class='s32 s33 s12'><span>ProducesResponseType</span></span><span
            class='s32 s33 s12'><span>(</span></span><span
            class='s32 s33 s12'><span>StatusCodes.Status400BadRequest)]</span></span>
    </p>
    <p class='s1 s2 s15'>
        <span class='s32 s33 s12'><span>    [</span></span><span
            class='s32 s33 s12'><span>ProducesResponseType</span></span><span
            class='s32 s33 s12'><span>(</span></span><span
            class='s32 s33 s12'><span>StatusCodes.Status404NotFound)]</span></span>
    </p>
    <p class='s1 s2 s15'>
        <span class='s32 s33 s12'><span>    </span></span><span class='s32 s33 s7 s12'><span>public</span></span><span
            class='s32 s33 s12'><span> </span></span><span class='s32 s33 s7 s12'><span>async</span></span><span
            class='s32 s33 s12'><span> Task&lt;</span></span><span class='s32 s33 s12'><span>IActionResult</span></span><span
            class='s32 s33 s12'><span>&gt; Post([</span></span><span
            class='s32 s33 s12'><span>FromForm</span></span><span class='s32 s33 s12'><span>] </span></span><span
            class='s32 s33 s7 s12'><span>string</span></span><span class='s32 s33 s12'><span> </span></span><span
            class='s32 s33 s12'><span>projectName</span></span><span class='s32 s33 s12'><span>, [</span></span><span
            class='s32 s33 s12'><span>FromForm</span></span><span class='s32 s33 s12'><span>] </span></span><span
            class='s32 s33 s12'><span>IFormFile</span></span><span class='s32 s33 s12'><span> file)</span></span>
    </p>
    <p class='s1 s2 s15'><span class='s32 s33 s12'></span></p>
</div>
<div class='page'>
    <p class='s1 s2 s15'><span class='s32 s33 s12'><span>    {</span></span></p>
    <p class='s1 s2 s15'>
        <span class='s32 s33 s12'><span>        </span></span><span class='s32 s33 s7 s12'><span>try</span></span>
    </p>
    <p class='s1 s2 s15'><span class='s32 s33 s12'><span>        {</span></span></p>
    <p class='s1 s2 s15'>
        <span class='s32 s33 s12'><span>            </span></span><span
            class='s32 s33 s7 s12'><span>if</span></span><span class='s32 s33 s12'><span> (</span></span><span
            class='s32 s33 s7 s12'><span>string</span></span><span
            class='s32 s33 s12'><span>.IsNullOrEmpty</span></span><span class='s32 s33 s12'><span>(</span></span><span
            class='s32 s33 s12'><span>projectName</span></span><span class='s32 s33 s12'><span>))</span></span>
    </p>
    <p class='s1 s2 s15'><span class='s32 s33 s12'><span>            {</span></span></p>
    <p class='s1 s2 s15'>
        <span class='s32 s33 s12'><span>                _</span></span><span
            class='s32 s33 s12'><span>logger.LogError</span></span><span class='s32 s33 s12'><span>(</span></span><span
            class='s32 s33 s12'><span>"Invalid project name"</span></span><span
            class='s32 s33 s12'><span>);</span></span>
    </p>
    <p class='s1 s2 s15'>
        <span class='s32 s33 s12'><span>                </span></span><span
            class='s32 s33 s7 s12'><span>return</span></span><span class='s32 s33 s12'><span> </span></span><span
            class='s32 s33 s7 s12'><span>BadRequest</span></span><span class='s32 s33 s12'><span>(</span></span><span
            class='s32 s33 s12'><span>"Invalid project name"</span></span><span
            class='s32 s33 s12'><span>);</span></span>
    </p>
    <p class='s1 s2 s15'><span class='s32 s33 s12'><span>            }</span></span></p>
    <p class='s1 s2 s15'><br></p>
    <p class='s1 s2 s15'>
        <span class='s32 s33 s12'><span>            </span></span><span
            class='s32 s33 s7 s12'><span>var</span></span><span
            class='s32 s33 s12'><span> connection = _</span></span><span class='s32 s33 s12'><span>connectionStorage.GetConnection</span></span><span
            class='s32 s33 s12'><span>(</span></span><span class='s32 s33 s12'><span>projectName</span></span><span
            class='s32 s33 s12'><span>);</span></span>
    </p>
    <p class='s1 s2 s15'>
        <span class='s32 s33 s12'><span>            </span></span><span
            class='s32 s33 s7 s12'><span>if</span></span><span
            class='s32 s33 s12'><span> (connection </span></span><span
            class='s32 s33 s7 s12'><span>is</span></span><span class='s32 s33 s12'><span> </span></span><span
            class='s32 s33 s7 s12'><span>null</span></span><span class='s32 s33 s12'><span>)</span></span>
    </p>
    <p class='s1 s2 s15'><span class='s32 s33 s12'><span>            {</span></span></p>
    <p class='s1 s2 s15'>
        <span class='s32 s33 s12'><span>                _</span></span><span
            class='s32 s33 s12'><span>logger.LogError</span></span><span class='s32 s33 s12'><span>(</span></span><span
            class='s32 s33 s12'><span>"Connection was null"</span></span><span
            class='s32 s33 s12'><span>);</span></span>
    </p>
    <p class='s1 s2 s15'>
        <span class='s32 s33 s12'><span>                </span></span><span
            class='s32 s33 s7 s12'><span>return</span></span><span class='s32 s33 s12'><span> </span></span><span
            class='s32 s33 s7 s12'><span>BadRequest</span></span><span class='s32 s33 s12'><span>(</span></span><span
            class='s32 s33 s12'><span>"Connection was null"</span></span><span
            class='s32 s33 s12'><span>);</span></span>
    </p>
    <p class='s1 s2 s15'><span class='s32 s33 s12'><span>            }</span></span></p>
    <p class='s1 s2 s15'><br></p>
    <p class='s1 s2 s15'>
        <span class='s32 s33 s12'><span>            </span></span><span
            class='s32 s33 s7 s12'><span>if</span></span><span class='s32 s33 s12'><span> (</span></span><span
            class='s32 s33 s12'><span>file.Length</span></span><span class='s32 s33 s12'><span> == </span></span><span
            class='s32 s33 s7 s12'><span>0</span></span><span class='s32 s33 s12'><span>)</span></span>
    </p>
    <p class='s1 s2 s15'><span class='s32 s33 s12'><span>            {</span></span></p>
    <p class='s1 s2 s15'>
        <span class='s32 s33 s12'><span>                _</span></span><span
            class='s32 s33 s12'><span>logger.LogWarning</span></span><span
            class='s32 s33 s12'><span>(</span></span><span
            class='s32 s33 s12'><span>"File length was null"</span></span><span
            class='s32 s33 s12'><span>);</span></span>
    </p>
    <p class='s1 s2 s15'>
        <span class='s32 s33 s12'><span>                </span></span><span
            class='s32 s33 s7 s12'><span>return</span></span><span class='s32 s33 s12'><span> </span></span><span
            class='s32 s33 s7 s12'><span>BadRequest</span></span><span class='s32 s33 s12'><span>(</span></span><span
            class='s32 s33 s12'><span>"Incorrect file size"</span></span><span
            class='s32 s33 s12'><span>);</span></span>
    </p>
    <p class='s1 s2 s15'><span class='s32 s33 s12'><span>            }</span></span></p>
    <p class='s1 s2 s15'><br></p>
    <p class='s1 s2 s15'>
        <span class='s32 s33 s12'><span>            </span></span><span
            class='s32 s33 s7 s12'><span>var</span></span><span class='s32 s33 s12'><span> data = </span></span><span
            class='s32 s33 s7 s12'><span>new</span></span><span class='s32 s33 s12'><span> </span></span><span
            class='s32 s33 s12'><span>MemoryStream</span></span><span class='s32 s33 s12'><span>(</span></span><span
            class='s32 s33 s12'><span>);</span></span>
    </p>
    <p class='s1 s2 s15'>
        <span class='s32 s33 s12'><span>            _</span></span><span
            class='s32 s33 s12'><span>logger.LogInformation</span></span><span class='s32 s33 s12'><span>(</span></span><span
            class='s32 s33 s12'><span>"Start copying data"</span></span><span class='s32 s33 s12'><span>);</span></span>
    </p>
    <p class='s1 s2 s15'>
        <span class='s32 s33 s12'><span>            </span></span><span class='s32 s33 s7 s12'><span>await</span></span><span
            class='s32 s33 s12'><span> </span></span><span class='s32 s33 s12'><span>file.CopyToAsync</span></span><span
            class='s32 s33 s12'><span>(data);</span></span>
    </p>
    <p class='s1 s2 s15'><br></p>
    <p class='s1 s2 s15'>
        <span class='s32 s33 s12'><span>            _</span></span><span
            class='s32 s33 s12'><span>logger.LogInformation</span></span><span class='s32 s33 s12'><span>(</span></span><span
            class='s32 s33 s12'><span>"Copied successfully, start transfer"</span></span><span
            class='s32 s33 s12'><span>);</span></span>
    </p>
    <p class='s1 s2 s15'>
        <span class='s32 s33 s12'><span>            </span></span><span class='s32 s33 s7 s12'><span>await</span></span><span
            class='s32 s33 s12'><span> _</span></span><span
            class='s32 s33 s12'><span>hubContext.Clients.Client</span></span><span class='s32 s33 s12'><span>(connection.ConnectionId).SendAsync(</span></span><span
            class='s32 s33 s12'><span>"Data"</span></span><span class='s32 s33 s12'><span>, </span></span><span
            class='s32 s33 s12'><span>data.ToArray</span></span><span class='s32 s33 s12'><span>());</span></span>
    </p>
    <p class='s1 s2 s15'>
        <span class='s32 s33 s12'><span>            _</span></span><span
            class='s32 s33 s12'><span>logger.LogInformation</span></span><span class='s32 s33 s12'><span>(</span></span><span
            class='s32 s33 s12'><span>"File transferred successfully"</span></span><span
            class='s32 s33 s12'><span>);</span></span>
    </p>
    <p class='s1 s2 s15'><br></p>
    <p class='s1 s2 s15'>
        <span class='s32 s33 s12'><span>            </span></span><span
            class='s32 s33 s7 s12'><span>return</span></span><span class='s32 s33 s12'><span> </span></span><span
            class='s32 s33 s7 s12'><span>Ok</span></span><span class='s32 s33 s12'><span>(</span></span><span
            class='s32 s33 s12'><span>);</span></span>
    </p>
    <p class='s1 s2 s15'><span class='s32 s33 s12'><span>        }</span></span></p>
    <p class='s1 s2 s15'>
        <span class='s32 s33 s12'><span>        </span></span><span
            class='s32 s33 s7 s12'><span>catch</span></span><span
            class='s32 s33 s12'><span> (Exception ex)</span></span>
    </p>
    <p class='s1 s2 s15'><span class='s32 s33 s12'><span>        {</span></span></p>
    <p class='s1 s2 s15'>
        <span class='s32 s33 s12'><span>            _</span></span><span
            class='s32 s33 s12'><span>logger.LogError</span></span><span
            class='s32 s33 s12'><span>(ex, </span></span><span class='s32 s33 s12'><span>ex.Message</span></span><span
            class='s32 s33 s12'><span>);</span></span>
    </p>
    <p class='s1 s2 s15'>
        <span class='s32 s33 s12'><span>            </span></span><span
            class='s32 s33 s7 s12'><span>return</span></span><span class='s32 s33 s12'><span> </span></span><span
            class='s32 s33 s7 s12'><span>BadRequest</span></span><span class='s32 s33 s12'><span>(</span></span><span
            class='s32 s33 s12'><span>ex.Message</span></span><span class='s32 s33 s12'><span>);</span></span>
    </p>
    <p class='s1 s2 s15'><span class='s32 s33 s12'><span>        }</span></span></p>
    <p class='s1 s2 s15'><span class='s32 s33 s12'><span>    }</span></span></p>
    <p class='s1 s2 s15'><span class='s32 s33 s12'><span>}</span></span></p>
    <p class='s8 s9 s11'><br></p>
    <p class='s8 s9 s11'><br></p>
    <p class='s8 s9 s11'><span class='s4 s5'><span>ConnectorStorageService.cs</span></span></p>
    <p class='s8 s9 s11'><br></p>
    <p class='s1 s2 s15'>
        <span class='s32 s33 s7 s12'><span>using</span></span><span class='s32 s33 s12'><span> </span></span><span
            class='s32 s33 s7 s12'><span>Exporter.LiveSync.Interfaces</span></span><span
            class='s32 s33 s12'><span>;</span></span>
    </p>
    <p class='s1 s2 s15'>
        <span class='s32 s33 s7 s12'><span>using</span></span><span class='s32 s33 s12'><span> </span></span><span
            class='s32 s33 s7 s12'><span>Exporter.LiveSync.Models</span></span><span class='s32 s33 s12'><span>;</span></span>
    </p>
    <p class='s1 s2 s15'><br></p>
    <p class='s1 s2 s15'>
        <span class='s32 s33 s7 s12'><span>namespace</span></span><span class='s32 s33 s12'><span> </span></span><span
            class='s32 s33 s7 s12'><span>Exporter.LiveSync.Services</span></span><span
            class='s32 s33 s12'><span>;</span></span>
    </p>
    <p class='s1 s2 s15'><br></p>
    <p class='s1 s2 s15'>
        <span class='s32 s33 s7 s12'><span>public</span></span><span class='s32 s33 s12'><span> </span></span><span
            class='s32 s33 s7 s12'><span>class</span></span><span class='s32 s33 s12'><span> </span></span><span
            class='s32 s33 s7 s12'><span>ConnectionStorageService</span></span><span class='s32 s33 s12'><span> :</span></span><span
            class='s32 s33 s12'><span> </span></span><span
            class='s32 s33 s12'><span>IConnectionStorageService</span></span>
    </p>
    <p class='s1 s2 s15'><span class='s32 s33 s12'><span>{</span></span></p>
    <p class='s1 s2 s15'>
        <span class='s32 s33 s12'><span>    </span></span><span class='s32 s33 s7 s12'><span>private</span></span><span
            class='s32 s33 s12'><span> </span></span><span class='s32 s33 s7 s12'><span>readonly</span></span><span
            class='s32 s33 s12'><span> Dictionary&lt;</span></span><span
            class='s32 s33 s7 s12'><span>string</span></span><span
            class='s32 s33 s12'><span>, Connection&gt; _</span></span><span
            class='s32 s33 s12'><span>connections;</span></span>
    </p>
    <p class='s1 s2 s15'><span class='s32 s33 s12'></span></p>
</div>
<div class='page'>
    <p class='s1 s2 s15'>
        <span class='s32 s33 s12'><span>    </span></span><span class='s32 s33 s7 s12'><span>private</span></span><span
            class='s32 s33 s12'><span> </span></span><span class='s32 s33 s7 s12'><span>readonly</span></span><span
            class='s32 s33 s12'><span> </span></span><span class='s32 s33 s12'><span>ILogger</span></span><span
            class='s32 s33 s12'><span>&lt;</span></span><span class='s32 s33 s12'><span>ConnectionStorageService</span></span><span
            class='s32 s33 s12'><span>&gt; _</span></span><span class='s32 s33 s12'><span>logger;</span></span>
    </p>
    <p class='s1 s2 s15'><br></p>
    <p class='s1 s2 s15'>
        <span class='s32 s33 s12'><span>    </span></span><span class='s32 s33 s7 s12'><span>public</span></span><span
            class='s32 s33 s12'><span> </span></span><span class='s32 s33 s7 s12'><span>ConnectionStorageService</span></span><span
            class='s32 s33 s12'><span>(</span></span><span class='s32 s33 s12'><span>ILogger</span></span><span
            class='s32 s33 s12'><span>&lt;</span></span><span class='s32 s33 s12'><span>ConnectionStorageService</span></span><span
            class='s32 s33 s12'><span>&gt; logger)</span></span>
    </p>
    <p class='s1 s2 s15'><span class='s32 s33 s12'><span>    {</span></span></p>
    <p class='s1 s2 s15'>
        <span class='s32 s33 s12'><span>        _connections = </span></span><span
            class='s32 s33 s7 s12'><span>new</span></span><span
            class='s32 s33 s12'><span> Dictionary&lt;</span></span><span
            class='s32 s33 s7 s12'><span>string</span></span><span
            class='s32 s33 s12'><span>, Connection</span></span><span class='s32 s33 s12'><span>&gt;(</span></span><span
            class='s32 s33 s12'><span>);</span></span>
    </p>
    <p class='s1 s2 s15'>
        <span class='s32 s33 s12'><span>        _logger = </span></span><span
            class='s32 s33 s12'><span>logger;</span></span>
    </p>
    <p class='s1 s2 s15'><span class='s32 s33 s12'><span>    }</span></span></p>
    <p class='s1 s2 s15'><br></p>
    <p class='s1 s2 s15'>
        <span class='s32 s33 s12'><span>    </span></span><span class='s32 s33 s7 s12'><span>public</span></span><span
            class='s32 s33 s12'><span> </span></span><span class='s32 s33 s7 s12'><span>void</span></span><span
            class='s32 s33 s12'><span> </span></span><span
            class='s32 s33 s7 s12'><span>DeleteConnection</span></span><span
            class='s32 s33 s12'><span>(</span></span><span class='s32 s33 s7 s12'><span>string</span></span><span
            class='s32 s33 s12'><span> </span></span><span class='s32 s33 s12'><span>connectionId</span></span><span
            class='s32 s33 s12'><span>)</span></span>
    </p>
    <p class='s1 s2 s15'><span class='s32 s33 s12'><span>    {</span></span></p>
    <p class='s1 s2 s15'>
        <span class='s32 s33 s12'><span>        </span></span><span class='s32 s33 s7 s12'><span>try</span></span>
    </p>
    <p class='s1 s2 s15'><span class='s32 s33 s12'><span>        {</span></span></p>
    <p class='s1 s2 s15'>
        <span class='s32 s33 s12'><span>            </span></span><span
            class='s32 s33 s7 s12'><span>if</span></span><span class='s32 s33 s12'><span> (_</span></span><span
            class='s32 s33 s12'><span>connections.Remove</span></span><span
            class='s32 s33 s12'><span>(</span></span><span class='s32 s33 s12'><span>connectionId</span></span><span
            class='s32 s33 s12'><span>))</span></span>
    </p>
    <p class='s1 s2 s15'><span class='s32 s33 s12'><span>            {</span></span></p>
    <p class='s1 s2 s15'>
        <span class='s32 s33 s12'><span>                _</span></span><span class='s32 s33 s12'><span>logger.LogInformation</span></span><span
            class='s32 s33 s12'><span>(</span></span><span class='s32 s33 s12'><span>"Connection {</span></span><span
            class='s32 s33 s12'><span>ConnectionId</span></span><span
            class='s32 s33 s12'><span>} deleted successfully"</span></span><span
            class='s32 s33 s12'><span>, </span></span><span class='s32 s33 s12'><span>connectionId</span></span><span
            class='s32 s33 s12'><span>);</span></span>
    </p>
    <p class='s1 s2 s15'>
        <span class='s32 s33 s12'><span>                </span></span><span
            class='s32 s33 s7 s12'><span>return</span></span><span class='s32 s33 s12'><span>;</span></span>
    </p>
    <p class='s1 s2 s15'><span class='s32 s33 s12'><span>            }</span></span></p>
    <p class='s1 s2 s15'><br></p>
    <p class='s1 s2 s15'>
        <span class='s32 s33 s12'><span>            _</span></span><span
            class='s32 s33 s12'><span>logger.LogInformation</span></span><span class='s32 s33 s12'><span>(</span></span><span
            class='s32 s33 s12'><span>"Connection {</span></span><span
            class='s32 s33 s12'><span>ConnectionId</span></span><span
            class='s32 s33 s12'><span>} not found"</span></span><span class='s32 s33 s12'><span>, </span></span><span
            class='s32 s33 s12'><span>connectionId</span></span><span class='s32 s33 s12'><span>);</span></span>
    </p>
    <p class='s1 s2 s15'><span class='s32 s33 s12'><span>        }</span></span></p>
    <p class='s1 s2 s15'>
        <span class='s32 s33 s12'><span>        </span></span><span
            class='s32 s33 s7 s12'><span>catch</span></span><span
            class='s32 s33 s12'><span> (Exception ex)</span></span>
    </p>
    <p class='s1 s2 s15'><span class='s32 s33 s12'><span>        {</span></span></p>
    <p class='s1 s2 s15'>
        <span class='s32 s33 s12'><span>            _</span></span><span
            class='s32 s33 s12'><span>logger.LogError</span></span><span
            class='s32 s33 s12'><span>(ex, </span></span><span class='s32 s33 s12'><span>ex.Message</span></span><span
            class='s32 s33 s12'><span>);</span></span>
    </p>
    <p class='s1 s2 s15'>
        <span class='s32 s33 s12'><span>            </span></span><span class='s32 s33 s7 s12'><span>throw</span></span><span
            class='s32 s33 s12'><span>;</span></span>
    </p>
    <p class='s1 s2 s15'><span class='s32 s33 s12'><span>        }</span></span></p>
    <p class='s1 s2 s15'><span class='s32 s33 s12'><span>    }</span></span></p>
    <p class='s1 s2 s15'><br></p>
    <p class='s1 s2 s15'>
        <span class='s32 s33 s12'><span>    </span></span><span class='s32 s33 s7 s12'><span>public</span></span><span
            class='s32 s33 s12'><span> </span></span><span class='s32 s33 s12'><span>IEnumerable</span></span><span
            class='s32 s33 s12'><span>&lt;Connection&gt; </span></span><span
            class='s32 s33 s12'><span>GetConnections</span></span><span class='s32 s33 s12'><span>(</span></span><span
            class='s32 s33 s12'><span>)</span></span>
    </p>
    <p class='s1 s2 s15'><span class='s32 s33 s12'><span>    {</span></span></p>
    <p class='s1 s2 s15'>
        <span class='s32 s33 s12'><span>        </span></span><span class='s32 s33 s7 s12'><span>try</span></span>
    </p>
    <p class='s1 s2 s15'><span class='s32 s33 s12'><span>        {</span></span></p>
    <p class='s1 s2 s15'>
        <span class='s32 s33 s12'><span>            </span></span><span
            class='s32 s33 s7 s12'><span>return</span></span><span class='s32 s33 s12'><span> _</span></span><span
            class='s32 s33 s12'><span>connections.Values</span></span><span class='s32 s33 s12'><span>;</span></span>
    </p>
    <p class='s1 s2 s15'><span class='s32 s33 s12'><span>        }</span></span></p>
    <p class='s1 s2 s15'>
        <span class='s32 s33 s12'><span>        </span></span><span
            class='s32 s33 s7 s12'><span>catch</span></span><span
            class='s32 s33 s12'><span> (Exception ex)</span></span>
    </p>
    <p class='s1 s2 s15'><span class='s32 s33 s12'><span>        {</span></span></p>
    <p class='s1 s2 s15'>
        <span class='s32 s33 s12'><span>            _</span></span><span
            class='s32 s33 s12'><span>logger.LogError</span></span><span
            class='s32 s33 s12'><span>(ex, </span></span><span class='s32 s33 s12'><span>ex.Message</span></span><span
            class='s32 s33 s12'><span>);</span></span>
    </p>
    <p class='s1 s2 s15'>
        <span class='s32 s33 s12'><span>            </span></span><span class='s32 s33 s7 s12'><span>throw</span></span><span
            class='s32 s33 s12'><span>;</span></span>
    </p>
    <p class='s1 s2 s15'><span class='s32 s33 s12'><span>        }</span></span></p>
    <p class='s1 s2 s15'><span class='s32 s33 s12'><span>    }</span></span></p>
    <p class='s1 s2 s15'><br></p>
    <p class='s1 s2 s15'>
        <span class='s32 s33 s12'><span>    </span></span><span class='s32 s33 s7 s12'><span>public</span></span><span
            class='s32 s33 s12'><span> Connection? </span></span><span
            class='s32 s33 s12'><span>GetConnection</span></span><span class='s32 s33 s12'><span>(</span></span><span
            class='s32 s33 s7 s12'><span>string</span></span><span class='s32 s33 s12'><span> </span></span><span
            class='s32 s33 s12'><span>projectName</span></span><span class='s32 s33 s12'><span>)</span></span>
    </p>
    <p class='s1 s2 s15'><span class='s32 s33 s12'><span>    {</span></span></p>
    <p class='s1 s2 s15'>
        <span class='s32 s33 s12'><span>        </span></span><span class='s32 s33 s7 s12'><span>try</span></span>
    </p>
    <p class='s1 s2 s15'><span class='s32 s33 s12'><span>        {</span></span></p>
    <p class='s1 s2 s15'>
        <span class='s32 s33 s12'><span>            </span></span><span
            class='s32 s33 s7 s12'><span>var</span></span><span
            class='s32 s33 s12'><span> connection = _</span></span><span class='s32 s33 s12'><span>connections.Values.FirstOrDefault</span></span><span
            class='s32 s33 s12'><span>(x =&gt; </span></span><span class='s32 s33 s12'><span>x.ProjectName</span></span><span
            class='s32 s33 s12'><span> == </span></span><span class='s32 s33 s12'><span>projectName</span></span><span
            class='s32 s33 s12'><span>);</span></span>
    </p>
    <p class='s1 s2 s15'>
        <span class='s32 s33 s12'><span>            </span></span><span
            class='s32 s33 s7 s12'><span>if</span></span><span
            class='s32 s33 s12'><span> (connection </span></span><span
            class='s32 s33 s7 s12'><span>is</span></span><span class='s32 s33 s12'><span> not </span></span><span
            class='s32 s33 s7 s12'><span>null</span></span><span class='s32 s33 s12'><span>)</span></span>
    </p>
    <p class='s1 s2 s15'><span class='s32 s33 s12'><span>            {</span></span></p>
    <p class='s1 s2 s15'>
        <span class='s32 s33 s12'><span>                _</span></span><span class='s32 s33 s12'><span>logger.LogInformation</span></span><span
            class='s32 s33 s12'><span>(</span></span><span
            class='s32 s33 s12'><span>"Connection with project name {</span></span><span class='s32 s33 s12'><span>ProjectName</span></span><span
            class='s32 s33 s12'><span>} is successfully received."</span></span><span
            class='s32 s33 s12'><span>, </span></span><span class='s32 s33 s12'><span>projectName</span></span><span
            class='s32 s33 s12'><span>);</span></span>
    </p>
    <p class='s1 s2 s15'><span class='s32 s33 s12'><span>            }</span></span></p>
    <p class='s1 s2 s15'>
        <span class='s32 s33 s12'><span>            </span></span><span
            class='s32 s33 s7 s12'><span>return</span></span><span class='s32 s33 s12'><span> </span></span><span
            class='s32 s33 s12'><span>connection;</span></span>
    </p>
    <p class='s1 s2 s15'><span class='s32 s33 s12'><span>        }</span></span></p>
    <p class='s1 s2 s15'>
        <span class='s32 s33 s12'><span>        </span></span><span
            class='s32 s33 s7 s12'><span>catch</span></span><span
            class='s32 s33 s12'><span> (Exception ex)</span></span>
    </p>
    <p class='s1 s2 s15'><span class='s32 s33 s12'><span>        {</span></span></p>
    <p class='s1 s2 s15'><span class='s32 s33 s12'></span></p>
</div>
<div class='page'>
    <p class='s1 s2 s15'>
        <span class='s32 s33 s12'><span>            _</span></span><span
            class='s32 s33 s12'><span>logger.LogError</span></span><span
            class='s32 s33 s12'><span>(ex, </span></span><span class='s32 s33 s12'><span>ex.Message</span></span><span
            class='s32 s33 s12'><span>);</span></span>
    </p>
    <p class='s1 s2 s15'>
        <span class='s32 s33 s12'><span>            </span></span><span class='s32 s33 s7 s12'><span>throw</span></span><span
            class='s32 s33 s12'><span>;</span></span>
    </p>
    <p class='s1 s2 s15'><span class='s32 s33 s12'><span>        }</span></span></p>
    <p class='s1 s2 s15'><span class='s32 s33 s12'><span>    }</span></span></p>
    <p class='s1 s2 s15'><br></p>
    <p class='s1 s2 s15'>
        <span class='s32 s33 s12'><span>    </span></span><span class='s32 s33 s7 s12'><span>public</span></span><span
            class='s32 s33 s12'><span> </span></span><span class='s32 s33 s7 s12'><span>bool</span></span><span
            class='s32 s33 s12'><span> </span></span><span
            class='s32 s33 s7 s12'><span>IsConnectionExist</span></span><span
            class='s32 s33 s12'><span>(</span></span><span class='s32 s33 s7 s12'><span>string</span></span><span
            class='s32 s33 s12'><span> </span></span><span class='s32 s33 s12'><span>connectionId</span></span><span
            class='s32 s33 s12'><span>)</span></span>
    </p>
    <p class='s1 s2 s15'><span class='s32 s33 s12'><span>    {</span></span></p>
    <p class='s1 s2 s15'>
        <span class='s32 s33 s12'><span>        </span></span><span
            class='s32 s33 s7 s12'><span>return</span></span><span class='s32 s33 s12'><span> _</span></span><span
            class='s32 s33 s12'><span>connections.ContainsKey</span></span><span
            class='s32 s33 s12'><span>(</span></span><span class='s32 s33 s12'><span>connectionId</span></span><span
            class='s32 s33 s12'><span>);</span></span>
    </p>
    <p class='s1 s2 s15'><span class='s32 s33 s12'><span>    }</span></span></p>
    <p class='s1 s2 s15'><br></p>
    <p class='s1 s2 s15'>
        <span class='s32 s33 s12'><span>    </span></span><span class='s32 s33 s7 s12'><span>public</span></span><span
            class='s32 s33 s12'><span> </span></span><span class='s32 s33 s7 s12'><span>void</span></span><span
            class='s32 s33 s12'><span> </span></span><span class='s32 s33 s7 s12'><span>AddConnection</span></span><span
            class='s32 s33 s12'><span>(</span></span><span
            class='s32 s33 s12'><span>Connection connection)</span></span>
    </p>
    <p class='s1 s2 s15'><span class='s32 s33 s12'><span>    {</span></span></p>
    <p class='s1 s2 s15'>
        <span class='s32 s33 s12'><span>        </span></span><span class='s32 s33 s7 s12'><span>try</span></span>
    </p>
    <p class='s1 s2 s15'><span class='s32 s33 s12'><span>        {</span></span></p>
    <p class='s1 s2 s15'>
        <span class='s32 s33 s12'><span>            </span></span><span
            class='s32 s33 s7 s12'><span>var</span></span><span class='s32 s33 s12'><span> </span></span><span
            class='s32 s33 s12'><span>connectionId</span></span><span class='s32 s33 s12'><span> = </span></span><span
            class='s32 s33 s12'><span>connection.ConnectionId</span></span><span
            class='s32 s33 s12'><span>;</span></span>
    </p>
    <p class='s1 s2 s15'>
        <span class='s32 s33 s12'><span>            </span></span><span
            class='s32 s33 s7 s12'><span>if</span></span><span class='s32 s33 s12'><span> </span></span><span
            class='s32 s33 s12'><span>(!_</span></span><span
            class='s32 s33 s12'><span>connections.ContainsKey</span></span><span
            class='s32 s33 s12'><span>(</span></span><span class='s32 s33 s12'><span>connectionId</span></span><span
            class='s32 s33 s12'><span>))</span></span>
    </p>
    <p class='s1 s2 s15'><span class='s32 s33 s12'><span>            {</span></span></p>
    <p class='s1 s2 s15'>
        <span class='s32 s33 s12'><span>                _connections[</span></span><span class='s32 s33 s12'><span>connectionId</span></span><span
            class='s32 s33 s12'><span>] = </span></span><span class='s32 s33 s12'><span>connection;</span></span>
    </p>
    <p class='s1 s2 s15'>
        <span class='s32 s33 s12'><span>                _</span></span><span class='s32 s33 s12'><span>logger.LogInformation</span></span><span
            class='s32 s33 s12'><span>(</span></span><span
            class='s32 s33 s12'><span>"Connection with project name {</span></span><span class='s32 s33 s12'><span>ProjectName</span></span><span
            class='s32 s33 s12'><span>} successfully added"</span></span><span class='s32 s33 s12'><span>,</span></span>
    </p>
    <p class='s1 s2 s15'>
        <span class='s32 s33 s12'><span>                                       </span></span><span
            class='s32 s33 s12'><span>connection.ProjectName</span></span><span
            class='s32 s33 s12'><span>);</span></span>
    </p>
    <p class='s1 s2 s15'>
        <span class='s32 s33 s12'><span>                </span></span><span
            class='s32 s33 s7 s12'><span>return</span></span><span class='s32 s33 s12'><span>;</span></span>
    </p>
    <p class='s1 s2 s15'><span class='s32 s33 s12'><span>            }</span></span></p>
    <p class='s1 s2 s15'>
        <span class='s32 s33 s12'><span>            _</span></span><span
            class='s32 s33 s12'><span>logger.LogInformation</span></span><span class='s32 s33 s12'><span>(</span></span><span
            class='s32 s33 s12'><span>"Connection with project name {</span></span><span class='s32 s33 s12'><span>ProjectName</span></span><span
            class='s32 s33 s12'><span>} already exists"</span></span><span class='s32 s33 s12'><span>,</span></span>
    </p>
    <p class='s1 s2 s15'>
        <span class='s32 s33 s12'><span>                                   </span></span><span
            class='s32 s33 s12'><span>connection.ProjectName</span></span><span
            class='s32 s33 s12'><span>);</span></span>
    </p>
    <p class='s1 s2 s15'><span class='s32 s33 s12'><span>        }</span></span></p>
    <p class='s1 s2 s15'>
        <span class='s32 s33 s12'><span>        </span></span><span
            class='s32 s33 s7 s12'><span>catch</span></span><span
            class='s32 s33 s12'><span> (Exception ex)</span></span>
    </p>
    <p class='s1 s2 s15'><span class='s32 s33 s12'><span>        {</span></span></p>
    <p class='s1 s2 s15'>
        <span class='s32 s33 s12'><span>            _</span></span><span
            class='s32 s33 s12'><span>logger.LogError</span></span><span
            class='s32 s33 s12'><span>(ex, </span></span><span class='s32 s33 s12'><span>ex.Message</span></span><span
            class='s32 s33 s12'><span>);</span></span>
    </p>
    <p class='s1 s2 s15'>
        <span class='s32 s33 s12'><span>            </span></span><span class='s32 s33 s7 s12'><span>throw</span></span><span
            class='s32 s33 s12'><span>;</span></span>
    </p>
    <p class='s1 s2 s15'><span class='s32 s33 s12'><span>        }</span></span></p>
    <p class='s1 s2 s15'><span class='s32 s33 s12'><span>    }</span></span></p>
    <p class='s1 s2 s15'><span class='s32 s33 s12'><span>}</span></span></p>
    <p class='s8 s9 s11'><br></p>
    <p class='s8 s9 s11'><br></p>
    <p class='s8 s9 s11'><span class='s4 s5'><span>ConnectorHub.cs</span></span></p>
    <p class='s8 s9 s11'><br></p>
    <p class='s1 s2 s15'>
        <span class='s32 s33 s7 s12'><span>using</span></span><span class='s32 s33 s12'><span> </span></span><span
            class='s32 s33 s7 s12'><span>Exporter.LiveSync.Interfaces</span></span><span
            class='s32 s33 s12'><span>;</span></span>
    </p>
    <p class='s1 s2 s15'>
        <span class='s32 s33 s7 s12'><span>using</span></span><span class='s32 s33 s12'><span> </span></span><span
            class='s32 s33 s7 s12'><span>Exporter.LiveSync.Models</span></span><span class='s32 s33 s12'><span>;</span></span>
    </p>
    <p class='s1 s2 s15'>
        <span class='s32 s33 s7 s12'><span>using</span></span><span class='s32 s33 s12'><span> </span></span><span
            class='s32 s33 s7 s12'><span>Microsoft.AspNetCore.SignalR</span></span><span
            class='s32 s33 s12'><span>;</span></span>
    </p>
    <p class='s1 s2 s15'><br></p>
    <p class='s1 s2 s15'>
        <span class='s32 s33 s7 s12'><span>namespace</span></span><span class='s32 s33 s12'><span> </span></span><span
            class='s32 s33 s7 s12'><span>Exporter.</span></span><span
            class='s32 s33 s7 s12'><span>LiveSync</span></span><span class='s32 s33 s12'><span>;</span></span>
    </p>
    <p class='s1 s2 s15'><br></p>
    <p class='s1 s2 s15'>
        <span class='s32 s33 s7 s12'><span>public</span></span><span class='s32 s33 s12'><span> </span></span><span
            class='s32 s33 s7 s12'><span>class</span></span><span class='s32 s33 s12'><span> </span></span><span
            class='s32 s33 s7 s12'><span>ConnectorHub</span></span><span class='s32 s33 s12'><span> :</span></span><span
            class='s32 s33 s12'><span> Hub</span></span>
    </p>
    <p class='s1 s2 s15'><span class='s32 s33 s12'><span>{</span></span></p>
    <p class='s1 s2 s15'>
        <span class='s32 s33 s12'><span>    </span></span><span class='s32 s33 s7 s12'><span>private</span></span><span
            class='s32 s33 s12'><span> </span></span><span class='s32 s33 s7 s12'><span>readonly</span></span><span
            class='s32 s33 s12'><span> </span></span><span
            class='s32 s33 s12'><span>IConnectionStorageService</span></span><span
            class='s32 s33 s12'><span> _</span></span><span
            class='s32 s33 s12'><span>connectionStorage</span></span><span class='s32 s33 s12'><span>;</span></span>
    </p>
    <p class='s1 s2 s15'>
        <span class='s32 s33 s12'><span>    </span></span><span class='s32 s33 s7 s12'><span>private</span></span><span
            class='s32 s33 s12'><span> </span></span><span class='s32 s33 s7 s12'><span>readonly</span></span><span
            class='s32 s33 s12'><span> </span></span><span class='s32 s33 s12'><span>ILogger</span></span><span
            class='s32 s33 s12'><span>&lt;</span></span><span class='s32 s33 s12'><span>ConnectorHub</span></span><span
            class='s32 s33 s12'><span>&gt; _</span></span><span class='s32 s33 s12'><span>logger;</span></span>
    </p>
    <p class='s1 s2 s15'><br></p>
    <p class='s1 s2 s15'>
        <span class='s32 s33 s12'><span>    </span></span><span class='s32 s33 s7 s12'><span>public</span></span><span
            class='s32 s33 s12'><span> </span></span><span class='s32 s33 s7 s12'><span>ConnectorHub</span></span><span
            class='s32 s33 s12'><span>(</span></span><span class='s32 s33 s12'><span>ILogger</span></span><span
            class='s32 s33 s12'><span>&lt;</span></span><span class='s32 s33 s12'><span>ConnectorHub</span></span><span
            class='s32 s33 s12'><span>&gt; logger, </span></span><span class='s32 s33 s12'><span>IConnectionStorageService</span></span><span
            class='s32 s33 s12'><span> </span></span><span
            class='s32 s33 s12'><span>connectionStorage</span></span><span class='s32 s33 s12'><span>)</span></span>
    </p>
    <p class='s1 s2 s15'><span class='s32 s33 s12'><span>    {</span></span></p>
    <p class='s1 s2 s15'>
        <span class='s32 s33 s12'><span>        _</span></span><span class='s32 s33 s12'><span>connectionStorage</span></span><span
            class='s32 s33 s12'><span> = </span></span><span
            class='s32 s33 s12'><span>connectionStorage</span></span><span class='s32 s33 s12'><span>;</span></span>
    </p>
    <p class='s1 s2 s15'><span class='s32 s33 s12'></span></p>
</div>
<div class='page'>
    <p class='s1 s2 s15'>
        <span class='s32 s33 s12'><span>        _logger = </span></span><span
            class='s32 s33 s12'><span>logger;</span></span>
    </p>
    <p class='s1 s2 s15'><span class='s32 s33 s12'><span>    }</span></span></p>
    <p class='s1 s2 s15'><br></p>
    <p class='s1 s2 s15'>
        <span class='s32 s33 s12'><span>    </span></span><span class='s32 s33 s7 s12'><span>public</span></span><span
            class='s32 s33 s12'><span> </span></span><span class='s32 s33 s7 s12'><span>async</span></span><span
            class='s32 s33 s12'><span> Task </span></span><span class='s32 s33 s7 s12'><span>Add</span></span><span
            class='s32 s33 s12'><span>(</span></span><span
            class='s32 s33 s12'><span>Connection connection)</span></span>
    </p>
    <p class='s1 s2 s15'><span class='s32 s33 s12'><span>    {</span></span></p>
    <p class='s1 s2 s15'>
        <span class='s32 s33 s12'><span>        _</span></span><span class='s32 s33 s12'><span>connectionStorage.AddConnection</span></span><span
            class='s32 s33 s12'><span>(connection</span></span><span class='s32 s33 s12'><span>);</span></span>
    </p>
    <p class='s1 s2 s15'><span class='s32 s33 s12'><span>    }</span></span></p>
    <p class='s1 s2 s15'><br></p>
    <p class='s1 s2 s15'>
        <span class='s32 s33 s12'><span>    </span></span><span class='s32 s33 s7 s12'><span>public</span></span><span
            class='s32 s33 s12'><span> </span></span><span class='s32 s33 s7 s12'><span>override</span></span><span
            class='s32 s33 s12'><span> </span></span><span class='s32 s33 s7 s12'><span>async</span></span><span
            class='s32 s33 s12'><span> Task </span></span><span
            class='s32 s33 s7 s12'><span>OnConnectedAsync</span></span><span
            class='s32 s33 s12'><span>(</span></span><span class='s32 s33 s12'><span>)</span></span>
    </p>
    <p class='s1 s2 s15'><span class='s32 s33 s12'><span>    {</span></span></p>
    <p class='s1 s2 s15'>
        <span class='s32 s33 s12'><span>        _</span></span><span
            class='s32 s33 s12'><span>logger.LogInformation</span></span><span class='s32 s33 s12'><span>(</span></span><span
            class='s32 s33 s12'><span>"Connected Id: {Id}"</span></span><span class='s32 s33 s12'><span>, </span></span><span
            class='s32 s33 s12'><span>Context.ConnectionId</span></span><span class='s32 s33 s12'><span>);</span></span>
    </p>
    <p class='s1 s2 s15'>
        <span class='s32 s33 s12'><span>        </span></span><span
            class='s32 s33 s7 s12'><span>await</span></span><span class='s32 s33 s12'><span> </span></span><span
            class='s32 s33 s7 s12'><span>base</span></span><span
            class='s32 s33 s12'><span>.OnConnectedAsync</span></span><span class='s32 s33 s12'><span>();</span></span>
    </p>
    <p class='s1 s2 s15'><span class='s32 s33 s12'><span>    }</span></span></p>
    <p class='s1 s2 s15'><br></p>
    <p class='s1 s2 s15'>
        <span class='s32 s33 s12'><span>    </span></span><span class='s32 s33 s7 s12'><span>public</span></span><span
            class='s32 s33 s12'><span> </span></span><span class='s32 s33 s7 s12'><span>override</span></span><span
            class='s32 s33 s12'><span> </span></span><span class='s32 s33 s7 s12'><span>async</span></span><span
            class='s32 s33 s12'><span> Task </span></span><span class='s32 s33 s7 s12'><span>OnDisconnectedAsync</span></span><span
            class='s32 s33 s12'><span>(</span></span><span class='s32 s33 s12'><span>Exception exception)</span></span>
    </p>
    <p class='s1 s2 s15'><span class='s32 s33 s12'><span>    {</span></span></p>
    <p class='s1 s2 s15'>
        <span class='s32 s33 s12'><span>        _</span></span><span class='s32 s33 s12'><span>connectionStorage.DeleteConnection</span></span><span
            class='s32 s33 s12'><span>(</span></span><span
            class='s32 s33 s12'><span>Context.ConnectionId</span></span><span class='s32 s33 s12'><span>);</span></span>
    </p>
    <p class='s1 s2 s15'>
        <span class='s32 s33 s12'><span>        </span></span><span
            class='s32 s33 s7 s12'><span>await</span></span><span class='s32 s33 s12'><span> </span></span><span
            class='s32 s33 s7 s12'><span>base</span></span><span
            class='s32 s33 s12'><span>.OnDisconnectedAsync</span></span><span
            class='s32 s33 s12'><span>(exception);</span></span>
    </p>
    <p class='s1 s2 s15'><span class='s32 s33 s12'><span>    }</span></span></p>
    <p class='s1 s2 s15'><span class='s32 s33 s12'><span>}</span></span></p>
    <p class='s8 s9 s11'><br></p>
    <p class='s8 s9 s11'><br></p>
    <p class='s8 s9 s11'><span class='s4 s5'><span>Program.cs</span></span></p>
    <p class='s8 s9 s11'><br></p>
    <p class='s1 s2 s15'>
        <span class='s32 s33 s7 s12'><span>using</span></span><span class='s32 s33 s12'><span> </span></span><span
            class='s32 s33 s7 s12'><span>Exporter.LiveSync.Controllers</span></span><span
            class='s32 s33 s12'><span>;</span></span>
    </p>
    <p class='s1 s2 s15'>
        <span class='s32 s33 s7 s12'><span>using</span></span><span class='s32 s33 s12'><span> </span></span><span
            class='s32 s33 s7 s12'><span>Exporter.LiveSync.Interfaces</span></span><span
            class='s32 s33 s12'><span>;</span></span>
    </p>
    <p class='s1 s2 s15'>
        <span class='s32 s33 s7 s12'><span>using</span></span><span class='s32 s33 s12'><span> </span></span><span
            class='s32 s33 s7 s12'><span>Exporter.LiveSync.Services</span></span><span
            class='s32 s33 s12'><span>;</span></span>
    </p>
    <p class='s1 s2 s15'>
        <span class='s32 s33 s7 s12'><span>using</span></span><span class='s32 s33 s12'><span> </span></span><span
            class='s32 s33 s7 s12'><span>Microsoft.AspNetCore.Http.Features</span></span><span
            class='s32 s33 s12'><span>;</span></span>
    </p>
    <p class='s1 s2 s15'><br></p>
    <p class='s1 s2 s15'>
        <span class='s32 s33 s7 s12'><span>namespace</span></span><span class='s32 s33 s12'><span> </span></span><span
            class='s32 s33 s7 s12'><span>Exporter.</span></span><span
            class='s32 s33 s7 s12'><span>LiveSync</span></span><span class='s32 s33 s12'><span>;</span></span>
    </p>
    <p class='s1 s2 s15'><br></p>
    <p class='s1 s2 s15'>
        <span class='s32 s33 s7 s12'><span>public</span></span><span class='s32 s33 s12'><span> </span></span><span
            class='s32 s33 s7 s12'><span>class</span></span><span class='s32 s33 s12'><span> </span></span><span
            class='s32 s33 s7 s12'><span>Program</span></span>
    </p>
    <p class='s1 s2 s15'><span class='s32 s33 s12'><span>{</span></span></p>
    <p class='s1 s2 s15'>
        <span class='s32 s33 s12'><span>    </span></span><span class='s32 s33 s7 s12'><span>public</span></span><span
            class='s32 s33 s12'><span> </span></span><span class='s32 s33 s7 s12'><span>void</span></span><span
            class='s32 s33 s12'><span> </span></span><span class='s32 s33 s7 s12'><span>StartServer</span></span><span
            class='s32 s33 s12'><span>(</span></span><span
            class='s32 s33 s12'><span>CancellationToken</span></span><span
            class='s32 s33 s12'><span> </span></span><span class='s32 s33 s12'><span>stoppingToken</span></span><span
            class='s32 s33 s12'><span>)</span></span>
    </p>
    <p class='s1 s2 s15'><span class='s32 s33 s12'><span>    {</span></span></p>
    <p class='s1 s2 s15'>
        <span class='s32 s33 s12'><span>        </span></span><span class='s32 s33 s7 s12'><span>var</span></span><span
            class='s32 s33 s12'><span> assembly = </span></span><span
            class='s32 s33 s7 s12'><span>typeof</span></span><span class='s32 s33 s12'><span>(</span></span><span
            class='s32 s33 s12'><span>ConnectorController</span></span><span
            class='s32 s33 s12'><span>).Assembly;</span></span>
    </p>
    <p class='s1 s2 s15'>
        <span class='s32 s33 s12'><span>        </span></span><span class='s32 s33 s7 s12'><span>var</span></span><span
            class='s32 s33 s12'><span> builder = </span></span><span class='s32 s33 s12'><span>WebApplication.CreateBuilder</span></span><span
            class='s32 s33 s12'><span>(</span></span><span class='s32 s33 s12'><span>);</span></span>
    </p>
    <p class='s1 s2 s15'><br></p>
    <p class='s1 s2 s15'>
        <span class='s32 s33 s12'><span>        </span></span><span class='s32 s33 s12'><span>builder.Services.AddControllers</span></span><span
            class='s32 s33 s12'><span>().AddApplicationPart(assembly).AddControllersAsServices();</span></span>
    </p>
    <p class='s1 s2 s15'><br></p>
    <p class='s1 s2 s15'>
        <span class='s32 s33 s12'><span>        </span></span><span class='s32 s33 s12'><span>builder.Services.AddEndpointsApiExplorer</span></span><span
            class='s32 s33 s12'><span>();</span></span>
    </p>
    <p class='s1 s2 s15'>
        <span class='s32 s33 s12'><span>        </span></span><span class='s32 s33 s12'><span>builder.Services.AddSwaggerGen</span></span><span
            class='s32 s33 s12'><span>();</span></span>
    </p>
    <p class='s1 s2 s15'>
        <span class='s32 s33 s12'><span>        </span></span><span class='s32 s33 s12'><span>builder.Services.AddSingleton</span></span><span
            class='s32 s33 s12'><span>&lt;</span></span><span class='s32 s33 s12'><span>IConnectionStorageService</span></span><span
            class='s32 s33 s12'><span>, </span></span><span
            class='s32 s33 s12'><span>ConnectionStorageService</span></span><span
            class='s32 s33 s12'><span>&gt;();</span></span>
    </p>
    <p class='s1 s2 s15'>
        <span class='s32 s33 s12'><span>        </span></span><span class='s32 s33 s12'><span>builder.Services.AddSignalR</span></span><span
            class='s32 s33 s12'><span>();</span></span>
    </p>
    <p class='s1 s2 s15'><br></p>
    <p class='s1 s2 s15'>
        <span class='s32 s33 s12'><span>        </span></span><span
            class='s32 s33 s12'><span>builder.Services.Configure</span></span><span
            class='s32 s33 s12'><span>&lt;</span></span><span class='s32 s33 s12'><span>FormOptions</span></span><span
            class='s32 s33 s12'><span>&gt;(</span></span><span class='s32 s33 s12'><span>formOptions</span></span><span
            class='s32 s33 s12'><span> =&gt;</span></span>
    </p>
    <p class='s1 s2 s15'><span class='s32 s33 s12'><span>        {</span></span></p>
    <p class='s1 s2 s15'>
        <span class='s32 s33 s12'><span>            </span></span><span class='s32 s33 s12'><span>formOptions.ValueLengthLimit</span></span><span
            class='s32 s33 s12'><span> = </span></span><span class='s32 s33 s7 s12'><span>int</span></span><span
            class='s32 s33 s12'><span>.MaxValue</span></span><span class='s32 s33 s12'><span>;</span></span>
    </p>
    <p class='s1 s2 s15'>
        <span class='s32 s33 s12'><span>            </span></span><span class='s32 s33 s12'><span>formOptions.MultipartBodyLengthLimit</span></span><span
            class='s32 s33 s12'><span> = </span></span><span class='s32 s33 s7 s12'><span>int</span></span><span
            class='s32 s33 s12'><span>.MaxValue</span></span><span class='s32 s33 s12'><span>;</span></span>
    </p>
    <p class='s1 s2 s15'><span class='s32 s33 s12'><span>        });</span></span></p>
    <p class='s1 s2 s15'><br></p>
    <p class='s1 s2 s15'>
        <span class='s32 s33 s12'><span>        </span></span><span
            class='s32 s33 s12'><span>builder.Services.AddCors</span></span><span class='s32 s33 s12'><span>(config =&gt;</span></span>
    </p>
    <p class='s1 s2 s15'><span class='s32 s33 s12'><span>        {</span></span></p>
    <p class='s1 s2 s15'>
        <span class='s32 s33 s12'><span>            </span></span><span
            class='s32 s33 s12'><span>config.AddPolicy</span></span><span class='s32 s33 s12'><span>(</span></span><span
            class='s32 s33 s12'><span>"</span></span><span class='s32 s33 s12'><span>DefaultPolicy</span></span><span
            class='s32 s33 s12'><span>"</span></span><span class='s32 s33 s12'><span>,</span></span>
    </p>
    <p class='s1 s2 s15'>
        <span class='s32 s33 s12'><span>                             </span></span><span class='s32 s33 s12'><span>policyBuilder</span></span><span
            class='s32 s33 s12'><span> =&gt; </span></span><span
            class='s32 s33 s12'><span>policyBuilder.WithOrigins</span></span><span
            class='s32 s33 s12'><span>(</span></span><span
            class='s32 s33 s12'><span>"https://localhost:3000"</span></span><span
            class='s32 s33 s12'><span>)</span></span>
    </p>
    <p class='s1 s2 s15'>
        <span class='s32 s33 s12'><span>                                 </span></span><span
            class='s32 s33 s12'><span>.</span></span><span class='s32 s33 s12'><span>AllowAnyMethod</span></span><span
            class='s32 s33 s12'><span>()</span></span>
    </p>
    <p class='s1 s2 s15'>
        <span class='s32 s33 s12'><span>                                 </span></span><span
            class='s32 s33 s12'><span>.</span></span><span class='s32 s33 s12'><span>AllowAnyHeader</span></span><span
            class='s32 s33 s12'><span>()</span></span>
    </p>
    <p class='s1 s2 s15'>
        <span class='s32 s33 s12'><span>                                 </span></span><span
            class='s32 s33 s12'><span>.</span></span><span class='s32 s33 s12'><span>AllowCredentials</span></span><span
            class='s32 s33 s12'><span>());</span></span>
    </p>
    <p class='s1 s2 s15'><span class='s32 s33 s12'><span>        });</span></span></p>
    <p class='s1 s2 s15'><br></p>
    <p class='s1 s2 s15'>
        <span class='s32 s33 s12'><span>        </span></span><span class='s32 s33 s7 s12'><span>var</span></span><span
            class='s32 s33 s12'><span> app = </span></span><span
            class='s32 s33 s12'><span>builder.Build</span></span><span class='s32 s33 s12'><span>();</span></span>
    </p>
    <p class='s1 s2 s15'><br></p>
    <p class='s1 s2 s15'>
        <span class='s32 s33 s12'><span>        </span></span><span class='s32 s33 s7 s12'><span>if</span></span><span
            class='s32 s33 s12'><span> (</span></span><span
            class='s32 s33 s12'><span>app.Environment.IsDevelopment</span></span><span
            class='s32 s33 s12'><span>())</span></span>
    </p>
    <p class='s1 s2 s15'><span class='s32 s33 s12'><span>        {</span></span></p>
    <p class='s1 s2 s15'>
        <span class='s32 s33 s12'><span>            </span></span><span class='s32 s33 s12'><span>app.UseSwagger</span></span><span
            class='s32 s33 s12'><span>();</span></span>
    </p>
    <p class='s1 s2 s15'>
        <span class='s32 s33 s12'><span>            </span></span><span
            class='s32 s33 s12'><span>app.UseSwaggerUI</span></span><span class='s32 s33 s12'><span>();</span></span>
    </p>
    <p class='s1 s2 s15'><span class='s32 s33 s12'><span>        }</span></span></p>
    <p class='s1 s2 s15'><br></p>
    <p class='s1 s2 s15'>
        <span class='s32 s33 s12'><span>        </span></span><span
            class='s32 s33 s12'><span>app.UseHttpsRedirection</span></span><span
            class='s32 s33 s12'><span>();</span></span>
    </p>
    <p class='s1 s2 s15'><br></p>
    <p class='s1 s2 s15'>
        <span class='s32 s33 s12'><span>        </span></span><span
            class='s32 s33 s12'><span>app.UseRouting</span></span><span class='s32 s33 s12'><span>();</span></span>
    </p>
    <p class='s1 s2 s15'><br></p>
    <p class='s1 s2 s15'>
        <span class='s32 s33 s12'><span>        </span></span><span
            class='s32 s33 s12'><span>app.UseCors</span></span><span class='s32 s33 s12'><span>(</span></span><span
            class='s32 s33 s12'><span>"</span></span><span class='s32 s33 s12'><span>DefaultPolicy</span></span><span
            class='s32 s33 s12'><span>"</span></span><span class='s32 s33 s12'><span>);</span></span>
    </p>
    <p class='s1 s2 s15'><br></p>
    <p class='s1 s2 s15'>
        <span class='s32 s33 s12'><span>        </span></span><span
            class='s32 s33 s12'><span>app.UseAuthentication</span></span><span
            class='s32 s33 s12'><span>();</span></span>
    </p>
    <p class='s1 s2 s15'><br></p>
    <p class='s1 s2 s15'>
        <span class='s32 s33 s12'><span>        </span></span><span
            class='s32 s33 s12'><span>app.UseAuthorization</span></span><span
            class='s32 s33 s12'><span>();</span></span>
    </p>
    <p class='s1 s2 s15'><br></p>
    <p class='s1 s2 s15'>
        <span class='s32 s33 s12'><span>        </span></span><span class='s32 s33 s12'><span>app.MapControllers</span></span><span
            class='s32 s33 s12'><span>();</span></span>
    </p>
    <p class='s1 s2 s15'><br></p>
    <p class='s1 s2 s15'>
        <span class='s32 s33 s12'><span>        </span></span><span
            class='s32 s33 s12'><span>app.UseEndpoints</span></span><span
            class='s32 s33 s12'><span>(endpoints =&gt;</span></span>
    </p>
    <p class='s1 s2 s15'><span class='s32 s33 s12'><span>        {</span></span></p>
    <p class='s1 s2 s15'>
        <span class='s32 s33 s12'><span>            </span></span><span
            class='s32 s33 s12'><span>endpoints.MapHub</span></span><span
            class='s32 s33 s12'><span>&lt;</span></span><span class='s32 s33 s12'><span>ConnectorHub</span></span><span
            class='s32 s33 s12'><span>&gt;(</span></span><span class='s32 s33 s12'><span>"/hub"</span></span><span
            class='s32 s33 s12'><span>);</span></span>
    </p>
    <p class='s1 s2 s15'><span class='s32 s33 s12'><span>        });</span></span></p>
    <p class='s1 s2 s15'><br></p>
    <p class='s1 s2 s15'>
        <span class='s32 s33 s12'><span>        </span></span><span class='s32 s33 s12'><span>app.RunAsync</span></span><span
            class='s32 s33 s12'><span>(</span></span><span class='s32 s33 s12'><span>stoppingToken</span></span><span
            class='s32 s33 s12'><span>);</span></span>
    </p>
    <p class='s1 s2 s15'><span class='s32 s33 s12'><span>    }</span></span></p>
    <p class='s1 s2 s15'><span class='s32 s33 s12'><span>}</span></span></p>
    <p class='s8 s9 s11'><br></p>
    <p class='s8 s9 s11'><br></p>
    <p class='s8 s9 s11'><span class='s4 s5'><span>Connection.cs</span></span></p>
    <p class='s8 s9 s11'><br></p>
    <p class='s1 s2 s15'>
        <span class='s32 s33 s7 s12'><span>namespace</span></span><span class='s32 s33 s12'><span> </span></span><span
            class='s32 s33 s7 s12'><span>Exporter.LiveSync.Models</span></span><span class='s32 s33 s12'><span>;</span></span>
    </p>
    <p class='s1 s2 s15'><br></p>
    <p class='s1 s2 s15'>
        <span class='s32 s33 s7 s12'><span>public</span></span><span class='s32 s33 s12'><span> </span></span><span
            class='s32 s33 s7 s12'><span>class</span></span><span class='s32 s33 s12'><span> </span></span><span
            class='s32 s33 s7 s12'><span>Connection</span></span>
    </p>
    <p class='s1 s2 s15'><span class='s32 s33 s12'><span>{</span></span></p>
    <p class='s1 s2 s15'>
        <span class='s32 s33 s12'><span>    </span></span><span class='s32 s33 s7 s12'><span>public</span></span><span
            class='s32 s33 s12'><span> </span></span><span class='s32 s33 s7 s12'><span>string</span></span><span
            class='s32 s33 s12'><span> </span></span><span class='s32 s33 s12'><span>ProjectName</span></span><span
            class='s32 s33 s12'><span> </span></span><span class='s32 s33 s12'><span>{ </span></span><span
            class='s32 s33 s7 s12'><span>get</span></span><span class='s32 s33 s12'><span>; </span></span><span
            class='s32 s33 s7 s12'><span>set</span></span><span class='s32 s33 s12'><span>; }</span></span>
    </p>
    <p class='s1 s2 s15'>
        <span class='s32 s33 s12'><span>    </span></span><span class='s32 s33 s7 s12'><span>public</span></span><span
            class='s32 s33 s12'><span> </span></span><span class='s32 s33 s7 s12'><span>string</span></span><span
            class='s32 s33 s12'><span> </span></span><span class='s32 s33 s12'><span>ConnectionId</span></span><span
            class='s32 s33 s12'><span> </span></span><span class='s32 s33 s12'><span>{ </span></span><span
            class='s32 s33 s7 s12'><span>get</span></span><span class='s32 s33 s12'><span>; </span></span><span
            class='s32 s33 s7 s12'><span>set</span></span><span class='s32 s33 s12'><span>; }</span></span>
    </p>
    <p class='s1 s2 s15'><span class='s32 s33 s12'><span>}</span></span></p>
    <p class='s8 s9 s11'><br></p>
    <p class='s8 s9 s11'><br></p>
    <p class='s8 s9 s11'><span class='s4 s5'><span>IConnectionsStorageService.cs</span></span></p>
    <p class='s8 s9 s11'><br></p>
    <p class='s1 s2 s15'>
        <span class='s32 s33 s7 s12'><span>using</span></span><span class='s32 s33 s12'><span> </span></span><span
            class='s32 s33 s7 s12'><span>Exporter.LiveSync.Models</span></span><span class='s32 s33 s12'><span>;</span></span>
    </p>
    <p class='s1 s2 s15'><br></p>
    <p class='s1 s2 s15'>
        <span class='s32 s33 s7 s12'><span>namespace</span></span><span class='s32 s33 s12'><span> </span></span><span
            class='s32 s33 s7 s12'><span>Exporter.LiveSync.Interfaces</span></span><span
            class='s32 s33 s12'><span>;</span></span>
    </p>
    <p class='s1 s2 s15'><br></p>
    <p class='s1 s2 s15'>
        <span class='s32 s33 s7 s12'><span>public</span></span><span class='s32 s33 s12'><span> </span></span><span
            class='s32 s33 s7 s12'><span>interface</span></span><span class='s32 s33 s12'><span> </span></span><span
            class='s32 s33 s12'><span>IConnectionStorageService</span></span>
    </p>
    <p class='s1 s2 s15'><span class='s32 s33 s12'><span>{</span></span></p>
    <p class='s1 s2 s15'>
        <span class='s32 s33 s12'><span>    </span></span><span class='s32 s33 s7 s12'><span>bool</span></span><span
            class='s32 s33 s12'><span> </span></span><span
            class='s32 s33 s7 s12'><span>IsConnectionExist</span></span><span
            class='s32 s33 s12'><span>(</span></span><span class='s32 s33 s7 s12'><span>string</span></span><span
            class='s32 s33 s12'><span> </span></span><span class='s32 s33 s12'><span>connectionId</span></span><span
            class='s32 s33 s12'><span>);</span></span>
    </p>
    <p class='s1 s2 s15'>
        <span class='s32 s33 s12'><span>    </span></span><span class='s32 s33 s7 s12'><span>void</span></span><span
            class='s32 s33 s12'><span> </span></span><span class='s32 s33 s7 s12'><span>AddConnection</span></span><span
            class='s32 s33 s12'><span>(</span></span><span
            class='s32 s33 s12'><span>Connection connection);</span></span>
    </p>
    <p class='s1 s2 s15'>
        <span class='s32 s33 s12'><span>    </span></span><span class='s32 s33 s12'><span>IEnumerable</span></span><span
            class='s32 s33 s12'><span>&lt;Connection&gt; </span></span><span
            class='s32 s33 s12'><span>GetConnections</span></span><span class='s32 s33 s12'><span>(</span></span><span
            class='s32 s33 s12'><span>);</span></span>
    </p>
    <p class='s1 s2 s15'>
        <span class='s32 s33 s12'><span>    Connection? </span></span><span
            class='s32 s33 s12'><span>GetConnection</span></span><span class='s32 s33 s12'><span>(</span></span><span
            class='s32 s33 s7 s12'><span>string</span></span><span class='s32 s33 s12'><span> </span></span><span
            class='s32 s33 s12'><span>projectName</span></span><span class='s32 s33 s12'><span>);</span></span>
    </p>
    <p class='s1 s2 s15'>
        <span class='s32 s33 s12'><span>    </span></span><span class='s32 s33 s7 s12'><span>void</span></span><span
            class='s32 s33 s12'><span> </span></span><span
            class='s32 s33 s7 s12'><span>DeleteConnection</span></span><span
            class='s32 s33 s12'><span>(</span></span><span class='s32 s33 s7 s12'><span>string</span></span><span
            class='s32 s33 s12'><span> </span></span><span class='s32 s33 s12'><span>connectionId</span></span><span
            class='s32 s33 s12'><span>);</span></span>
    </p>
    <p class='s1 s2 s15'><span class='s32 s33 s12'><span>}</span></span></p>
    <p class='s13 s14 s2 s15'><br></p>
    <p class='s13 s14 s2 s15'><br></p>
    <p class='s8 s2 s6'>
        <span class='s4 s5 s7'><span>ПРИЛОЖЕНИЕ</span></span><span class='s4 s5 s7'><span> </span></span><span
            class='s4 s5 s7'><span>Б</span></span>
    </p>
    <p class='s8 s9 s11'><br></p>
    <p class='s8 s9 s11'><span class='s4 s5'><span>TcpServer.cs</span></span></p>
    <p class='s8 s9 s11'><br></p>
    <p class='s8 s9 s11'>
        <span class='s32 s33 s7'><span>using</span></span><span class='s32 s33'><span> </span></span><span
            class='s32 s33 s7'><span>System</span></span><span class='s32 s33 s7'><span>.Net</span></span><span
            class='s32 s33'><span>;</span></span>
    </p>
    <p class='s8 s9 s11'>
        <span class='s32 s33 s7'><span>using</span></span><span class='s32 s33'><span> </span></span><span
            class='s32 s33 s7'><span>System.Net.</span></span><span class='s32 s33 s7'><span>Sockets</span></span><span
            class='s32 s33'><span>;</span></span>
    </p>
    <p class='s8 s9 s11'>
        <span class='s32 s33 s7'><span>using</span></span><span class='s32 s33'><span> </span></span><span
            class='s32 s33 s7'><span>System.</span></span><span class='s32 s33 s7'><span>Text</span></span><span
            class='s32 s33'><span>;</span></span>
    </p>
    <p class='s8 s9 s11'>
        <span class='s32 s33 s7'><span>using</span></span><span class='s32 s33'><span> </span></span><span
            class='s32 s33 s7'><span>Exporter.Service.Interfaces</span></span><span
            class='s32 s33'><span>;</span></span>
    </p>
    <p class='s8 s9 s11'><br></p>
    <p class='s8 s9 s11'>
        <span class='s32 s33 s7'><span>namespace</span></span><span class='s32 s33'><span> </span></span><span
            class='s32 s33 s7'><span>Exporter.Service.Services</span></span><span class='s32 s33'><span>;</span></span>
    </p>
    <p class='s8 s9 s11'><br></p>
    <p class='s8 s9 s11'>
        <span class='s32 s33 s7'><span>public</span></span><span class='s32 s33'><span> </span></span><span
            class='s32 s33 s7'><span>class</span></span><span class='s32 s33'><span> </span></span><span
            class='s32 s33 s7'><span>TcpServer</span></span><span class='s32 s33'><span> :</span></span><span
            class='s32 s33'><span> </span></span><span class='s32 s33'><span>ITcpServer</span></span>
    </p>
    <p class='s8 s9 s11'><span class='s32 s33'><span>{</span></span></p>
    <p class='s8 s9 s11'>
        <span class='s32 s33'><span>    </span></span><span class='s32 s33 s7'><span>private</span></span><span
            class='s32 s33'><span> </span></span><span class='s32 s33 s7'><span>const</span></span><span
            class='s32 s33'><span> </span></span><span class='s32 s33 s7'><span>int</span></span><span
            class='s32 s33'><span> Port = </span></span><span class='s32 s33 s7'><span>8888</span></span><span
            class='s32 s33'><span>;</span></span>
    </p>
    <p class='s8 s9 s11'>
        <span class='s32 s33'><span>    </span></span><span class='s32 s33 s7'><span>private</span></span><span
            class='s32 s33'><span> </span></span><span class='s32 s33 s7'><span>readonly</span></span><span
            class='s32 s33'><span> </span></span><span class='s32 s33'><span>IAssemblyService</span></span><span
            class='s32 s33'><span> _</span></span><span class='s32 s33'><span>assemblyService</span></span><span
            class='s32 s33'><span>;</span></span>
    </p>
    <p class='s8 s9 s11'>
        <span class='s32 s33'><span>    </span></span><span class='s32 s33 s7'><span>private</span></span><span
            class='s32 s33'><span> </span></span><span class='s32 s33 s7'><span>readonly</span></span><span
            class='s32 s33'><span> </span></span><span class='s32 s33'><span>ILogger</span></span><span class='s32 s33'><span>&lt;</span></span><span
            class='s32 s33'><span>TcpServer</span></span><span class='s32 s33'><span>&gt; _</span></span><span
            class='s32 s33'><span>logger;</span></span>
    </p>
    <p class='s8 s9 s11'><br></p>
    <p class='s8 s9 s11'>
        <span class='s32 s33'><span>    </span></span><span class='s32 s33 s7'><span>public</span></span><span
            class='s32 s33'><span> </span></span><span class='s32 s33 s7'><span>TcpServer</span></span><span
            class='s32 s33'><span>(</span></span><span class='s32 s33'><span>ILogger</span></span><span class='s32 s33'><span>&lt;</span></span><span
            class='s32 s33'><span>TcpServer</span></span><span class='s32 s33'><span>&gt; logger, </span></span><span
            class='s32 s33'><span>IAssemblyService</span></span><span class='s32 s33'><span> </span></span><span
            class='s32 s33'><span>assemblyService</span></span><span class='s32 s33'><span>)</span></span>
    </p>
    <p class='s8 s9 s11'><span class='s32 s33'><span>    {</span></span></p>
    <p class='s8 s9 s11'>
        <span class='s32 s33'><span>        _logger = </span></span><span class='s32 s33'><span>logger;</span></span>
    </p>
    <p class='s8 s9 s11'><span class='s32 s33'></span></p>
</div>
<div class='page'>
    <p class='s8 s9 s11'>
        <span class='s32 s33'><span>        _</span></span><span
            class='s32 s33'><span>assemblyService</span></span><span class='s32 s33'><span> = </span></span><span
            class='s32 s33'><span>assemblyService</span></span><span class='s32 s33'><span>;</span></span>
    </p>
    <p class='s8 s9 s11'><span class='s32 s33'><span>    }</span></span></p>
    <p class='s8 s9 s11'><br></p>
    <p class='s8 s9 s11'>
        <span class='s32 s33'><span>    </span></span><span class='s32 s33 s7'><span>public</span></span><span
            class='s32 s33'><span> </span></span><span class='s32 s33 s7'><span>void</span></span><span class='s32 s33'><span> </span></span><span
            class='s32 s33 s7'><span>Start</span></span><span class='s32 s33'><span>(</span></span><span
            class='s32 s33'><span>)</span></span>
    </p>
    <p class='s8 s9 s11'><span class='s32 s33'><span>    {</span></span></p>
    <p class='s8 s9 s11'>
        <span class='s32 s33'><span>        </span></span><span class='s32 s33'><span>TcpListener</span></span><span
            class='s32 s33'><span>? server = </span></span><span class='s32 s33 s7'><span>null</span></span><span
            class='s32 s33'><span>;</span></span>
    </p>
    <p class='s8 s9 s11'>
        <span class='s32 s33'><span>        </span></span><span class='s32 s33 s7'><span>try</span></span></p>
    <p class='s8 s9 s11'><span class='s32 s33'><span>        {</span></span></p>
    <p class='s8 s9 s11'>
        <span class='s32 s33'><span>            </span></span><span class='s32 s33 s7'><span>var</span></span><span
            class='s32 s33'><span> </span></span><span class='s32 s33'><span>localAddress</span></span><span
            class='s32 s33'><span> = </span></span><span class='s32 s33'><span>IPAddress.Parse</span></span><span
            class='s32 s33'><span>(</span></span><span class='s32 s33'><span>"127.0.0.1"</span></span><span
            class='s32 s33'><span>);</span></span>
    </p>
    <p class='s8 s9 s11'>
        <span class='s32 s33'><span>            server = </span></span><span
            class='s32 s33 s7'><span>new</span></span><span class='s32 s33'><span> </span></span><span
            class='s32 s33'><span>TcpListener</span></span><span class='s32 s33'><span>(</span></span><span
            class='s32 s33'><span>localAddress</span></span><span class='s32 s33'><span>, Port);</span></span>
    </p>
    <p class='s8 s9 s11'><br></p>
    <p class='s8 s9 s11'>
        <span class='s32 s33'><span>            </span></span><span
            class='s32 s33'><span>server.Start</span></span><span class='s32 s33'><span>();</span></span>
    </p>
    <p class='s8 s9 s11'><br></p>
    <p class='s8 s9 s11'>
        <span class='s32 s33'><span>            </span></span><span class='s32 s33 s7'><span>while</span></span><span
            class='s32 s33'><span> (</span></span><span class='s32 s33 s7'><span>true</span></span><span
            class='s32 s33'><span>)</span></span>
    </p>
    <p class='s8 s9 s11'><span class='s32 s33'><span>            {</span></span></p>
    <p class='s8 s9 s11'>
        <span class='s32 s33'><span>                _</span></span><span
            class='s32 s33'><span>logger.LogInformation</span></span><span class='s32 s33'><span>(</span></span><span
            class='s32 s33'><span>"</span></span><span class='s32 s33'><span>Ожидание</span></span><span
            class='s32 s33'><span> </span></span><span class='s32 s33'><span>подключений</span></span><span
            class='s32 s33'><span>... "</span></span><span class='s32 s33'><span>);</span></span>
    </p>
    <p class='s8 s9 s11'><br></p>
    <p class='s8 s9 s11'>
        <span class='s32 s33'><span>                </span></span><span class='s32 s33 s7'><span>var</span></span><span
            class='s32 s33'><span> client = </span></span><span
            class='s32 s33'><span>server.AcceptTcpClient</span></span><span class='s32 s33'><span>();</span></span>
    </p>
    <p class='s8 s9 s11'>
        <span class='s32 s33'><span>                _</span></span><span
            class='s32 s33'><span>logger.LogInformation</span></span><span class='s32 s33'><span>(</span></span><span
            class='s32 s33'><span>"</span></span><span class='s32 s33'><span>Подключен</span></span><span
            class='s32 s33'><span> </span></span><span class='s32 s33'><span>клиент</span></span><span
            class='s32 s33'><span>. </span></span><span class='s32 s33'><span>Выполнение запроса..."</span></span><span
            class='s32 s33'><span>);</span></span>
    </p>
    <p class='s8 s9 s11'><br></p>
    <p class='s8 s9 s11'>
        <span class='s32 s33'><span>                </span></span><span class='s32 s33 s7'><span>var</span></span><span
            class='s32 s33'><span> data = </span></span><span class='s32 s33 s7'><span>new</span></span><span
            class='s32 s33'><span> </span></span><span class='s32 s33 s7'><span>byte</span></span><span class='s32 s33'><span>[</span></span><span
            class='s32 s33 s7'><span>256</span></span><span class='s32 s33'><span>];</span></span>
    </p>
    <p class='s8 s9 s11'>
        <span class='s32 s33'><span>                </span></span><span class='s32 s33 s7'><span>var</span></span><span
            class='s32 s33'><span> response = </span></span><span class='s32 s33 s7'><span>new</span></span><span
            class='s32 s33'><span> </span></span><span class='s32 s33'><span>StringBuilder(</span></span><span
            class='s32 s33'><span>);</span></span>
    </p>
    <p class='s8 s9 s11'>
        <span class='s32 s33'><span>                </span></span><span class='s32 s33 s7'><span>var</span></span><span
            class='s32 s33'><span> stream = </span></span><span
            class='s32 s33'><span>client.GetStream</span></span><span class='s32 s33'><span>();</span></span>
    </p>
    <p class='s8 s9 s11'><br></p>
    <p class='s8 s9 s11'>
        <span class='s32 s33'><span>                </span></span><span class='s32 s33 s7'><span>do</span></span>
    </p>
    <p class='s8 s9 s11'><span class='s32 s33'><span>                {</span></span></p>
    <p class='s8 s9 s11'>
        <span class='s32 s33'><span>                    </span></span><span
            class='s32 s33 s7'><span>var</span></span><span class='s32 s33'><span> bytes = </span></span><span
            class='s32 s33'><span>stream.Read</span></span><span class='s32 s33'><span>(data, </span></span><span
            class='s32 s33 s7'><span>0</span></span><span class='s32 s33'><span>, </span></span><span
            class='s32 s33'><span>data.Length</span></span><span class='s32 s33'><span>);</span></span>
    </p>
    <p class='s8 s9 s11'>
        <span class='s32 s33'><span>                    </span></span><span class='s32 s33'><span>response.Append</span></span><span
            class='s32 s33'><span>(Encoding.UTF8.GetString(data, </span></span><span
            class='s32 s33 s7'><span>0</span></span><span class='s32 s33'><span>, bytes));</span></span>
    </p>
    <p class='s8 s9 s11'>
        <span class='s32 s33'><span>                } </span></span><span
            class='s32 s33 s7'><span>while</span></span><span class='s32 s33'><span> (</span></span><span
            class='s32 s33'><span>stream.DataAvailable</span></span><span class='s32 s33'><span>);</span></span>
    </p>
    <p class='s8 s9 s11'><br></p>
    <p class='s8 s9 s11'>
        <span class='s32 s33'><span>                </span></span><span class='s32 s33 s7'><span>var</span></span><span
            class='s32 s33'><span> command = </span></span><span
            class='s32 s33'><span>response.ToString</span></span><span class='s32 s33'><span>();</span></span>
    </p>
    <p class='s8 s9 s11'><br></p>
    <p class='s8 s9 s11'>
        <span class='s32 s33'><span>                </span></span><span class='s32 s33 s7'><span>try</span></span>
    </p>
    <p class='s8 s9 s11'><span class='s32 s33'><span>                {</span></span></p>
    <p class='s8 s9 s11'>
        <span class='s32 s33'><span>                    _</span></span><span
            class='s32 s33'><span>logger.LogInformation</span></span><span class='s32 s33'><span>(</span></span><span
            class='s32 s33'><span>"Response (command) = {Command}"</span></span><span
            class='s32 s33'><span>, command);</span></span>
    </p>
    <p class='s8 s9 s11'><span class='s32 s33'></span></p>
</div>
<div class='page'>
    <p class='s8 s9 s11'>
        <span class='s32 s33'><span>                    </span></span><span
            class='s32 s33 s7'><span>switch</span></span><span class='s32 s33'><span> (command)</span></span>
    </p>
    <p class='s8 s9 s11'><span class='s32 s33'><span>                    {</span></span></p>
    <p class='s8 s9 s11'>
        <span class='s32 s33'><span>                        </span></span><span
            class='s32 s33 s7'><span>case</span></span><span class='s32 s33'><span> </span></span><span
            class='s32 s33 s7'><span>nameof</span></span><span class='s32 s33'><span>(</span></span><span
            class='s32 s33'><span>_</span></span><span
            class='s32 s33'><span>assemblyService.LoadAssembly</span></span><span class='s32 s33'><span>):</span></span>
    </p>
    <p class='s8 s9 s11'>
        <span class='s32 s33'><span>                            _</span></span><span class='s32 s33'><span>assemblyService.LoadAssembly</span></span><span
            class='s32 s33'><span>(</span></span><span class='s32 s33'><span>);</span></span>
    </p>
    <p class='s8 s9 s11'>
        <span class='s32 s33'><span>                            </span></span><span
            class='s32 s33 s7'><span>break</span></span><span class='s32 s33'><span>;</span></span>
    </p>
    <p class='s8 s9 s11'>
        <span class='s32 s33'><span>                        </span></span><span
            class='s32 s33 s7'><span>case</span></span><span class='s32 s33'><span> </span></span><span
            class='s32 s33 s7'><span>nameof</span></span><span class='s32 s33'><span>(</span></span><span
            class='s32 s33'><span>_</span></span><span
            class='s32 s33'><span>assemblyService.UnloadAssembly</span></span><span
            class='s32 s33'><span>):</span></span>
    </p>
    <p class='s8 s9 s11'>
        <span class='s32 s33'><span>                            _</span></span><span class='s32 s33'><span>assemblyService.UnloadAssembly</span></span><span
            class='s32 s33'><span>(</span></span><span class='s32 s33'><span>);</span></span>
    </p>
    <p class='s8 s9 s11'>
        <span class='s32 s33'><span>                            </span></span><span
            class='s32 s33 s7'><span>break</span></span><span class='s32 s33'><span>;</span></span>
    </p>
    <p class='s8 s9 s11'>
        <span class='s32 s33'><span>                        </span></span><span class='s32 s33 s7'><span>default</span></span><span
            class='s32 s33'><span>:</span></span>
    </p>
    <p class='s8 s9 s11'>
        <span class='s32 s33'><span>                            _</span></span><span class='s32 s33'><span>logger.LogInformation</span></span><span
            class='s32 s33'><span>(</span></span><span class='s32 s33'><span>"Command:{Command} not found"</span></span><span
            class='s32 s33'><span>, command);</span></span>
    </p>
    <p class='s8 s9 s11'>
        <span class='s32 s33'><span>                            </span></span><span
            class='s32 s33 s7'><span>break</span></span><span class='s32 s33'><span>;</span></span>
    </p>
    <p class='s8 s9 s11'><span class='s32 s33'><span>                    }</span></span></p>
    <p class='s8 s9 s11'><span class='s32 s33'><span>                }</span></span></p>
    <p class='s8 s9 s11'>
        <span class='s32 s33'><span>                </span></span><span
            class='s32 s33 s7'><span>catch</span></span><span class='s32 s33'><span> (Exception ex)</span></span>
    </p>
    <p class='s8 s9 s11'><span class='s32 s33'><span>                {</span></span></p>
    <p class='s8 s9 s11'>
        <span class='s32 s33'><span>                    _</span></span><span
            class='s32 s33'><span>logger.LogError</span></span><span class='s32 s33'><span>(</span></span><span
            class='s32 s33'><span>ex.Message</span></span><span class='s32 s33'><span>);</span></span>
    </p>
    <p class='s8 s9 s11'><span class='s32 s33'><span>                }</span></span></p>
    <p class='s8 s9 s11'><br></p>
    <p class='s8 s9 s11'>
        <span class='s32 s33'><span>                </span></span><span class='s32 s33'><span>stream.Close</span></span><span
            class='s32 s33'><span>();</span></span>
    </p>
    <p class='s8 s9 s11'>
        <span class='s32 s33'><span>                </span></span><span class='s32 s33'><span>client.Close</span></span><span
            class='s32 s33'><span>();</span></span>
    </p>
    <p class='s8 s9 s11'><span class='s32 s33'><span>            }</span></span></p>
    <p class='s8 s9 s11'><span class='s32 s33'><span>        }</span></span></p>
    <p class='s8 s9 s11'>
        <span class='s32 s33'><span>        </span></span><span class='s32 s33 s7'><span>catch</span></span><span
            class='s32 s33'><span> (Exception ex)</span></span>
    </p>
    <p class='s8 s9 s11'><span class='s32 s33'><span>        {</span></span></p>
    <p class='s8 s9 s11'>
        <span class='s32 s33'><span>            _</span></span><span class='s32 s33'><span>logger.LogError</span></span><span
            class='s32 s33'><span>(</span></span><span class='s32 s33'><span>ex.Message</span></span><span
            class='s32 s33'><span>);</span></span>
    </p>
    <p class='s8 s9 s11'><span class='s32 s33'><span>        }</span></span></p>
    <p class='s8 s9 s11'>
        <span class='s32 s33'><span>        </span></span><span class='s32 s33 s7'><span>finally</span></span>
    </p>
    <p class='s8 s9 s11'><span class='s32 s33'><span>        {</span></span></p>
    <p class='s8 s9 s11'>
        <span class='s32 s33'><span>            </span></span><span class='s32 s33'><span>server?.</span></span><span
            class='s32 s33'><span>Stop</span></span><span class='s32 s33'><span>();</span></span>
    </p>
    <p class='s8 s9 s11'><span class='s32 s33'><span>        }</span></span></p>
    <p class='s8 s9 s11'><span class='s32 s33'><span>    }</span></span></p>
    <p class='s8 s9 s11'><span class='s32 s33'><span>}</span></span></p>
    <p class='s8 s9 s11'><br></p>
    <p class='s8 s9 s11'><span class='s4 s5'><span>AssemblyService.cs</span></span></p>
    <p class='s8 s9 s11'><br></p>
    <p class='s1 s2 s15'>
        <span class='s32 s33 s7 s12'><span>using</span></span><span class='s32 s33 s12'><span> </span></span><span
            class='s32 s33 s7 s12'><span>Exporter.Service.Interfaces</span></span><span
            class='s32 s33 s12'><span>;</span></span>
    </p>
    <p class='s1 s2 s15'><br></p>
    <p class='s1 s2 s15'>
        <span class='s32 s33 s7 s12'><span>namespace</span></span><span class='s32 s33 s12'><span> </span></span><span
            class='s32 s33 s7 s12'><span>Exporter.Service.Services</span></span><span class='s32 s33 s12'><span>;</span></span>
    </p>
    <p class='s1 s2 s15'><br></p>
    <p class='s1 s2 s15'>
        <span class='s32 s33 s7 s12'><span>public</span></span><span class='s32 s33 s12'><span> </span></span><span
            class='s32 s33 s7 s12'><span>class</span></span><span class='s32 s33 s12'><span> </span></span><span
            class='s32 s33 s7 s12'><span>AssemblyService</span></span><span
            class='s32 s33 s12'><span> :</span></span><span class='s32 s33 s12'><span> </span></span><span
            class='s32 s33 s12'><span>IAssemblyService</span></span>
    </p>
    <p class='s1 s2 s15'><span class='s32 s33 s12'><span>{</span></span></p>
    <p class='s1 s2 s15'>
        <span class='s32 s33 s12'><span>    </span></span><span class='s32 s33 s7 s12'><span>private</span></span><span
            class='s32 s33 s12'><span> </span></span><span class='s32 s33 s7 s12'><span>const</span></span><span
            class='s32 s33 s12'><span> </span></span><span class='s32 s33 s7 s12'><span>string</span></span><span
            class='s32 s33 s12'><span> </span></span><span class='s32 s33 s12'><span>AssemblyFilePath</span></span><span
            class='s32 s33 s12'><span> = </span></span><span
            class='s32 s33 s12'><span>"Server/Exporter.LiveSync.dll</span></span><span
            class='s32 s33 s12'><span>"</span></span><span class='s32 s33 s12'><span>;</span></span>
    </p>
    <p class='s1 s2 s15'>
        <span class='s32 s33 s12'><span>    </span></span><span class='s32 s33 s7 s12'><span>private</span></span><span
            class='s32 s33 s12'><span> </span></span><span class='s32 s33 s7 s12'><span>readonly</span></span><span
            class='s32 s33 s12'><span> </span></span><span class='s32 s33 s12'><span>ILogger</span></span><span
            class='s32 s33 s12'><span>&lt;</span></span><span
            class='s32 s33 s12'><span>AssemblyService</span></span><span
            class='s32 s33 s12'><span>&gt; _</span></span><span class='s32 s33 s12'><span>logger;</span></span>
    </p>
    <p class='s1 s2 s15'>
        <span class='s32 s33 s12'><span>    </span></span><span class='s32 s33 s7 s12'><span>private</span></span><span
            class='s32 s33 s12'><span> </span></span><span
            class='s32 s33 s12'><span>CancellationTokenSource</span></span><span
            class='s32 s33 s12'><span> _</span></span><span
            class='s32 s33 s12'><span>cancelTokenSource</span></span><span
            class='s32 s33 s12'><span> = </span></span><span class='s32 s33 s7 s12'><span>new</span></span><span
            class='s32 s33 s12'><span>(</span></span><span class='s32 s33 s12'><span>);</span></span>
    </p>
    <p class='s1 s2 s15'>
        <span class='s32 s33 s12'><span>    </span></span><span class='s32 s33 s7 s12'><span>private</span></span><span
            class='s32 s33 s12'><span> </span></span><span
            class='s32 s33 s12'><span>CustomAssemblyLoadContext</span></span><span
            class='s32 s33 s12'><span> _context = </span></span><span
            class='s32 s33 s7 s12'><span>new</span></span><span class='s32 s33 s12'><span>(</span></span><span
            class='s32 s33 s12'><span>);</span></span>
    </p>
    <p class='s1 s2 s15'><br></p>
    <p class='s1 s2 s15'>
        <span class='s32 s33 s12'><span>    </span></span><span class='s32 s33 s7 s12'><span>public</span></span><span
            class='s32 s33 s12'><span> </span></span><span
            class='s32 s33 s7 s12'><span>AssemblyService</span></span><span
            class='s32 s33 s12'><span>(</span></span><span class='s32 s33 s12'><span>ILogger</span></span><span
            class='s32 s33 s12'><span>&lt;</span></span><span
            class='s32 s33 s12'><span>AssemblyService</span></span><span
            class='s32 s33 s12'><span>&gt; logger)</span></span>
    </p>
    <p class='s1 s2 s15'><span class='s32 s33 s12'><span>    {</span></span></p>
    <p class='s1 s2 s15'>
        <span class='s32 s33 s12'><span>        _logger = </span></span><span
            class='s32 s33 s12'><span>logger;</span></span>
    </p>
    <p class='s1 s2 s15'><span class='s32 s33 s12'><span>    }</span></span></p>
    <p class='s1 s2 s15'><br></p>
    <p class='s1 s2 s15'>
        <span class='s32 s33 s12'><span>    </span></span><span class='s32 s33 s7 s12'><span>public</span></span><span
            class='s32 s33 s12'><span> </span></span><span class='s32 s33 s7 s12'><span>void</span></span><span
            class='s32 s33 s12'><span> </span></span><span class='s32 s33 s7 s12'><span>LoadAssembly</span></span><span
            class='s32 s33 s12'><span>(</span></span><span class='s32 s33 s12'><span>)</span></span>
    </p>
    <p class='s1 s2 s15'><span class='s32 s33 s12'><span>    {</span></span></p>
    <p class='s1 s2 s15'>
        <span class='s32 s33 s12'><span>        _context = </span></span><span
            class='s32 s33 s7 s12'><span>new</span></span><span class='s32 s33 s12'><span> </span></span><span
            class='s32 s33 s12'><span>CustomAssemblyLoadContext</span></span><span
            class='s32 s33 s12'><span>(</span></span><span class='s32 s33 s12'><span>);</span></span>
    </p>
    <p class='s1 s2 s15'>
        <span class='s32 s33 s12'><span>        </span></span><span class='s32 s33 s7 s12'><span>var</span></span><span
            class='s32 s33 s12'><span> assembly = _</span></span><span
            class='s32 s33 s12'><span>context.LoadFromStream</span></span><span
            class='s32 s33 s12'><span>(</span></span><span class='s32 s33 s7 s12'><span>new</span></span><span
            class='s32 s33 s12'><span> </span></span><span class='s32 s33 s12'><span>MemoryStream</span></span><span
            class='s32 s33 s12'><span>(</span></span><span
            class='s32 s33 s12'><span>File.ReadAllBytes</span></span><span
            class='s32 s33 s12'><span>(</span></span><span class='s32 s33 s12'><span>AssemblyFilePath</span></span><span
            class='s32 s33 s12'><span>)));</span></span>
    </p>
    <p class='s1 s2 s15'>
        <span class='s32 s33 s12'><span>        </span></span><span
            class='s32 s33 s12'><span>Console.WriteLine</span></span><span
            class='s32 s33 s12'><span>(</span></span><span
            class='s32 s33 s12'><span>assembly.FullName</span></span><span class='s32 s33 s12'><span>);</span></span>
    </p>
    <p class='s1 s2 s15'><br></p>
    <p class='s1 s2 s15'>
        <span class='s32 s33 s12'><span>        </span></span><span class='s32 s33 s7 s12'><span>var</span></span><span
            class='s32 s33 s12'><span> type = </span></span><span
            class='s32 s33 s12'><span>assembly.GetType</span></span><span class='s32 s33 s12'><span>(</span></span><span
            class='s32 s33 s12'><span>"</span></span><span
            class='s32 s33 s12'><span>Exporter.LiveSync.Program</span></span><span
            class='s32 s33 s12'><span>"</span></span><span class='s32 s33 s12'><span>);</span></span>
    </p>
    <p class='s1 s2 s15'>
        <span class='s32 s33 s12'><span>        </span></span><span class='s32 s33 s7 s12'><span>var</span></span><span
            class='s32 s33 s12'><span> </span></span><span class='s32 s33 s12'><span>greetMethod</span></span><span
            class='s32 s33 s12'><span> = </span></span><span class='s32 s33 s12'><span>type.GetMethod</span></span><span
            class='s32 s33 s12'><span>(</span></span><span class='s32 s33 s12'><span>"</span></span><span
            class='s32 s33 s12'><span>StartServer</span></span><span class='s32 s33 s12'><span>"</span></span><span
            class='s32 s33 s12'><span>);</span></span>
    </p>
    <p class='s1 s2 s15'>
        <span class='s32 s33 s12'><span>        </span></span><span class='s32 s33 s7 s12'><span>var</span></span><span
            class='s32 s33 s12'><span> instance = </span></span><span
            class='s32 s33 s12'><span>Activator.CreateInstance</span></span><span class='s32 s33 s12'><span>(type</span></span><span
            class='s32 s33 s12'><span>);</span></span>
    </p>
    <p class='s1 s2 s15'><br></p>
    <p class='s1 s2 s15'>
        <span class='s32 s33 s12'><span>        </span></span><span class='s32 s33 s7 s12'><span>new</span></span><span
            class='s32 s33 s12'><span> </span></span><span class='s32 s33 s7 s12'><span>Thread</span></span><span
            class='s32 s33 s12'><span>(</span></span><span class='s32 s33 s12'><span>() =&gt;</span></span>
    </p>
    <p class='s1 s2 s15'><span class='s32 s33 s12'><span>        {</span></span></p>
    <p class='s1 s2 s15'>
        <span class='s32 s33 s12'><span>            </span></span><span class='s32 s33 s7 s12'><span>try</span></span>
    </p>
    <p class='s1 s2 s15'><span class='s32 s33 s12'><span>            {</span></span></p>
    <p class='s1 s2 s15'>
        <span class='s32 s33 s12'><span>                </span></span><span class='s32 s33 s12'><span>greetMethod</span></span><span
            class='s32 s33 s12'><span>?.</span></span><span
            class='s32 s33 s12'><span>Invoke(instance, </span></span><span
            class='s32 s33 s7 s12'><span>new</span></span><span class='s32 s33 s12'><span> </span></span><span
            class='s32 s33 s7 s12'><span>object?</span></span><span class='s32 s33 s12'><span>[] { _</span></span><span
            class='s32 s33 s12'><span>cancelTokenSource.Token</span></span><span
            class='s32 s33 s12'><span> });</span></span>
    </p>
    <p class='s1 s2 s15'>
        <span class='s32 s33 s12'><span>                _</span></span><span class='s32 s33 s12'><span>logger.LogInformation</span></span><span
            class='s32 s33 s12'><span>(</span></span><span class='s32 s33 s12'><span>"</span></span><span
            class='s32 s33 s12'><span>StartServer</span></span><span
            class='s32 s33 s12'><span> Invoked"</span></span><span class='s32 s33 s12'><span>);</span></span>
    </p>
    <p class='s1 s2 s15'><span class='s32 s33 s12'><span>            }</span></span></p>
    <p class='s1 s2 s15'>
        <span class='s32 s33 s12'><span>            </span></span><span class='s32 s33 s7 s12'><span>catch</span></span><span
            class='s32 s33 s12'><span> (Exception ex)</span></span>
    </p>
    <p class='s1 s2 s15'><span class='s32 s33 s12'><span>            {</span></span></p>
    <p class='s1 s2 s15'>
        <span class='s32 s33 s12'><span>                _</span></span><span
            class='s32 s33 s12'><span>logger.LogError</span></span><span class='s32 s33 s12'><span>(</span></span><span
            class='s32 s33 s12'><span>ex.Message</span></span><span class='s32 s33 s12'><span>);</span></span>
    </p>
    <p class='s1 s2 s15'><span class='s32 s33 s12'><span>            }</span></span></p>
    <p class='s1 s2 s15'>
        <span class='s32 s33 s12'><span>        }</span></span><span
            class='s32 s33 s12'><span>).Start</span></span><span class='s32 s33 s12'><span>();</span></span>
    </p>
    <p class='s1 s2 s15'>
        <span class='s32 s33 s12'><span>        _</span></span><span
            class='s32 s33 s12'><span>logger.LogInformation</span></span><span class='s32 s33 s12'><span>(</span></span><span
            class='s32 s33 s12'><span>"Thread started"</span></span><span class='s32 s33 s12'><span>);</span></span>
    </p>
    <p class='s1 s2 s15'><span class='s32 s33 s12'><span>    }</span></span></p>
    <p class='s1 s2 s15'><br></p>
    <p class='s1 s2 s15'>
        <span class='s32 s33 s12'><span>    </span></span><span class='s32 s33 s7 s12'><span>public</span></span><span
            class='s32 s33 s12'><span> </span></span><span class='s32 s33 s7 s12'><span>void</span></span><span
            class='s32 s33 s12'><span> </span></span><span
            class='s32 s33 s7 s12'><span>UnloadAssembly</span></span><span
            class='s32 s33 s12'><span>(</span></span><span class='s32 s33 s12'><span>)</span></span>
    </p>
    <p class='s1 s2 s15'><span class='s32 s33 s12'><span>    {</span></span></p>
    <p class='s1 s2 s15'>
        <span class='s32 s33 s12'><span>        </span></span><span class='s32 s33 s7 s12'><span>try</span></span>
    </p>
    <p class='s1 s2 s15'><span class='s32 s33 s12'><span>        {</span></span></p>
    <p class='s1 s2 s15'>
        <span class='s32 s33 s12'><span>            _</span></span><span class='s32 s33 s12'><span>cancelTokenSource.Cancel</span></span><span
            class='s32 s33 s12'><span>(</span></span><span class='s32 s33 s12'><span>);</span></span>
    </p>
    <p class='s1 s2 s15'>
        <span class='s32 s33 s12'><span>            _</span></span><span
            class='s32 s33 s12'><span>cancelTokenSource</span></span><span
            class='s32 s33 s12'><span> = </span></span><span class='s32 s33 s7 s12'><span>new</span></span><span
            class='s32 s33 s12'><span> </span></span><span
            class='s32 s33 s12'><span>CancellationTokenSource</span></span><span
            class='s32 s33 s12'><span>(</span></span><span class='s32 s33 s12'><span>);</span></span>
    </p>
    <p class='s1 s2 s15'>
        <span class='s32 s33 s12'><span>            _</span></span><span
            class='s32 s33 s12'><span>logger.LogInformation</span></span><span class='s32 s33 s12'><span>(</span></span><span
            class='s32 s33 s12'><span>"Token cleaned"</span></span><span class='s32 s33 s12'><span>);</span></span>
    </p>
    <p class='s1 s2 s15'>
        <span class='s32 s33 s12'><span>            </span></span><span
            class='s32 s33 s12'><span>GC.Collect</span></span><span class='s32 s33 s12'><span>();</span></span>
    </p>
    <p class='s1 s2 s15'>
        <span class='s32 s33 s12'><span>            </span></span><span class='s32 s33 s12'><span>GC.WaitForPendingFinalizers</span></span><span
            class='s32 s33 s12'><span>();</span></span>
    </p>
    <p class='s1 s2 s15'>
        <span class='s32 s33 s12'><span>            _</span></span><span class='s32 s33 s12'><span>context.Unload</span></span><span
            class='s32 s33 s12'><span>();</span></span>
    </p>
    <p class='s1 s2 s15'><span class='s32 s33 s12'><span>        }</span></span></p>
    <p class='s1 s2 s15'>
        <span class='s32 s33 s12'><span>        </span></span><span
            class='s32 s33 s7 s12'><span>catch</span></span><span
            class='s32 s33 s12'><span> (Exception ex)</span></span>
    </p>
    <p class='s1 s2 s15'><span class='s32 s33 s12'><span>        {</span></span></p>
    <p class='s1 s2 s15'>
        <span class='s32 s33 s12'><span>            _</span></span><span
            class='s32 s33 s12'><span>logger.LogError</span></span><span class='s32 s33 s12'><span>(</span></span><span
            class='s32 s33 s12'><span>ex.Message</span></span><span class='s32 s33 s12'><span>);</span></span>
    </p>
    <p class='s1 s2 s15'><span class='s32 s33 s12'><span>        }</span></span></p>
    <p class='s1 s2 s15'><span class='s32 s33 s12'></span></p>
</div>
<div class='page'>
    <p class='s1 s2 s15'><span class='s32 s33 s12'><span>    }</span></span></p>
    <p class='s1 s2 s15'><span class='s32 s33 s12'><span>}</span></span></p>
    <p class='s8 s9 s11'><br></p>
    <p class='s8 s9 s11'><br></p>
    <p class='s8 s9 s11'><span class='s4 s5'><span>Worker.cs</span></span></p>
    <p class='s8 s9 s11'><br></p>
    <p class='s1 s2 s15'>
        <span class='s32 s33 s7 s12'><span>using</span></span><span class='s32 s33 s12'><span> </span></span><span
            class='s32 s33 s7 s12'><span>Exporter.Service.Interfaces</span></span><span
            class='s32 s33 s12'><span>;</span></span>
    </p>
    <p class='s1 s2 s15'><br></p>
    <p class='s1 s2 s15'>
        <span class='s32 s33 s7 s12'><span>namespace</span></span><span class='s32 s33 s12'><span> </span></span><span
            class='s32 s33 s7 s12'><span>Exporter.</span></span><span class='s32 s33 s7 s12'><span>Service</span></span><span
            class='s32 s33 s12'><span>;</span></span>
    </p>
    <p class='s1 s2 s15'><br></p>
    <p class='s1 s2 s15'>
        <span class='s32 s33 s7 s12'><span>public</span></span><span class='s32 s33 s12'><span> </span></span><span
            class='s32 s33 s7 s12'><span>class</span></span><span class='s32 s33 s12'><span> </span></span><span
            class='s32 s33 s7 s12'><span>Worker</span></span><span class='s32 s33 s12'><span> :</span></span><span
            class='s32 s33 s12'><span> </span></span><span class='s32 s33 s12'><span>BackgroundService</span></span>
    </p>
    <p class='s1 s2 s15'><span class='s32 s33 s12'><span>{</span></span></p>
    <p class='s1 s2 s15'>
        <span class='s32 s33 s12'><span>    </span></span><span class='s32 s33 s7 s12'><span>private</span></span><span
            class='s32 s33 s12'><span> </span></span><span class='s32 s33 s7 s12'><span>readonly</span></span><span
            class='s32 s33 s12'><span> </span></span><span class='s32 s33 s12'><span>IAssemblyService</span></span><span
            class='s32 s33 s12'><span> _</span></span><span class='s32 s33 s12'><span>assemblyService</span></span><span
            class='s32 s33 s12'><span>;</span></span>
    </p>
    <p class='s1 s2 s15'>
        <span class='s32 s33 s12'><span>    </span></span><span class='s32 s33 s7 s12'><span>private</span></span><span
            class='s32 s33 s12'><span> </span></span><span class='s32 s33 s7 s12'><span>readonly</span></span><span
            class='s32 s33 s12'><span> </span></span><span class='s32 s33 s12'><span>ILogger</span></span><span
            class='s32 s33 s12'><span>&lt;Worker&gt; _</span></span><span
            class='s32 s33 s12'><span>logger;</span></span>
    </p>
    <p class='s1 s2 s15'>
        <span class='s32 s33 s12'><span>    </span></span><span class='s32 s33 s7 s12'><span>private</span></span><span
            class='s32 s33 s12'><span> </span></span><span class='s32 s33 s7 s12'><span>readonly</span></span><span
            class='s32 s33 s12'><span> </span></span><span class='s32 s33 s12'><span>ITcpServer</span></span><span
            class='s32 s33 s12'><span> _</span></span><span class='s32 s33 s12'><span>tcpServer</span></span><span
            class='s32 s33 s12'><span>;</span></span>
    </p>
    <p class='s1 s2 s15'><br></p>
    <p class='s1 s2 s15'>
        <span class='s32 s33 s12'><span>    </span></span><span class='s32 s33 s7 s12'><span>public</span></span><span
            class='s32 s33 s12'><span> </span></span><span class='s32 s33 s7 s12'><span>Worker</span></span><span
            class='s32 s33 s12'><span>(</span></span><span class='s32 s33 s12'><span>ILogger</span></span><span
            class='s32 s33 s12'><span>&lt;Worker&gt; logger, </span></span><span class='s32 s33 s12'><span>IAssemblyService</span></span><span
            class='s32 s33 s12'><span> </span></span><span class='s32 s33 s12'><span>assemblyService</span></span><span
            class='s32 s33 s12'><span>, </span></span><span class='s32 s33 s12'><span>ITcpServer</span></span><span
            class='s32 s33 s12'><span> </span></span><span class='s32 s33 s12'><span>tcpServer</span></span><span
            class='s32 s33 s12'><span>)</span></span>
    </p>
    <p class='s1 s2 s15'><span class='s32 s33 s12'><span>    {</span></span></p>
    <p class='s1 s2 s15'>
        <span class='s32 s33 s12'><span>        _logger = </span></span><span
            class='s32 s33 s12'><span>logger;</span></span>
    </p>
    <p class='s1 s2 s15'>
        <span class='s32 s33 s12'><span>        _</span></span><span
            class='s32 s33 s12'><span>assemblyService</span></span><span
            class='s32 s33 s12'><span> = </span></span><span
            class='s32 s33 s12'><span>assemblyService</span></span><span class='s32 s33 s12'><span>;</span></span>
    </p>
    <p class='s1 s2 s15'>
        <span class='s32 s33 s12'><span>        _</span></span><span
            class='s32 s33 s12'><span>tcpServer</span></span><span class='s32 s33 s12'><span> = </span></span><span
            class='s32 s33 s12'><span>tcpServer</span></span><span class='s32 s33 s12'><span>;</span></span>
    </p>
    <p class='s1 s2 s15'><span class='s32 s33 s12'><span>    }</span></span></p>
    <p class='s1 s2 s15'><br></p>
    <p class='s1 s2 s15'>
        <span class='s32 s33 s12'><span>    </span></span><span class='s32 s33 s7 s12'><span>public</span></span><span
            class='s32 s33 s12'><span> </span></span><span class='s32 s33 s7 s12'><span>override</span></span><span
            class='s32 s33 s12'><span> Task </span></span><span
            class='s32 s33 s7 s12'><span>StartAsync</span></span><span class='s32 s33 s12'><span>(</span></span><span
            class='s32 s33 s12'><span>CancellationToken</span></span><span
            class='s32 s33 s12'><span> </span></span><span
            class='s32 s33 s12'><span>cancellationToken</span></span><span class='s32 s33 s12'><span>)</span></span>
    </p>
    <p class='s1 s2 s15'><span class='s32 s33 s12'><span>    {</span></span></p>
    <p class='s1 s2 s15'>
        <span class='s32 s33 s12'><span>        _</span></span><span class='s32 s33 s12'><span>assemblyService.LoadAssembly</span></span><span
            class='s32 s33 s12'><span>(</span></span><span class='s32 s33 s12'><span>);</span></span>
    </p>
    <p class='s1 s2 s15'>
        <span class='s32 s33 s12'><span>        </span></span><span
            class='s32 s33 s7 s12'><span>return</span></span><span class='s32 s33 s12'><span> </span></span><span
            class='s32 s33 s7 s12'><span>base</span></span><span
            class='s32 s33 s12'><span>.StartAsync</span></span><span class='s32 s33 s12'><span>(</span></span><span
            class='s32 s33 s12'><span>cancellationToken</span></span><span class='s32 s33 s12'><span>);</span></span>
    </p>
    <p class='s1 s2 s15'><span class='s32 s33 s12'><span>    }</span></span></p>
    <p class='s1 s2 s15'><br></p>
    <p class='s1 s2 s15'>
        <span class='s32 s33 s12'><span>    </span></span><span
            class='s32 s33 s7 s12'><span>protected</span></span><span class='s32 s33 s12'><span> </span></span><span
            class='s32 s33 s7 s12'><span>override</span></span><span class='s32 s33 s12'><span> </span></span><span
            class='s32 s33 s7 s12'><span>async</span></span><span class='s32 s33 s12'><span> Task </span></span><span
            class='s32 s33 s7 s12'><span>ExecuteAsync</span></span><span class='s32 s33 s12'><span>(</span></span><span
            class='s32 s33 s12'><span>CancellationToken</span></span><span
            class='s32 s33 s12'><span> </span></span><span class='s32 s33 s12'><span>stoppingToken</span></span><span
            class='s32 s33 s12'><span>)</span></span>
    </p>
    <p class='s1 s2 s15'><span class='s32 s33 s12'><span>    {</span></span></p>
    <p class='s1 s2 s15'>
        <span class='s32 s33 s12'><span>        </span></span><span class='s32 s33 s7 s12'><span>new</span></span><span
            class='s32 s33 s12'><span> </span></span><span class='s32 s33 s7 s12'><span>Thread</span></span><span
            class='s32 s33 s12'><span>(</span></span><span class='s32 s33 s12'><span>() =&gt; _</span></span><span
            class='s32 s33 s12'><span>tcpServer.Start</span></span><span
            class='s32 s33 s12'><span>()).Start();</span></span>
    </p>
    <p class='s1 s2 s15'><br></p>
    <p class='s1 s2 s15'>
        <span class='s32 s33 s12'><span>        </span></span><span
            class='s32 s33 s7 s12'><span>while</span></span><span class='s32 s33 s12'><span> </span></span><span
            class='s32 s33 s12'><span>(!</span></span><span class='s32 s33 s12'><span>stoppingToken.IsCancellationRequested</span></span><span
            class='s32 s33 s12'><span>)</span></span>
    </p>
    <p class='s1 s2 s15'><span class='s32 s33 s12'><span>        {</span></span></p>
    <p class='s1 s2 s15'>
        <span class='s32 s33 s12'><span>            _</span></span><span
            class='s32 s33 s12'><span>logger.LogInformation</span></span><span class='s32 s33 s12'><span>(</span></span><span
            class='s32 s33 s12'><span>"Worker running at: {time}"</span></span><span class='s32 s33 s12'><span>, </span></span><span
            class='s32 s33 s12'><span>DateTimeOffset.Now</span></span><span class='s32 s33 s12'><span>);</span></span>
    </p>
    <p class='s1 s2 s15'>
        <span class='s32 s33 s12'><span>            </span></span><span class='s32 s33 s7 s12'><span>await</span></span><span
            class='s32 s33 s12'><span> </span></span><span class='s32 s33 s12'><span>Task.Delay</span></span><span
            class='s32 s33 s12'><span>(</span></span><span class='s32 s33 s7 s12'><span>1000</span></span><span
            class='s32 s33 s12'><span> * </span></span><span class='s32 s33 s7 s12'><span>60</span></span><span
            class='s32 s33 s12'><span>, </span></span><span class='s32 s33 s12'><span>stoppingToken</span></span><span
            class='s32 s33 s12'><span>);</span></span>
    </p>
    <p class='s1 s2 s15'><span class='s32 s33 s12'><span>        }</span></span></p>
    <p class='s1 s2 s15'><span class='s32 s33 s12'><span>    }</span></span></p>
    <p class='s1 s2 s15'><br></p>
    <p class='s1 s2 s15'>
        <span class='s32 s33 s12'><span>    </span></span><span class='s32 s33 s7 s12'><span>public</span></span><span
            class='s32 s33 s12'><span> </span></span><span class='s32 s33 s7 s12'><span>override</span></span><span
            class='s32 s33 s12'><span> Task </span></span><span
            class='s32 s33 s7 s12'><span>StopAsync</span></span><span class='s32 s33 s12'><span>(</span></span><span
            class='s32 s33 s12'><span>CancellationToken</span></span><span
            class='s32 s33 s12'><span> </span></span><span
            class='s32 s33 s12'><span>cancellationToken</span></span><span class='s32 s33 s12'><span>)</span></span>
    </p>
    <p class='s1 s2 s15'><span class='s32 s33 s12'><span>    {</span></span></p>
    <p class='s1 s2 s15'>
        <span class='s32 s33 s12'><span>        _</span></span><span class='s32 s33 s12'><span>assemblyService.UnloadAssembly</span></span><span
            class='s32 s33 s12'><span>(</span></span><span class='s32 s33 s12'><span>);</span></span>
    </p>
    <p class='s1 s2 s15'>
        <span class='s32 s33 s12'><span>        </span></span><span
            class='s32 s33 s7 s12'><span>return</span></span><span class='s32 s33 s12'><span> </span></span><span
            class='s32 s33 s7 s12'><span>base</span></span><span class='s32 s33 s12'><span>.StopAsync</span></span><span
            class='s32 s33 s12'><span>(</span></span><span
            class='s32 s33 s12'><span>cancellationToken</span></span><span class='s32 s33 s12'><span>);</span></span>
    </p>
    <p class='s1 s2 s15'><span class='s32 s33 s12'><span>    }</span></span></p>
    <p class='s1 s2 s15'><span class='s32 s33 s12'><span>}</span></span></p>
    <p class='s8 s9 s11'><br></p>
    <p class='s13 s14 s2 s15'><span class='s4 s5'></span></p>
</div>
<div class='page'>
    <p class='s13 s14 s2 s15'><span class='s4 s5'></span></p>
    <p class='s8 s9 s11'><span class='s4 s5'><span>Program.cs</span></span></p>
    <p class='s8 s9 s11'><br></p>
    <p class='s1 s2 s15'>
        <span class='s32 s33 s7 s12'><span>using</span></span><span class='s32 s33 s12'><span> </span></span><span
            class='s32 s33 s7 s12'><span>Exporter.</span></span><span class='s32 s33 s7 s12'><span>Service</span></span><span
            class='s32 s33 s12'><span>;</span></span>
    </p>
    <p class='s1 s2 s15'>
        <span class='s32 s33 s7 s12'><span>using</span></span><span class='s32 s33 s12'><span> </span></span><span
            class='s32 s33 s7 s12'><span>Exporter.Service.Interfaces</span></span><span
            class='s32 s33 s12'><span>;</span></span>
    </p>
    <p class='s1 s2 s15'>
        <span class='s32 s33 s7 s12'><span>using</span></span><span class='s32 s33 s12'><span> </span></span><span
            class='s32 s33 s7 s12'><span>Exporter.Service.Services</span></span><span class='s32 s33 s12'><span>;</span></span>
    </p>
    <p class='s1 s2 s15'><br></p>
    <p class='s1 s2 s15'>
        <span class='s32 s33 s7 s12'><span>var</span></span><span class='s32 s33 s12'><span> host = </span></span><span
            class='s32 s33 s12'><span>Host.CreateDefaultBuilder</span></span><span
            class='s32 s33 s12'><span>(</span></span><span class='s32 s33 s12'><span>args</span></span><span
            class='s32 s33 s12'><span>)</span></span>
    </p>
    <p class='s1 s2 s15'>
        <span class='s32 s33 s12'><span>    </span></span><span class='s32 s33 s12'><span>.</span></span><span
            class='s32 s33 s12'><span>UseWindowsService</span></span><span class='s32 s33 s12'><span>()</span></span>
    </p>
    <p class='s1 s2 s15'>
        <span class='s32 s33 s12'><span>    </span></span><span class='s32 s33 s12'><span>.</span></span><span
            class='s32 s33 s12'><span>ConfigureServices</span></span><span
            class='s32 s33 s12'><span>(services =&gt;</span></span>
    </p>
    <p class='s1 s2 s15'><span class='s32 s33 s12'><span>    {</span></span></p>
    <p class='s1 s2 s15'>
        <span class='s32 s33 s12'><span>        </span></span><span
            class='s32 s33 s12'><span>services.AddHostedService</span></span><span class='s32 s33 s12'><span>&lt;Worker&gt;();</span></span>
    </p>
    <p class='s1 s2 s15'>
        <span class='s32 s33 s12'><span>        </span></span><span
            class='s32 s33 s12'><span>services.AddSingleton</span></span><span
            class='s32 s33 s12'><span>&lt;</span></span><span
            class='s32 s33 s12'><span>IAssemblyService</span></span><span
            class='s32 s33 s12'><span>, </span></span><span class='s32 s33 s12'><span>AssemblyService</span></span><span
            class='s32 s33 s12'><span>&gt;();</span></span>
    </p>
    <p class='s1 s2 s15'>
        <span class='s32 s33 s12'><span>        </span></span><span
            class='s32 s33 s12'><span>services.AddSingleton</span></span><span
            class='s32 s33 s12'><span>&lt;</span></span><span class='s32 s33 s12'><span>ITcpServer</span></span><span
            class='s32 s33 s12'><span>, </span></span><span class='s32 s33 s12'><span>TcpServer</span></span><span
            class='s32 s33 s12'><span>&gt;();</span></span>
    </p>
    <p class='s1 s2 s15'><span class='s32 s33 s12'><span>    })</span></span></p>
    <p class='s1 s2 s15'>
        <span class='s32 s33 s12'><span>    </span></span><span class='s32 s33 s12'><span>.Build</span></span><span
            class='s32 s33 s12'><span>();</span></span>
    </p>
    <p class='s1 s2 s15'><br></p>
    <p class='s1 s2 s15'>
        <span class='s32 s33 s7 s12'><span>await</span></span><span class='s32 s33 s12'><span> </span></span><span
            class='s32 s33 s12'><span>host.RunAsync</span></span><span class='s32 s33 s12'><span>();</span></span>
    </p>
    <p class='s1 s2 s15'><br></p>
    <p class='s1 s2 s15'><br></p>
    <p class='s1 s2 s15'><br></p>
    <p class='s1 s2 s15'><br></p>
    <p class='s8 s9 s11'><span class='s4 s5'><span>CustomAssemblyLoadContext.cs</span></span></p>
    <p class='s1 s2 s15'><br></p>
    <p class='s1 s2 s15'><br></p>
    <p class='s1 s2 s15'><br></p>
    <p class='s1 s2 s15'>
        <span class='s32 s33 s7 s12'><span>using</span></span><span class='s32 s33 s12'><span> </span></span><span
            class='s32 s33 s7 s12'><span>System.</span></span><span
            class='s32 s33 s7 s12'><span>Reflection</span></span><span class='s32 s33 s12'><span>;</span></span>
    </p>
    <p class='s1 s2 s15'>
        <span class='s32 s33 s7 s12'><span>using</span></span><span class='s32 s33 s12'><span> </span></span><span
            class='s32 s33 s7 s12'><span>System.Runtime.Loader</span></span><span
            class='s32 s33 s12'><span>;</span></span>
    </p>
    <p class='s1 s2 s15'><br></p>
    <p class='s1 s2 s15'>
        <span class='s32 s33 s7 s12'><span>namespace</span></span><span class='s32 s33 s12'><span> </span></span><span
            class='s32 s33 s7 s12'><span>Exporter.Service.Services</span></span><span class='s32 s33 s12'><span>;</span></span>
    </p>
    <p class='s1 s2 s15'><br></p>
    <p class='s1 s2 s15'>
        <span class='s32 s33 s7 s12'><span>public</span></span><span class='s32 s33 s12'><span> </span></span><span
            class='s32 s33 s7 s12'><span>class</span></span><span class='s32 s33 s12'><span> </span></span><span
            class='s32 s33 s7 s12'><span>CustomAssemblyLoadContext</span></span><span
            class='s32 s33 s12'><span> :</span></span><span class='s32 s33 s12'><span> </span></span><span
            class='s32 s33 s12'><span>AssemblyLoadContext</span></span>
    </p>
    <p class='s1 s2 s15'><span class='s32 s33 s12'><span>{</span></span></p>
    <p class='s1 s2 s15'>
        <span class='s32 s33 s12'><span>    </span></span><span class='s32 s33 s7 s12'><span>public</span></span><span
            class='s32 s33 s12'><span> </span></span><span class='s32 s33 s7 s12'><span>CustomAssemblyLoadContext</span></span><span
            class='s32 s33 s12'><span>(</span></span><span class='s32 s33 s12'><span>) : </span></span><span
            class='s32 s33 s7 s12'><span>base</span></span><span class='s32 s33 s12'><span>(</span></span><span
            class='s32 s33 s7 s12'><span>true</span></span><span class='s32 s33 s12'><span>)</span></span>
    </p>
    <p class='s1 s2 s15'><span class='s32 s33 s12'><span>    {</span></span></p>
    <p class='s1 s2 s15'><span class='s32 s33 s12'><span>    }</span></span></p>
    <p class='s1 s2 s15'><br></p>
    <p class='s1 s2 s15'>
        <span class='s32 s33 s12'><span>    </span></span><span
            class='s32 s33 s7 s12'><span>protected</span></span><span class='s32 s33 s12'><span> </span></span><span
            class='s32 s33 s7 s12'><span>override</span></span><span class='s32 s33 s12'><span> Assembly? </span></span><span
            class='s32 s33 s12'><span>Load(</span></span><span class='s32 s33 s12'><span>AssemblyName</span></span><span
            class='s32 s33 s12'><span> </span></span><span class='s32 s33 s12'><span>assemblyName</span></span><span
            class='s32 s33 s12'><span>)</span></span>
    </p>
    <p class='s1 s2 s15'><span class='s32 s33 s12'><span>    {</span></span></p>
    <p class='s1 s2 s15'>
        <span class='s32 s33 s12'><span>        </span></span><span
            class='s32 s33 s7 s12'><span>return</span></span><span class='s32 s33 s12'><span> </span></span><span
            class='s32 s33 s7 s12'><span>null</span></span><span class='s32 s33 s12'><span>;</span></span>
    </p>
    <p class='s1 s2 s15'>
        <span class='s32 s33 s12'><span>    </span></span><span class='s32 s33 s12'><span>}</span></span></p>
    <p class='s1 s2 s15'><span class='s32 s33 s12'><span>}</span></span></p>
    <p class='s8 s9 s11'><br></p>
</div>
</body>

</html>